/*! For license information please see 6583.8768aab2.js.LICENSE.txt */
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["6583"],{41002:function(e,t,n){"use strict";n.d(t,{MessageBlockPure:function(){return c},MessageSinglePure:function(){return u}});var s=n("97458");n("52983");var a=n("87382"),r=n("76121"),i=n("28502"),o=n("78597"),l=n("33434"),c=function(){return null},u=function(e){var t=e.messageLink,n=e.getMessage,c=e.lastSendMessageLink,u=e.lastAvailableMessageLink,d=e.isShowActionsAndSuggests;return(0,o.useCompareMemo)(n(t),l.shallow)?(0,s.jsx)(a.ErrorBoundary,{errorBoundaryName:"message_box_error",FallbackComponent:r.MessageBlockErrorFallback,children:(0,s.jsx)(i.MessageBoxPure,{messageLink:t,getMessage:n,isLastSendMessage:(null==c?void 0:c.messageId)===t.messageId,isLastAvailableMessage:(null==u?void 0:u.messageId)===t.messageId,isShowActionsAndSuggests:void 0!==d&&d})}):null}},23832:function(e,t,n){"use strict";n.d(t,{useLinksAndGetMessage:function(){return u},useUnionMessageListPure:function(){return d}});var s=n("52983"),a=n("24962"),r=n("1107"),i=n("98057"),o=n("87575"),l=n("46750"),c=function(e,t){for(var n=[],s=0;s<e.length;s++){var r=(0,a.default)(e,s),l=(0,a.default)(e,s+1);if(!!r&&!!(0,i.isSingleMessageItem)(r)){var c=[];if((0,o.isCrowdTestMessage)(t(r.data))&&l&&(0,i.isSingleMessageItem)(l)&&(0,o.isCrowdTestMessage)(t(l.data)))c.push(r.data,l.data),s++;else{n.push(r);continue}c.length&&n.push({type:"block",data:c,showActionsAndSuggests:r.showActionsAndSuggests,id:"block_".concat(r.data.messageKey||r.data.messageId)})}}return n},u=function(e){var t=(0,s.useMemo)(function(){var t;return null!==(t=null==e?void 0:e.map(function(e){return{messageId:e.message_id||"",isLocalMessage:!1}}))&&void 0!==t?t:[]},[null==e?void 0:e.length]),n=(0,s.useMemo)(function(){var t=(0,r.default)(e,"message_id");return(0,l.createGetMessage)({messageMap:t,localMessageMap:{}})},[t]);return{messageLinks:t,getMessage:n}},d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,s.useMemo)(function(){return n||!e?[]:c(e.map(function(e){return{type:"single",data:e,showActionsAndSuggests:!0,id:"single_".concat(e.messageKey||e.messageId)}}),t)},[e,n])}},88824:function(e,t,n){"use strict";n.d(t,{MessageShareDataList:function(){return C}});var s=n("97458"),a=n("52983"),r=n("2945"),i=n("33229"),o=n("98057"),l=n("87575"),c=n("68534"),u=n("10886"),d=n("59064"),g=n("23832"),m=n("73302"),v=n("41002"),f=n("18714"),_=function(e){var t,n=e.dataList,i=e.children;var o=(t=0,{ref:(0,a.useRef)(null),controller:{scrollTo:r.default,scrollToTop:r.default,scrollToBottom:r.default,getScrollTop:function(){return 0},getScrollBottom:function(){return 0},refreshAnchor:r.default,disableScroll:r.default,enableScroll:r.default,isNearBottom:r.default}}),l=o.ref,c=o.controller,d=(0,a.useCallback)(function(e){var t=e.dataList,n=e.children;return(0,s.jsx)(s.Fragment,{children:t.map(function(e){return(0,s.jsx)(a.Fragment,{children:n(e)},e.id)})})},[]);return(0,s.jsx)(u.ScrollViewProvider,{containerRef:l,controller:c,children:(0,s.jsx)("div",{className:f["message-list-root"],ref:l,children:(0,s.jsx)(d,{dataList:n,children:i})})})},x=function(e,t){for(var n=e.length-1;n>=0;n--){var s=e[n],a=e[n-1],r=t(s),i=t(a);if((0,l.isCrowdTestMessage)(r)&&(0,l.isMessageAvailable)(r)&&(0,l.isCrowdTestMessage)(i)&&(0,l.isMessageAvailable)(i))return(0,l.isCrowdTestMessage)(r)&&(null==r?void 0:r.status)!==c.PushMessageStatus.Available?a:s;if((0,l.isMessageAvailable)(r))return s}},h=function(e){var t=e.message_list,n=e.noMore,s=(0,g.useLinksAndGetMessage)(t),a=s.messageLinks,r=s.getMessage,o=(0,d.useMessageListTheme)().theme,c=(0,g.useUnionMessageListPure)(a,r,!1);return{lastSendMessageLink:n?(0,i.default)(a,function(e){var t=r(e);return(0,m.isSendMessagePure)(t)&&(0,l.isMessageVisible)(t,void 0,"samantha"===o)}):void 0,lastAvailableMessageLink:n?x(a,r):void 0,unionMessageList:c,loading:!1,rawMessageLinks:a,getMessage:r}},p=function(e){var t=h({message_list:e.message_list,segmented:!1,noMore:e.noMore}),n=t.getMessage,a=t.unionMessageList,r=t.lastAvailableMessageLink,i=t.lastSendMessageLink,l=(0,d.useGetMessageRef)(n);return(0,s.jsx)(d.TempProvider,{getMessage:l,children:(0,s.jsx)(_,{dataList:a,top:(0,s.jsx)(s.Fragment,{}),bottom:(0,s.jsx)(s.Fragment,{}),children:function(e){if((0,o.isBlockMessageItem)(e)){var t=e.id,a=e.data,l=e.showActionsAndSuggests;return(0,s.jsx)(v.MessageBlockPure,{getMessage:n,messageLinks:a,lastSendMessageLink:i,lastAvailableMessageLink:r,isShowActionsAndSuggests:l},t)}if((0,o.isSingleMessageItem)(e)){var c=e.id,u=e.data,d=e.showActionsAndSuggests;return(0,s.jsx)(v.MessageSinglePure,{messageLink:u,getMessage:n,lastSendMessageLink:i,lastAvailableMessageLink:r,isShowActionsAndSuggests:d},c)}return(0,o.isDividerMessageItem)(e),null}})})},C=function(e){var t=e.message_list,n=e.noMore,a=e.displayOptions,r=e.theme,i=e.themeContextedVal;return(0,s.jsx)(d.ShareThemeProvider,{theme:r,themeContextValue:i,displayOptions:a,children:(0,s.jsx)(p,{message_list:t,noMore:n})})}},59064:function(e,t,n){"use strict";n.d(t,{ShareThemeProvider:function(){return C},TempProvider:function(){return M},useGetMessageRef:function(){return b},useMessageListTheme:function(){return p}});var s=n("9161"),a=n("16044"),r=n("97458"),i=n("52983"),o=n("33434"),l=n("2945"),c=n("73398"),u=n("78597"),d=n("78004"),g=n("3461"),m=n("65128"),v=n("62920"),f=n("46650"),_=n("41095"),x=n("72676"),h=(0,i.createContext)({theme:"samantha",user:void 0,bot:void 0}),p=function(){return(0,i.useContext)(h)},C=function(e){var t=e.children,n=e.theme,i=e.displayOptions,l=e.themeContextValue,c=(0,u.useCompareMemo)((0,a._)((0,s._)({theme:n||"samantha"},l),{displayOptions:i}),o.shallow);return(0,r.jsx)(h.Provider,{value:c,children:t})},M=function(e){var t=e.children,n=e.getMessage,s=(0,i.useRef)(null),a=(0,x.useTranslateFn)();return(0,i.useEffect)(function(){!(v.useChatStore.prototype||{})._useChatStore&&(0,f.IMCoreInit)({store:{name:"samantha_share_talk_store"},http:{client:_.httpClient},globalConfig:function(){return{}},botConfig:{}})},[]),(0,r.jsx)(d.BaseSlotsProvider,{value:c.ChatPageBaseSlots,children:(0,r.jsx)(g.ChatContext.Provider,{value:{sendMessage:l.default,chatViewConfig:null,t:a,enableBotProfileOpenJump:!1,enableMessageListVirtualScroll:!1,enableSendFileMessage:!1,enableSendImageMessage:!1,enableMessageDebug:!1,enableNewWritingSkill:!1,showBotHeat:!1,showBotHandleName:!1,enableSendWithAttachmentArea:!1,alwaysShowLargeAvatar:!1,scrollRef:s,chatInputRef:s,chatPageTargetRef:s,chatViewRef:s,chatDropTargetRef:s},children:(0,r.jsx)(m.DebugMessageProvider,{getMessage:function(e,t){return n(t)},children:t})})})},b=function(e){var t=(0,i.useRef)(e);return t.current=e,(0,i.useCallback)(function(e){var n;return null===(n=t.current)||void 0===n?void 0:n.call(t,e)},[])}},27338:function(e,t,n){"use strict";n.d(t,{useSharedBaseMessage:function(){return c}});var s=n("97458"),a=n("52983"),r=n("32720"),i=n("78004"),o=n("65128"),l=n("87575");n("53268"),n("45431");var c=function(e){e.inlineReverse;var t=e.name,n=e.avatarUrl,c=e.showAvatarAndName,u=e.keepAvatarPlaceholder,d=(0,r.useMessageInBoxCtx)();(0,r.useMessageLinkInBoxCtx)();var g=(0,a.useMemo)(function(){return{isSearch:(0,l.isSearchMessage)(d)}},[d]).isSearch,m=(0,i.useBaseSlots)();return m.DebugIcon,m.Popover,(0,o.useDebugMessage)().open,{showMessageActionBar:!g,debugNode:!1,avatarBefore:c?(0,s.jsxs)("div",{className:"flex h-17 mb-4 text-neutral-70",children:[(0,s.jsx)("img",{className:"w-28 h-28 rounded-full mr-8",src:n}),(0,s.jsx)("span",{className:"text-12 leading-17",children:t})]}):void 0,avatarInlineBefore:c?(0,s.jsx)("div",{className:"w-36 flex-shrink-0"}):void 0,avatarInlineAfter:u?(0,s.jsx)("div",{className:"w-36 flex-shrink-0"}):void 0}}},60302:function(e,t,n){"use strict";n.d(t,{useImagePreviewPure:function(){return m}});var s=n("40509"),a=n("6462"),r=n("97458"),i=n("52983"),o=n("77590"),l=n("78597"),c=n("74017"),u=n("87681"),d=n("17097"),g=function(e){return function(t){var n,s;return((null==t?void 0:null===(n=t.image_thumb)||void 0===n?void 0:n.url)||(null==t?void 0:null===(s=t.image_ori)||void 0===s?void 0:s.url))===e}},m=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},m=(0,s._)((0,i.useState)([]),2),v=m[0],f=m[1],_=(0,s._)((0,i.useState)(),2),x=_[0],h=_[1],p=(0,i.useRef)(null),C=(0,i.useRef)(0),M=void 0,b=(0,l.useDebounceFn)(function(){},{trailing:!0,leading:!1,wait:1e3}).run;(0,i.useEffect)(function(){(0,o.default)(x)&&(p.current=Date.now())},[(0,o.default)(x)]);var k=(0,i.useCallback)(function(e){!e&&h(void 0)},[h,x]),w=function(e){"ArrowLeft"===e.code&&Number(x)-1>=0&&v[Number(x)-1]&&(h(Number(x)-1),S("left",Number(x)-1)),"ArrowRight"===e.code&&Number(x)+1<v.length&&v[Number(x)+1]&&(h(Number(x)+1),S("right",Number(x)+1))},S=function(e,t){};(0,i.useEffect)(function(){return window.addEventListener("keydown",w),function(){window.removeEventListener("keydown",w)}},[x,v]);var j=(0,i.useCallback)(function(e){var t,s=e.disableDownload,a=e.onZoomIn,i=e.onZoomOut;return(0,r.jsx)(c.ImagePreviewBtnArea,{onZoomIn:a,onZoomOut:i,onDownload:n.disableDownload?void 0:(t=v[Number(x)],s?function(){}:function(){(0,c.handleDownloadImage)(t)}),disableDownload:s})},[x,v,n.disableDownload]);return{imageEventCallbacks:{onImageRender:function(n){if(t!==u.ContentSource.NotMessage){var s,r,i=null==e?void 0:e.findIndex(g(n)),o=(null===(r=e[i])||void 0===r?void 0:null===(s=r.image_ori)||void 0===s?void 0:s.url)||n;f(function(e){return e.length<4?(0,a._)(e).concat([o]):e})}},onImageClick:function(n,s){var r,i,o=null==e?void 0:e.findIndex(g(s)),l=(null===(i=e[o])||void 0===i?void 0:null===(r=i.image_ori)||void 0===r?void 0:r.url)||s;C.current=o,t===u.ContentSource.NotMessage?(h(o),f(null==e?void 0:e.map(function(e){return e.image_ori.url}))):f(function(e){return e.includes(l)?(h(e.indexOf(l)),e):(h(e.length),(0,a._)(e).concat([l]))}),n.stopPropagation(),n.preventDefault()}},renderImagePreview:function(){return v.length&&(0,o.default)(x)?(0,r.jsx)(d.default,{getPopupContainer:M,onZoomIn:b,onZoomOut:b,zoomStep:.2,renderPreviewMenu:j,src:v,visible:(0,o.default)(x),onVisibleChange:k,currentIndex:x,onChange:h,onPrev:function(e){return S("left",e)},onNext:function(e){return S("right",e)}}):null}}}},59606:function(e,t,n){"use strict";n.d(t,{MessageBotCardContentPure:function(){return M}});var s=n("92769"),a=n("9161"),r=n("16044"),i=n("40509"),o=n("88802"),l=n("97458"),c=n("52983"),u=n("2945"),d=n("78597"),g=n("32720"),m=n("24239"),v=n("87575"),f=n("2322"),_=n("65298"),x=n("53268"),h=n("74175"),p=n("72676"),C=n("9632");function M(e){var t,n,M,b=(0,g.useMessageInBoxCtx)(),k=null==b?void 0:null===(n=b.localInfo)||void 0===n?void 0:n.from,w=(0,v.isBotCardMessage)(b)?b.contentObj:{},S={onCreateBot:u.default,t:(0,p.useTranslateFn)()},j=S.onCreateBot,I=S.t,y=(0,c.useRef)(!1),T=(0,i._)((0,c.useState)({icon_uri:null==w?void 0:w.icon_uri,icon_url:null==w?void 0:w.icon_url}),2),P=T[0],L=T[1];(0,c.useEffect)(function(){return!P.icon_url&&k!==f.MessageFrom.Api&&B(),function(){y.current=!1}},[]);var B=(t=(0,s._)(function(){var e,t,n;return(0,o.__generator)(this,function(n){switch(n.label){case 0:if(!w)return[2];n.label=1;case 1:return n.trys.push([1,3,4,5]),y.current=!0,[4,h.apiService.bot.GenBotIcon({name:w.name,description:w.role,bot_lang:(0,d.getUnreactiveLanguage)()},{overrideConfig:{timeout:3e4}})];case 2:if(e=n.sent(),!y.current)return[2];return L(t=e.data||{}),N({newContentObj:(0,r._)((0,a._)({},w),{icon_uri:t.icon_uri,icon_url:t.icon_url})}),[3,5];case 3:if(n.sent(),!y.current)return[2];return x.Toast.error(I("create_bot_profile_photo_failed")),L({}),[3,5];case 4:return y.current=!1,[7];case 5:return[2]}})}),function(){return t.apply(this,arguments)}),N=u.default,A=u.default;return(0,l.jsx)(c.Suspense,{fallback:(0,l.jsx)("div",{}),children:(0,l.jsx)(_.BotCardBox,{name:null!==(M=null==w?void 0:w.name)&&void 0!==M?M:"",defaultAvatar:C,avatarSrc:P.icon_url,isAvatarGenerating:y.current,onClickComplete:function(){y.current=!1,null==j||j({name:null==w?void 0:w.name,description_for_human:null==w?void 0:w.role,icon_uri:P.icon_uri},{enter_method:"bot_maker_card_complete",profile_photo_type:P.icon_uri?"ai_generate":"default",if_system_prompt_added:"1",if_auto_filled:"0",if_has_voice:"0",previous_page:"chat_list",current_page:"chat"})},onClickEdit:A,loadingComponent:(0,l.jsx)(m.AvatarLoading,{}),editTitle:I("bot_maker_card_edit"),completeTitle:I("bot_maker_card_complete")})})}},67910:function(e,t,n){"use strict";n.d(t,{MessageCardContentPure:function(){return m}});var s=n("9161"),a=n("16044"),r=n("97458"),i=n("2945"),o=n("87382"),l=n("32720"),c=n("87575"),u=n("82877"),d=n("72676"),g=function(e){var t={onError:i.default,onLoadStart:i.default,onLoadEnd:i.default,onLoad:function(){return Promise.resolve(void 0)}},n=(0,l.useMessageInBoxCtx)(),s=i.default;return{messageContentEvents:t,message:(0,c.isCardMessage)(n)?n:void 0,onTrackEvent:s,onCreateReportEvent:o.createReportEvent}};function m(e){var t=e.inView,n=(0,d.useTranslateFn)(),i=g({inView:t}),o=i.messageContentEvents,l=i.message,c=i.onTrackEvent,m=i.onCreateReportEvent;return(0,r.jsx)(u.CardBox,{conversationId:(null==l?void 0:l.conversation_id)||"",messageId:(null==l?void 0:l.message_id)||"",inView:t,onTrackEvent:c,onCreateReportEvent:m,contentBoxEvents:o,data:(0,a._)((0,s._)({},null==l?void 0:l.contentObj),{createTime:null==l?void 0:l.create_time}),moreText:n("more")})}},78657:function(e,t,n){"use strict";n.d(t,{MessageImageContentPure:function(){return g}});var s=n("97458"),a=n("52983"),r=n("2945"),i=n("32720"),o=n("87575"),l=n("87681"),c=n("7370"),u=n("60302"),d=function(e){var t=(0,i.useMessageInBoxCtx)(),n=(0,o.isImageMessage)(t)?t.contentObj:{image_list:[]},s=(null==n?void 0:n.image_list)||[],c={content_source:l.ContentSource.Other}.content_source,d=void 0===c?l.ContentSource.Other:c,g={onError:r.default,onLoadStart:r.default,onLoadEnd:r.default,onLoad:function(){return Promise.resolve(void 0)}},m=(0,u.useImagePreviewPure)(s,d),v=m.imageEventCallbacks,f=m.renderImagePreview;return{messageContentEvents:g,imageBoxCallbacks:(0,a.useMemo)(function(){return{onImageClick:function(e,t){var n=t.src;n&&v.onImageClick(e,n)},onImageRender:function(e){var t=e.src;t&&v.onImageRender(t)}}},[s]),renderImagePreview:f,contentObj:n}},g=function(e){var t=e.inView,n=d({inView:t}),a=n.messageContentEvents,r=n.imageBoxCallbacks,i=n.renderImagePreview,o=n.contentObj;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.ImageBox,{inView:t,data:null!=o?o:{image_list:[]},eventCallbacks:r,contentBoxEvents:a}),i()]})}},67958:function(e,t,n){"use strict";n.d(t,{MessageMusicContentPure:function(){return f}});var s=n("40509"),a=n("97458"),r=n("52983"),i=n("2945"),o=n("40492"),l=n("87382"),c=n("32720"),u=n("81953"),d=n("87575"),g=n("2322"),m=n("72676"),v=n("11356");function f(e){var t,n,f=e.inView,_=e.isLastAvailableMessage,x=(0,m.useTranslateFn)(),h=(0,c.useMessageInBoxCtx)(),p=(0,d.isMusicMessage)(h)?h.contentObj:{music_list:[]},C=null==h?void 0:null===(t=h.localInfo)||void 0===t?void 0:t.from,M=null===(n=(0,c.useMessageLinkInBoxCtx)())||void 0===n?void 0:n.messageId,b=(0,s._)((0,r.useState)(!1),2),k=b[0],w=b[1],S=k&&C!==g.MessageFrom.Api&&_,j=i.default,I=(0,o.default)(p.music_list);return I&&M?(0,a.jsx)(u.MessageMusicContentUI,{musicContentData:I,itemId:M,messageId:M,inView:f,autoPlay:S,onMusicWillPlay:function(){w(!1)},fetchMusicResource:v.fetchMusicResource,checkMusicStatus:v.checkMusicStatus,onTrackEvent:j,onCreateReportEvent:l.createReportEvent,musicInvalidErrorTitle:x("music_url_not_vaild"),internetErrorTitle:x("internet_connection_failed")}):null}},11356:function(e,t,n){"use strict";n.d(t,{checkMusicStatus:function(){return g},fetchMusicResource:function(){return d}});var s,a,r,i=n("92769"),o=n("88802");n("97458"),n("78597");var l=n("74262"),c=n("74175");var u=((s={})[s.OTHER=0]="OTHER",s[s.PLAY=1]="PLAY",s[s.DOWNLOAD=2]="DOWNLOAD",s);var d=(a=(0,i._)(function(e){var t,n,s,a,r,i,l;return(0,o.__generator)(this,function(o){switch(o.label){case 0:t=e.vid,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,c.apiService.LoadMusicQS({vid_list:[t]})];case 2:return(i=(null==(r=o.sent().data)?void 0:null===(n=r.music_list)||void 0===n?void 0:n.find(function(e){return e.vid===t}))||{}).main_url=null===(s=i.main_url)||void 0===s?void 0:s.replace(/http:\/\//,"https://"),i.backup_url=null===(a=i.backup_url)||void 0===a?void 0:a.replace(/http:\/\//,"https://"),[2,i];case 3:return o.sent(),[2,{}];case 4:return[2]}})}),function(e){return a.apply(this,arguments)});var g=(r=(0,i._)(function(e){var t,n,s,a,r,i,d,g,m;return(0,o.__generator)(this,function(o){switch(o.label){case 0:t=e.source_from,n=e.source_id,s=l.CheckMusicStatus.ServerError,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,c.apiService.MCheckMusic({check_list:[{source_from:t,source_id:n}],scene:u.PLAY})];case 2:if(!(r=o.sent().data)||!(i=null===(a=r.status_list)||void 0===a?void 0:a.find(function(e){return e.id===n})))return[2,{status:s}];if(d=i.status,g=i.risk_result,0===d||void 0===g)return[2,{status:s}];return[2,{status:g}];case 3:return o.sent(),[2,{status:s}];case 4:return[2]}})}),function(e){return r.apply(this,arguments)})},92880:function(e,t,n){"use strict";n.d(t,{MessageCardListContentPure:function(){return l}});var s=n("97458");n("52983");var a=n("2945"),r=n("32720"),i=n("69341"),o=n("87575"),l=function(e){var t,n=e.inView;var l=(t=0,{onSearchIconShow:a.default,onSearchIconClick:a.default,onEnterVideoPlayer:a.default,onClickSearchCard:a.default,trackEvent:a.default}),c=l.onSearchIconShow,u=l.onSearchIconClick,d=l.onEnterVideoPlayer,g=l.onClickSearchCard,m=l.getVideoCache,v=l.trackEvent,f=(0,r.useMessageInBoxCtx)();return f&&(0,o.isCardListMessage)(f)?(0,s.jsx)(i.MessageCardListContentUI,{inView:n,data:null==f?void 0:f.contentObj,onSearchIconShow:c,onSearchIconClick:u,onEnterVideoPlayer:d,onClickSearchCard:g,getVideoCache:m,trackEvent:v}):null}},56430:function(e,t,n){"use strict";n.d(t,{SearchResultContentPure:function(){return d}});var s=n("9161"),a=n("16044"),r=n("89334"),i=n("97458");n("52983");var o=n("2945"),l=n("32720"),c=n("28604"),u=n("87575");function d(e){var t,n=e.inView,d=(0,r._)(e,["inView"]),g=(0,l.useMessageInBoxCtx)();var m=(t=0,{onClickSearchCard:o.default,onTrackEvent:o.default}),v=m.onClickSearchCard,f=m.onTrackEvent;return(0,u.isCardListMessage)(g)?(0,i.jsx)(c.SearchResultContentUI,(0,a._)((0,s._)({},d),{defaultExpand:false,inView:n,data:null==g?void 0:g.contentObj,onClickSearchCard:v,onTrackEvent:f})):null}},36472:function(e,t,n){"use strict";n.d(t,{MessageTextContentLitePure:function(){return w}});var s=n("97458"),a=n("52983"),r=n("33434"),i=n("59574"),o=n("24682"),l=n("37903"),c=n("2945"),u=n("78597"),d=n("54489"),g=n("13321"),m=n("3461"),v=n("32720"),f=n("72291"),_=n("37708"),x=n("69070"),h=n("4899"),p=n("87575"),C=n("87681"),M=n("68534"),b=n("60302"),k=function(e){var t,n,s=e.onLinkClick,c=e.onSendMessage,d=(0,m.useChat)().t,g=(0,v.useMessageInBoxCtx)();var _=(0,u.useCompareMemo)((t=(0,h.getMessageText)(g,!1,(0,i.default)(g)||1===g.content_type&&(0,i.default)(g.contentObj)?"":d("chat_unsupported_message_type")),{content:t,meta:(n=g||{}).meta_infos,contentType:n.content_type}),r.shallow),x=_.content,p=_.meta,C=_.contentType,b=(0,a.useMemo)(function(){if(C!==M.ContentType.Text||!(0,o.default)(x)||(0,i.default)(p))return[];var e=(0,f.getInsertContent)(p,M.MetaType.Replaceable),t=[],n=e.map(function(e){return[e.info.start,e.info.end]}).flat(2).filter(function(e){return void 0!==e}).map(function(e){return Number(e)}),a=u.utf8.posCalcRange(x,n);return e.forEach(function(e){var n,r,i,o,u,d;!(0,l.default)(null==e?void 0:null===(n=e.info)||void 0===n?void 0:n.start)&&!(0,l.default)(null===(r=e.info)||void 0===r?void 0:r.end)&&!(0,l.default)(a[null==e?void 0:null===(i=e.info)||void 0===i?void 0:i.start])&&!(0,l.default)(a[null===(o=e.info)||void 0===o?void 0:o.end])&&t.push({range:[a[null==e?void 0:null===(u=e.info)||void 0===u?void 0:u.start],a[null===(d=e.info)||void 0===d?void 0:d.end]],render:function(){var t;return(0,f.textToHtml)((null===(t=e.info)||void 0===t?void 0:t.replace_text)||"",{onLinkClick:s,onSendMessage:c})}})}),t},[p,x]);return{content:x,insertedElements:b}},w=function(e){var t=e.inView,n=(0,m.useChat)().t,r=(0,v.useMessageInBoxCtx)(),o=(0,p.isMessageFailed)(r),l=(0,p.isStreamingMessage)(r),M=(0,p.isBrokenMessage)(r),w=(0,p.isMessageFinished)(r),S=(0,p.isOnBoardingMessage)(r),j=(0,b.useImagePreviewPure)([],C.ContentSource.Original),I=j.imageEventCallbacks,y=j.renderImagePreview,T=function(e,t){if(e.preventDefault(),e.stopPropagation(),t.exts.type===d.LinkType.wiki)window.open(t.exts.wiki_link);else if(t.exts.type===d.LinkType.normal){var n;(null===(n=t.url)||void 0===n?void 0:n.includes(_.indexParams))&&A("footnote_link_click"),window.open(t.url)}else t.exts.type,d.LinkType.coco},P=c.default,L=k({onSendMessage:P,onLinkClick:T}),B=L.content,N=L.insertedElements,A=c.default;(0,a.useEffect)(function(){if(t&&S&&w){var e=(0,h.getBoardingMessageQue)(B);if((0,i.default)(e))return}},[t,w,""]);var E=(0,a.useRef)(null),R=(0,u.useEstablished)(null!=t&&t),V=(0,u.useFirstScreenInView)({ref:E}).inView;if(!r)return null;var F=c.default;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.MdBoxLazy,{ref:E,theme:"samantha",imageOptions:{objectFit:"cover",width:400,height:400},markDown:B||"",slots:{},translate:{copyTitle:n("message_long_press_copy"),codeBarLoadingText:n("code_block_compute_switch_button_running"),codeBarExpandedFinishedText:n("code_block_switch_button_hide_details"),codeBarUnExpandFinishedText:n("code_block_switch_button_show_details")},eventCallbacks:{onImageRender:function(e){var t=e.src;t&&I.onImageRender(t)},onImageClick:function(e,t){var n=t.src;n&&I.onImageClick(e,n)},onLinkClick:T,onLinkRender:function(e){var t;(null===(t=e.url)||void 0===t?void 0:t.includes(_.indexParams))&&A("footnote_link_show")},onSendMessage:P},showEllipsis:M||l&&o,showIndicator:!(w||o),autoFixSyntax:(R||V)&&{autoFixEnding:l||M},smooth:l&&{maxFirstTextSmoothSize:10},insertedElements:N,autoFitRTL:(0,u.isRTL)(),onHop:F,forceBrInterSpacing:!0,codeBarConfig:function(e){var t,s=null===(t=e.codeBlocks.at(0))||void 0===t?void 0:t.language,a=!!"compute".startsWith(null!=s?s:"");return{finished:w||o||M,defaultExpand:!a,expandedFinishedText:a?n("code_block_compute_switch_button_hide_details"):void 0,unExpandFinishedText:a?n("code_block_compute_switch_button_show_details"):void 0}}}),w&&(0,s.jsx)(x.IndexBlock,{onIndexLinkClick:A,metaInfoList:(0,f.getInsertContent)(null==r?void 0:r.meta_infos)}),y()]})}},20264:function(e,t,n){"use strict";n.d(t,{MessageVideoContentPure:function(){return c}});var s=n("97458");n("52983");var a=n("2945"),r=n("32720"),i=n("53127"),o=n("87575"),l=n("72676");function c(e){var t,n=e.inView,c=(0,l.useTranslateFn)(),u=(0,r.useMessageInBoxCtx)(),d=(0,o.isVideoMessage)(u)?u.contentObj:{video_list:[]};var g=(t=0,{handleVideoClick:function(){return Promise.resolve(void 0)},handleTrackEvent:a.default}),m=g.handleTrackEvent,v=g.handleVideoClick;return(0,s.jsx)(i.MessageVideoContentUI,{inView:n,onVideoPlay:v,videoContent:d,onTrackEvent:m,playErrorTitle:c("video_play_error_noplay")})}},77438:function(e,t,n){"use strict";n.d(t,{ReceiveMessageBoxPure:function(){return y}});var s=n("83316"),a=n("8831"),r=n("52935"),i=n("9161"),o=n("16044"),l=n("97458"),c=n("52983"),u=n("87608"),d=n.n(u),g=n("16566"),m=n("32720"),v=n("87575"),f=n("72676"),_=n("20264"),x=n("36472"),h=n("92880"),p=n("56430"),C=n("67958"),M=n("78657"),b=n("67910"),k=n("59606"),w=n("27338"),S=n("59064"),j=n("40450"),I=function(e){var t=(0,S.useMessageListTheme)(),n=t.theme,a=t.bot,r=(0,w.useSharedBaseMessage)({inlineReverse:!1,showAvatarAndName:"coco"===n,avatarUrl:null==a?void 0:a.image.tiny_url,name:null==a?void 0:a.name}),i=r.showMessageActionBar,o=r.debugNode,c=r.avatarBefore,u=r.avatarInlineBefore;return(0,l.jsx)(g.MessageBoxBase,{"data-testid":"send_message",className:"mt-12",contentProps:(0,s._)({className:d()((0,s._)({},j["receive-message-box-content"],"samantha"===n),(0,s._)({},j["receive-message-box-content-coco"],"coco"===n),e.contentClassName)},"data-testid","message_content"),inlineReverse:!1,before:c,inlineBefore:u,after:function(e){var t=e.mouseOver;return(0,l.jsx)(l.Fragment,{children:i&&(0,l.jsx)("div",{className:d()("w-full flex items-center",{"h-16":"samantha"===n},{"h-0":"coco"===n},{"opacity-0":!t}),children:o})})},children:e.renderContent})},y=function(e){var t=(0,a._)({},(0,r._)(e)),n=(0,f.useTranslateFn)(),s=(0,m.useMessageInBoxCtx)(),u=(0,S.useMessageListTheme)().theme,d=(0,c.useMemo)(function(){return{isImage:(0,v.isImageMessage)(s),isText:(0,v.isTextMessage)(s),isVideo:(0,v.isVideoMessage)(s),isMusic:(0,v.isMusicMessage)(s),isBotCard:(0,v.isBotCardMessage)(s),isCard:(0,v.isCardMessage)(s),isCardList:(0,v.isCardListMessage)(s),isSupport:(0,v.isSupportedReceiveMessage)(s)}},[s]),g=d.isImage,w=d.isText,y=d.isVideo,T=d.isMusic,P=d.isBotCard,L=d.isCard,B=d.isCardList;return!d.isSupport&&x.MessageTextContentLitePure?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{renderContent:function(e){var t=e.inView;return(0,l.jsx)(x.MessageTextContentLitePure,{inView:t})}})):B&&p.SearchResultContentPure?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{contentClassName:j["card-list-content-box"],renderContent:function(e){var t=e.inView;return"coco"===u?(0,l.jsx)(h.MessageCardListContentPure,{inView:t}):(0,l.jsx)(p.SearchResultContentPure,{inView:t})}})):P&&k.MessageBotCardContentPure?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{contentClassName:j["bot-card-content-box"],renderContent:function(e){var t=e.inView;return(0,l.jsx)(k.MessageBotCardContentPure,{inView:t})}})):w&&x.MessageTextContentLitePure?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{renderContent:function(e){var t=e.inView;return(0,l.jsx)(x.MessageTextContentLitePure,{inView:t})}})):g&&M.MessageImageContentPure?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{contentClassName:j["image-content-box"],renderContent:function(e){var t=e.inView;return(0,l.jsx)(M.MessageImageContentPure,{inView:t})}})):y&&_.MessageVideoContentPure?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{contentClassName:j["video-content-box"],renderContent:function(e){var t=e.inView;return(0,l.jsx)(_.MessageVideoContentPure,{inView:t})}})):T&&C.MessageMusicContentPure?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{contentClassName:j["music-content-box"],renderContent:function(e){var n=e.inView;return(0,l.jsx)(C.MessageMusicContentPure,{inView:n,isLastAvailableMessage:t.isLastAvailableMessage})}})):L&&b.MessageCardContentPure?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{contentClassName:j["card-content-box"],renderContent:function(e){var t=e.inView;return(0,l.jsx)(b.MessageCardContentPure,{inView:t})}})):(0,l.jsx)(I,(0,o._)((0,i._)({},t),{renderContent:function(){return n("chat_unsupported_message_type")}}))}},72243:function(e,t,n){"use strict";n.d(t,{MessageSendCompositeContentPure:function(){return p}});var s=n("97458"),a=n("33434"),r=n("2945"),i=n("87608"),o=n.n(i),l=n("78597"),c=n("96451"),u=n("3461"),d=n("32720"),g=n("85969"),m=n("53493"),v=n("27309"),f=n("71764"),_=n("87575"),x=n("12270"),h=n("60302"),p=function(){var e,t,n,i=(0,u.useChat)().t,p=(0,d.useMessageInBoxCtx)(),C=null!==(e=(0,l.useCompareMemo)(function(){if(!p||!(0,_.isCompositeMessage)(p))return null;var e,t,n,s,a,r=null!==(a=p.contentObj)&&void 0!==a?a:{},i=r.text,o=r.image_model,l=(r.file_model||{}).file_list,c=(o||{}).image_list,u=void 0===c?[]:c,d=(null===(t=u[0])||void 0===t?void 0:null===(e=t.image_thumb)||void 0===e?void 0:e.url)||(null===(s=u[0])||void 0===s?void 0:null===(n=s.image_ori)||void 0===n?void 0:n.url);return{text:i,fileList:void 0===l?[]:l,imageList:u,url:d||"hack_fallback_url",isFailed:(0,_.isMessageFailed)(p),isSafetyError:(0,x.isImageSafetyError)(p)}}(),a.shallow))&&void 0!==e?e:{},M=C.text,b=C.fileList,k=void 0===b?[]:b,w=C.imageList,S=void 0===w?[]:w,j=C.url,I=void 0===j?"":j,y=C.isFailed,T=C.isSafetyError,P=r.default,L=(0,h.useImagePreviewPure)(S,void 0,{disableDownload:!0}),B=L.imageEventCallbacks,N=B.onImageClick,A=B.onImageRender,E=L.renderImagePreview;return k.length>0?(0,s.jsxs)("div",{className:"flex flex-col gap-8 items-end",children:[(0,s.jsx)("div",{className:o()(g["send-message-box-content"],"whitespace-break-spaces font-[400] bg-[var(--s-color-brand-primary-default)] px-9 py-12","".concat("text-[16px] leading-22")),"data-testid":"message_text_content",children:(0,s.jsx)(m.MessageSendTextContentWrap,{children:M})}),T?(0,s.jsx)(v.SafetyErrorComponent,{text:i("file_upload_safety_reject")}):(0,s.jsx)(f.AttachmentNode,{fileKey:null===(t=k[0])||void 0===t?void 0:t.key,fileName:null===(n=k[0])||void 0===n?void 0:n.file_name})]}):S.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:o()(g["send-message-box-content"],"flex flex-col gap-8"),children:[(0,s.jsx)("div",{className:o()("whitespace-break-spaces font-[400]","".concat("text-[16px] leading-22")),"data-testid":"message_text_content",children:M}),T?(0,s.jsx)(v.SafetyErrorComponent,{text:i("image_upload_safety_error")}):(0,s.jsx)(s.Fragment,{children:1===S.length?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(c.Image,{onImageClick:function(e){T?(0,r.default)():y?P():null==N||N(e,I)},onImageRender:function(e){var t=e.src;return t&&A(t)},src:I,imageOptions:{squareContainer:!0,objectFit:"cover",draggable:!1,width:64,height:64},className:"rounded-10"},I)}):null})]}),T?null:E()]}):(0,s.jsx)("div",{className:"flex flex-col gap-8 items-end",children:(0,s.jsx)("div",{className:o()(g["send-message-box-content"],"whitespace-break-spaces font-[400] bg-[var(--s-color-brand-primary-default)] px-9 py-12","".concat("text-[16px] leading-22")),"data-testid":"message_text_content",children:(0,s.jsx)(m.MessageSendTextContentWrap,{children:i("chat_unsupported_message_type")})})})}},63811:function(e,t,n){"use strict";n.d(t,{MessageSendFileContentPure:function(){return u}});var s=n("97458"),a=n("40492"),r=n("83053"),i=n("78597"),o=n("32720"),l=n("87575"),c=n("54370"),u=function(){var e,t=(0,o.useMessageInBoxCtx)(),n=null!==(e=(0,i.useCompareMemo)(function(){if(!(0,l.isFileMessage)(t))return null;var e=(0,a.default)(t.contentObj.file_list),n=(0,l.isMessageFailed)(t);return{fileContent:e,uploadPercent:void 0,uploadStatus:c.FileStatus.Normal,isFailed:n}}(),r.default))&&void 0!==e?e:{},u=n.fileContent,d=n.uploadPercent,g=n.uploadStatus;return u?(0,s.jsx)(c.FileBox,{fileData:u,fileStatus:g,progressPercent:d}):null}},53907:function(e,t,n){"use strict";n.d(t,{MessageSendImageContentPure:function(){return C}});var s=n("97458");n("52983");var a=n("83053"),r=n("2945"),i=n("37903"),o=n("87608"),l=n.n(o),c=n("78597"),u=n("25211"),d=n("96451"),g=n("32720"),m=n("3461"),v=n("27309"),f=n("55127"),_=n("87575"),x=n("12270"),h=n("54370"),p=n("60302"),C=function(){var e,t=(0,g.useMessageInBoxCtx)(),n=(0,m.useChat)().t,o=null!==(e=(0,c.useCompareMemo)(function(){if(!(0,_.isImageMessage)(t))return null;var e,n,s,a=(0,_.isMessageFailed)(t),r=(null==t?void 0:null===(e=t.contentObj)||void 0===e?void 0:e.image_list)||[],i=r.length>0?r[0]:void 0,o=(0,x.isImageSafetyError)(t);return{url:(null==i?void 0:null===(n=i.image_thumb)||void 0===n?void 0:n.url)||(null==i?void 0:null===(s=i.image_ori)||void 0===s?void 0:s.url),uploadStatus:h.FileStatus.Normal,uploadPercent:void 0,isSafetyError:o,isFailed:a,imageList:r}}(),a.default))&&void 0!==e?e:{},C=o.url,M=void 0===C?"":C,b=o.uploadStatus,k=o.uploadPercent,w=o.isSafetyError,S=o.isFailed,j=o.imageList,I=(0,p.useImagePreviewPure)(void 0===j?[]:j,void 0,{disableDownload:!0}),y=I.imageEventCallbacks,T=y.onImageClick,P=y.onImageRender,L=I.renderImagePreview,B=r.default,N=function(e){if(!w)S?B():null==T||T(e,M)};return w?(0,s.jsx)(v.SafetyErrorComponent,{text:n("image_upload_safety_error")}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:l()(f.SendImageClassNames.container,"w-full h-full relative overflow-hidden",S&&!w&&"cursor-pointer"),"data-testid":"message_image_content",onClick:N,children:[(0,s.jsx)(u.ImageGrid,{gridColumns:1,imgList:[M],children:function(e){return(0,s.jsx)(d.Image,{onImageClick:w?void 0:N,onImageRender:function(e){var t=e.src;return t&&P(t)},src:e,imageOptions:{squareContainer:!0,objectFit:"cover",draggable:!1},errorClassName:f.SendImageClassNames["img-error"]},e)}}),!(0,i.default)(b)&&b!==h.FileStatus.Normal&&(0,s.jsx)("div",{className:f.SendImageClassNames["image-icon-overlay-container"],children:(0,s.jsx)(h.FileOverlay,{progressPercent:k,status:b})})]}),L()]})}},99593:function(e,t,n){"use strict";n.d(t,{MessageSendQuoteContentPure:function(){return v}});var s=n("9161"),a=n("97458"),r=n("83053"),i=n("78597"),o=n("32720"),l=n("4121"),c=n("87575"),u=n("4899"),d=n("72676"),g=n("17287"),m=function(e){var t;return(null==e?void 0:null===(t=e.ext)||void 0===t?void 0:t.translate)||"en"},v=function(e){var t,n=(0,d.useTranslateFn)(),v=(0,o.useMessageInBoxCtx)(),f=null!==(t=(0,i.useCompareMemo)(function(){if(!(0,c.isTextMessage)(v))return null;var e,t,s,a,r,i=(0,u.getMessageText)(v,!1,n("chat_unsupported_message_type"));return{action:(0,l.getMessageActionFromExt)(v),readObj:(null===(e=v.ext)||void 0===e?void 0:e.browser_explain)?JSON.parse(v.ext.browser_explain):{},videoObj:(null===(t=v.ext)||void 0===t?void 0:t.browser_youtube_summary_transcript)?JSON.parse(v.ext.browser_youtube_summary_transcript):{},delineateWords:null!==(r=null===(s=v.ext)||void 0===s?void 0:s.browser_user_query)&&void 0!==r?r:"",translateLanguage:m(v),messageTextContent:i,askObj:(null===(a=v.ext)||void 0===a?void 0:a.browser_ask)?JSON.parse(v.ext.browser_ask):{},isNarrow:!1}}(),r.default))&&void 0!==t?t:{};return f.action?(0,a.jsx)(l.MessageSendQuoteContentUI,(0,s._)({},f)):(0,a.jsx)(g.MessageSendTextContentPure,{})}},17287:function(e,t,n){"use strict";n.d(t,{MessageSendTextContentPure:function(){return g}});var s=n("97458"),a=n("33434"),r=n("78597"),i=n("3461"),o=n("32720"),l=n("8407"),c=n("53493"),u=n("87575"),d=n("4899"),g=function(e){var t=(0,i.useChat)().t,n=(0,o.useMessageInBoxCtx)(),g=(0,r.useCompareMemo)({messageTextContent:(0,u.isTextMessage)(n)?(0,d.getMessageText)(n,!1,t("chat_unsupported_message_type")):t("chat_unsupported_message_type")},a.shallow).messageTextContent;return e.isTemplateMsg?(0,s.jsxs)("div",{className:"flex items-center select-none",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-20 h-20",children:(0,s.jsx)(l.TemplateStarIcon,{})}),(0,s.jsx)("span",{children:g})]}):(0,s.jsx)(c.MessageSendTextContentWrap,{children:g})}},39317:function(e,t,n){"use strict";n.d(t,{MessageSendWritingOrImageSkillContentPure:function(){return x}});var s=n("97458"),a=n("83053"),r=n("87608"),i=n.n(r),o=n("78597"),l=n("8379"),c=n("32720"),u=n("3461"),d=n("40280"),g=n("6124"),m=n("71517"),v=n("87575"),f=n("4899"),_=n("24815"),x=function(){var e,t=(0,c.useMessageInBoxCtx)(),n=(0,u.useChat)().t,r=null!==(e=(0,o.useCompareMemo)(function(){if(!(0,v.isTextMessage)(t))return null;var e=(0,d.getSkillData)(t),s=[null==e?void 0:e.template,null==e?void 0:e.tone,null==e?void 0:e.length,null==e?void 0:e.language,null==e?void 0:e.style];return{skillData:e,skillTagArr:s,messageTextContent:(0,f.getMessageText)(t,!1,n("chat_unsupported_message_type"))}}(),a.default))&&void 0!==e?e:{},x=r.skillData,h=r.skillTagArr,p=r.messageTextContent;if((null==x?void 0:x.skillType)===_.SkillType.WriteAssistant)return(null==x?void 0:x.templateType)===g.WritingSkillTemplateType.Compose?(0,s.jsx)(d.RenderMessageBoxContent,{skillTagArr:h,isNarrow:!1,content:"".concat(n("skill_writing_mode_compose")," ").concat(x.template," ").concat(n("skill_writing_sent_message_conjunction_word"),' "').concat(p,'"')}):(0,s.jsx)(d.RenderMessageBoxContent,{skillTagArr:h,isNarrow:!1,content:"".concat(n("skill_writing_mode_reply")," ").concat(x.template," ").concat(n("skill_writing_sent_message_conjunction_word"),' "').concat(p,'"'),originalText:x.originalText});if((null==x?void 0:x.skillType)===_.SkillType.ImageGeneration)return(0,s.jsx)(d.RenderMessageBoxContent,{skillType:null==x?void 0:x.skillType,skillTagArr:h,isNarrow:!1,content:null!=p?p:""});var C=null==x?void 0:x.targetLang;return(0,s.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,s.jsxs)("div",{className:i()("flex items-center gap-4 font-[400]","text-[16px] leading-22"),children:[(0,s.jsx)(l.ReactComponent,{className:"text-[18px]"}),(0,s.jsx)("span",{children:"".concat(n("flow_web_ext_action_translate_to")," ").concat(C)})]}),(0,s.jsx)("div",{className:"border-solid border-0 border-t border-[rgba(0,0,0,0.12)] pt-8 pr-8 pb-2 pl-0 font-[400]",children:(0,s.jsx)("div",{className:i()(m.content,"leading-17 text-[13px]"),children:p})})]})}},79324:function(e,t,n){"use strict";n.d(t,{SendMessageBoxPure:function(){return y}});var s=n("83316"),a=n("8831"),r=n("52935"),i=n("9161"),o=n("16044"),l=n("97458"),c=n("52983"),u=n("2945"),d=n("87608"),g=n.n(d),m=n("16566"),v=n("85969"),f=n("32720"),_=n("87575"),x=n("33139"),h=n("2871"),p=n("39317"),C=n("17287"),M=n("99593"),b=n("53907"),k=n("63811"),w=n("72243"),S=n("27338"),j=n("59064"),I=function(e){var t,n=(0,j.useMessageListTheme)(),a=n.theme,r=n.user,i="samantha"===a||"coco"===a,o=(0,S.useSharedBaseMessage)({inlineReverse:i,showAvatarAndName:!1,keepAvatarPlaceholder:"coco"===a,avatarUrl:null==r?void 0:null===(t=r.image)||void 0===t?void 0:t.tiny_url,name:null==r?void 0:r.nick_name}),c=o.showMessageActionBar,u=o.debugNode,d=o.avatarBefore,f=o.avatarInlineBefore,_=o.avatarInlineAfter;return(0,l.jsx)(m.MessageBoxBase,{"data-testid":"send_message",className:"mt-12",contentProps:(0,s._)({className:g()((0,s._)({},v["send-message-box-content"],"samantha"===a),(0,s._)({},v["send-message-box-content-coco"],"coco"===a),e.contentClassName)},"data-testid","message_content"),inlineReverse:i,before:d,inlineBefore:f,inlineAfter:_,after:function(e){var t=e.mouseOver;return(0,l.jsx)(l.Fragment,{children:c&&(0,l.jsx)("div",{className:g()("w-full flex items-center",{"h-16":"samantha"===a},{"h-0":"coco"===a},{"opacity-0":!t},{"flex-row-reverse":i}),children:u})})},children:e.renderContent})},y=function(e){var t=(0,a._)({},(0,r._)(e)),n=(0,f.useMessageInBoxCtx)(),s=(0,c.useMemo)(function(){return{isText:(0,_.isTextMessage)(n),isImage:(0,_.isImageMessage)(n),isFile:(0,_.isFileMessage)(n),isComposite:(0,_.isCompositeMessage)(n),isWithQuote:(0,_.isQuoteMessage)(n),isWritingAndImageSkill:(0,_.isWritingOrImageSkillMessage)(n),isReadWebsiteSkill:(0,_.isReadWebsiteMessage)(n),isReadPDFSkillWithLink:(0,_.isReadPDFSkillMessageWithPDFLink)(n),isActionBar:(0,_.isActionBarMessage)(n),isSupported:(0,_.isSupportedSendMessage)(n),isTemplate:(0,_.isTemplateMessage)(n)}},[n]),d=s.isText,g=s.isImage,m=s.isFile,S=s.isComposite,j=s.isWithQuote,y=s.isWritingAndImageSkill,T=s.isReadWebsiteSkill,P=s.isReadPDFSkillWithLink,L=s.isSupported,B=s.isTemplate;return L?B?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{renderContent:function(){return(0,l.jsx)(C.MessageSendTextContentPure,{isTemplateMsg:!0})}})):d&&y?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{renderContent:function(){return(0,l.jsx)(p.MessageSendWritingOrImageSkillContentPure,{})}})):d&&T?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{renderContent:function(){return(0,l.jsx)(x.MessageSendReadWebsiteSkillContent,{})}})):P?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{contentClassName:"!p-0 !bg-transparent",renderContent:function(){return(0,l.jsx)(h.MessageSendReadPDFSkillWithLinkContent,{})}})):d&&j?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{renderContent:function(){return(0,l.jsx)(M.MessageSendQuoteContentPure,{})}})):d?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{onEditClick:u.default,showOuterBox:!0,renderContent:function(){return(0,l.jsx)(C.MessageSendTextContentPure,{})}})):g?I&&b.MessageSendImageContentPure&&(0,l.jsx)(I,(0,o._)((0,i._)({},t),{contentClassName:v["send-image-content"],renderContent:function(e){var t=e.inView;return(0,l.jsx)(b.MessageSendImageContentPure,{inView:t})}})):m?I&&k.MessageSendFileContentPure&&(0,l.jsx)(I,(0,o._)((0,i._)({},t),{contentClassName:v["send-file-content"],renderContent:function(){return(0,l.jsx)(k.MessageSendFileContentPure,{})}})):S?(0,l.jsx)(I,(0,o._)((0,i._)({},t),{contentClassName:v["send-composite-content"],renderContent:function(){return(0,l.jsx)(w.MessageSendCompositeContentPure,{})}})):null:I&&(0,l.jsx)(I,(0,o._)((0,i._)({},t),{renderContent:function(){return(0,l.jsx)(C.MessageSendTextContentPure,{})}}))}},2871:function(e,t,n){"use strict";n.d(t,{MessageSendReadPDFSkillWithLinkContent:function(){return v}});var s=n("97458"),a=n("24682"),r=n("50002"),i=n("87608"),o=n.n(i),l=n("32720"),c=n("53493"),u=n("71764"),d=n("91006"),g=function(e){var t,n=null==e?void 0:null===(t=e.contentObj)||void 0===t?void 0:t.text;return n&&(0,a.default)(n)?n:void 0},m=function(e){var t,n=null==e?void 0:null===(t=e.contentObj)||void 0===t?void 0:t.link_model,s=(0,r.default)(n,["url"],void 0);return s&&(0,a.default)(s)?s:void 0},v=function(){var e=(0,l.useMessageInBoxCtx)(),t=g(e),n=m(e);return(0,s.jsxs)("div",{className:"flex flex-col gap-8 items-end",children:[!!t&&(0,s.jsx)("div",{className:o()(d["send-message-box-content"],"whitespace-break-spaces font-[400] bg-[var(--s-color-brand-primary-default)] px-9 py-12","".concat("text-[16px] leading-22")),"data-testid":"message_text_content",children:(0,s.jsx)(c.MessageSendTextContentWrap,{children:t})}),n&&(0,s.jsx)(u.AttachmentNode,{fileLink:n,fileName:n,attchmentType:"PDF Link"})]})}},33139:function(e,t,n){"use strict";n.d(t,{MessageSendReadWebsiteSkillContent:function(){return u}});var s=n("97458"),a=n("3461"),r=n("53493"),i=n("32720"),o=n("4899"),l=n("87575"),c=function(e){var t=e.message,n=(0,a.useChat)(),i=n.t,l=n.enableMessageDebug,c=(0,o.getMessageText)(t,l,i("chat_unsupported_message_type"));return(0,s.jsx)(r.MessageSendTextContentWrap,{children:c})},u=function(){var e=(0,i.useMessageInBoxCtx)();return(0,l.isReadWebsiteMessageWithLink)(e)?(0,s.jsx)(c,{message:e}):(0,l.isReadWebsiteMessageWithPrompt)(e)?(0,s.jsx)(c,{message:e}):null}},28502:function(e,t,n){"use strict";n.d(t,{MessageBoxPure:function(){return _}});var s=n("9161"),a=n("89334"),r=n("97458"),i=n("52983"),o=n("33434"),l=n("78597"),c=n("32720"),u=n("87575"),d=n("79324"),g=n("77438"),m=n("73302"),v=n("59064"),f=function(e){var t,n=e.messageLink,s=e.getMessage,a=null===(t=(0,v.useMessageListTheme)().displayOptions)||void 0===t?void 0:t.enableOnboarding,r=s(n),i=null==r?void 0:r.section_id;return(0,l.useCompareMemo)({isExist:!!r&&(0,u.isMessageVisible)(r,0,!a),isSend:(0,m.isSendMessagePure)(r),isNotLastSection:i?i!==(null==r?void 0:r.section_id):void 0},o.shallow)},_=function(e){var t=e.messageLink,n=e.getMessage,u=(0,a._)(e,["messageLink","getMessage"]),m=f({messageLink:t,getMessage:n}),v=m.isSend,_=m.isExist,x=(0,l.useCompareMemo)(t,o.shallow),h=(0,l.useCompareMemo)(n(x),o.shallow),p=(0,i.useMemo)(function(){return{useMessage:function(){return h},useMessageLink:function(){return x}}},[h,x]);return _?(0,r.jsx)(c.MessageBoxContext.Provider,{value:p,children:v?(0,r.jsx)(d.SendMessageBoxPure,(0,s._)({isSend:!0},u)):(0,r.jsx)(g.ReceiveMessageBoxPure,(0,s._)({isSend:!1},u))}):null}},73302:function(e,t,n){"use strict";n.d(t,{isSendMessagePure:function(){return a}});var s=n("87575"),a=function(e){return(null==e?void 0:e.reply_id)==="0"&&!(0,s.isOnBoardingMessage)(e)}},32720:function(e,t,n){"use strict";n.d(t,{MessageBoxContext:function(){return a},useMessageInBoxCtx:function(){return i},useMessageLinkInBoxCtx:function(){return o}}),n("97458");var s=n("52983");n("78597");var a=(0,s.createContext)({useMessageLink:function(){},useMessage:function(){}}),r=function(){return(0,s.useContext)(a)},i=function(){return r().useMessage()},o=function(){return r().useMessageLink()}},2655:function(e,t,n){"use strict";n.d(t,{MessageArticleContent:function(){return g}});var s=n("83316"),a=n("97458"),r=n("52983"),i=n("87608"),o=n.n(i),l=n("53268"),c=n("91808"),u=l.Typography.Title,d=l.Typography.Text,g=function(e){var t=e.article,n=e.onClick,i=t.title,l=t.sub_title,g=t.image_url,m=t.avatar_url,v=t.site_name,f=!!g,_=(0,r.useRef)(null),x=_.current&&parseInt(getComputedStyle(_.current).height)||0;return(0,a.jsxs)("div",{className:o()(c["article-content-wrapper"],(0,s._)({},c["oversea-card"],!1)),onClick:n,children:[g&&(0,a.jsx)("img",{className:c["article-cover"],src:g,alt:"cover"}),(0,a.jsx)(u,{heading:6,className:o()(c["article-title"],(0,s._)({},c["no-cover"],!f)),ellipsis:{rows:3,showTooltip:!1},children:i}),!f&&l&&(0,a.jsx)("div",{className:o()(c["article-desc"]),ref:_,children:(0,a.jsx)(d,{type:"tertiary",className:o()(c["article-desc-text"]),ellipsis:{rows:Math.max(x?Math.floor(x/20.8):5,1),showTooltip:!1},children:l})}),(0,a.jsxs)("div",{className:c["article-author"],children:[m&&(0,a.jsx)("div",{className:c["article-author-avatar"],children:(0,a.jsx)("img",{src:m,alt:""})}),(0,a.jsx)(d,{type:"tertiary",className:c["article-author-name"],ellipsis:{rows:1,showTooltip:!1},children:v})]})]})}},69341:function(e,t,n){"use strict";n.d(t,{MessageCardListContentUI:function(){return C}});var s=n("92769"),a=n("83316"),r=n("40509"),i=n("88802"),o=n("97458"),l=n("28377"),c=n("52983"),u=n("59574"),d=n("87608"),g=n.n(d),m=n("9407"),v=n("1438"),f=n("2655"),_=n("8407"),x=n("78004"),h=n("91808"),p=function(){return(0,o.jsx)("div",{className:h["suspense-placeholder"]})},C=function(e){var t,n,d=e.inView,C=e.data,M=e.onSearchIconShow,b=e.onSearchIconClick,k=e.onEnterVideoPlayer,w=e.onClickSearchCard,S=e.getVideoCache,j=e.trackEvent,I=(0,x.useBaseSlots)().VideoBox,y=(0,r._)((0,c.useState)(),2),T=y[0],P=y[1],L=(0,c.useMemo)(function(){var e=[],t=(null==C?void 0:C.search_result)||{},n=t.video_card,s=t.text_card,a=(null==n?void 0:n.card_list)||[],r=(null==s?void 0:s.card_list)||[];return a.length&&(r.length?e.push({type:"video",data:a[0]}):a.forEach(function(t){e.push({type:"video",data:t})})),r.forEach(function(t){e.push({type:"text",data:t})}),{searchList:e,videoList:{video_list:null==a?void 0:a.map(function(e){return{item_id:e.item_id,video_captions:e.video_captions,source_from:e.source_from,source_app_name:e.source_app_name,source_app_icon:e.source_app_icon,album_image:e.album_image,vid:"",media_width:0,media_height:0}}),query:"",search_id:"",offset:2,limit:a.length,has_more:!0}}},[C]),B=L.searchList,N=L.videoList,A=null==C?void 0:null===(n=C.ext)||void 0===n?void 0:n.search_url_web;var E=(t=(0,s._)(function(e){var t,n,s,a,r,o,l,c,u,d;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return n=!!(null===(t=e.item_ids)||void 0===t?void 0:t.length),[4,null==S?void 0:S({isInitialize:n,initializeParams:e,loadMoreParams:{query_params:T||(null==C?void 0:C.query_params),query_type:v.SearchCardsQueryType.DouYin}})];case 1:if(!(s=i.sent()))return[2];if("init"===s.type)return[2,s.data];if("loadMore"===s.type)return P(null===(a=s.data)||void 0===a?void 0:a.query_params),[2,{video_list:null===(l=s.data)||void 0===l?void 0:null===(o=l.search_result)||void 0===o?void 0:null===(r=o.video_card)||void 0===r?void 0:r.card_list,has_more:!!(null===(d=s.data)||void 0===d?void 0:null===(u=d.query_params)||void 0===u?void 0:null===(c=u.video_card)||void 0===c?void 0:c.some(function(e){return e.has_more}))}];return[2,{}]}})}),function(e){return t.apply(this,arguments)});return(0,o.jsx)("div",{style:{position:"relative"},children:(0,o.jsx)("div",{className:h["card-wrapper-outer"],children:(0,o.jsxs)("div",{className:g()(h["card-wrapper"],(0,a._)({},h.hidden,(0,u.default)(B))),children:[(0,o.jsx)(m.Carousel,{rows:1,children:(0,o.jsxs)("div",{className:h["card-list"],children:[B.map(function(e,t){var n=e.type,s=e.data;return"text"===n?(0,o.jsx)(l.InView,{triggerOnce:!0,onChange:function(e){e&&j("search_card_show",{card_type:"search_slide_card",position:t+1})},children:(0,o.jsx)(f.MessageArticleContent,{article:{title:s.title,sub_title:s.summary,image_url:s.image_url,avatar_url:s.logo_url,site_name:s.sitename},onClick:function(){window.open(s.url),null==w||w({message_type:"search_card",url:s.url})}},"".concat(s.doc_id,"_").concat(t))}):"video"===n&&I?(0,o.jsx)(l.InView,{triggerOnce:!0,onChange:function(e){e&&j("video_card_show",{card_type:"search_slide_card",position:t+1})},children:(0,o.jsx)(I,{inView:d,currentPlay:s.item_id,videoContent:N,onVideoPlay:E,cardDisplayType:"bottom",onTrackEvent:function(e){"enter_video_player"===e&&(null==k||k(),null==w||w({message_type:"search_video"}))}},"".concat(s.item_id,"_").concat(t))}):void 0}),(0,u.default)(B)?(0,o.jsx)(o.Fragment,{children:[1,2,3,4,5].map(function(e){return(0,o.jsx)(p,{},e)})}):null,A&&(0,o.jsx)("div",{className:h["card-search-icon-wrapper"],children:(0,o.jsx)(l.InView,{triggerOnce:!0,onChange:function(e){e&&(null==M||M())},children:(0,o.jsx)("div",{className:h["card-search-icon"],onClick:function(){window.open(A),null==b||b({to_status:A})},children:(0,o.jsx)("div",{style:{display:"flex",transform:"scale(1.2)"},children:(0,o.jsx)(_.SearchActionIcon,{})})})})})]})}),(0,o.jsx)("div",{className:h["card-item-left-mask"]}),(0,o.jsx)("div",{className:h["card-item-right-mask"]})]})})})}},18714:function(e){"use strict";e.exports={"message-list-root":"message-list-root-cecbe7",messageListRoot:"message-list-root-cecbe7"}},40450:function(e){"use strict";e.exports={"bot-card-content-box":"bot-card-content-box-ad453e",botCardContentBox:"bot-card-content-box-ad453e","card-content-box":"card-content-box-_85610",cardContentBox:"card-content-box-_85610","card-list-content-box":"card-list-content-box-a5e31b",cardListContentBox:"card-list-content-box-a5e31b","image-content-box":"image-content-box-_175a7",imageContentBox:"image-content-box-_175a7","music-content-box":"music-content-box-f71df9",musicContentBox:"music-content-box-f71df9","receive-message-box-content":"receive-message-box-content-_8c579",receiveMessageBoxContent:"receive-message-box-content-_8c579","receive-message-box-content-coco":"receive-message-box-content-coco-_80a77",receiveMessageBoxContentCoco:"receive-message-box-content-coco-_80a77","video-content-box":"video-content-box-_58166",videoContentBox:"video-content-box-_58166"}},91006:function(e){"use strict";e.exports={"send-message-box-content":"send-message-box-content-_5d7b6",sendMessageBoxContent:"send-message-box-content-_5d7b6","send-message-box-content-coco":"send-message-box-content-coco-_4378b",sendMessageBoxContentCoco:"send-message-box-content-coco-_4378b"}},91808:function(e){"use strict";e.exports={"article-author":"article-author-ae776b",articleAuthor:"article-author-ae776b","article-author-avatar":"article-author-avatar-_5cfd4",articleAuthorAvatar:"article-author-avatar-_5cfd4","article-author-name":"article-author-name-c7b225",articleAuthorName:"article-author-name-c7b225","article-content-wrapper":"article-content-wrapper-_019f2",articleContentWrapper:"article-content-wrapper-_019f2","article-cover":"article-cover-a98be8",articleCover:"article-cover-a98be8","article-desc":"article-desc-_294e1",articleDesc:"article-desc-_294e1","article-desc-text":"article-desc-text-_30f80",articleDescText:"article-desc-text-_30f80","article-title":"article-title-_51ddc",articleTitle:"article-title-_51ddc","bg-color":"bg-color-facaef",bgColor:"bg-color-facaef","card-item-button-wrapper":"card-item-button-wrapper-_109ce",cardItemButtonWrapper:"card-item-button-wrapper-_109ce","card-item-left":"card-item-left-_2abdb",cardItemLeft:"card-item-left-_2abdb","card-item-left-icon":"card-item-left-icon-ae0f81",cardItemLeftIcon:"card-item-left-icon-ae0f81","card-item-left-mask":"card-item-left-mask-_33272",cardItemLeftMask:"card-item-left-mask-_33272","card-item-right":"card-item-right-_2333d",cardItemRight:"card-item-right-_2333d","card-item-right-icon":"card-item-right-icon-_78fc8",cardItemRightIcon:"card-item-right-icon-_78fc8","card-item-right-mask":"card-item-right-mask-_6c21b",cardItemRightMask:"card-item-right-mask-_6c21b","card-list":"card-list-c24939",cardList:"card-list-c24939","card-search-icon":"card-search-icon-_93eb8",cardSearchIcon:"card-search-icon-_93eb8","card-search-icon-wrapper":"card-search-icon-wrapper-d0b2a7",cardSearchIconWrapper:"card-search-icon-wrapper-d0b2a7","card-wrapper":"card-wrapper-_07fee",cardWrapper:"card-wrapper-_07fee","left-remain":"left-remain-a3731c",leftRemain:"left-remain-a3731c","no-cover":"no-cover-d17781",noCover:"no-cover-d17781","oversea-card":"oversea-card-_1249e",overseaCard:"oversea-card-_1249e","right-remain":"right-remain-_60e4b",rightRemain:"right-remain-_60e4b","suspense-placeholder":"suspense-placeholder-_7932c",suspensePlaceholder:"suspense-placeholder-_7932c"}}}]);