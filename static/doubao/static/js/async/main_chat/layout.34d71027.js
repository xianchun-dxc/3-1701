/*! For license information please see layout.34d71027.js.LICENSE.txt */
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["8371"],{9932:function(t,e,n){"use strict";n.d(e,{BROWSER_SETTING_URL_PROTOCOL:function(){return o},CLIENT_AUTO_LOGIN_ROUTE:function(){return i}});var o="doubao://doubao-settings",i="/client-auto-login"},74956:function(t,e,n){"use strict";n.d(e,{ChatListBotList:function(){return C}});var o=n("40509"),i=n("97458"),a=n("28377"),r=n("52983"),s=n("33434"),c=n("37903"),l=n("88128"),u=n("10630"),d=n("62920"),h=n("87575"),v=n("96317"),f=n("59240"),_=n("72676"),m=n("3269"),b=n("90780"),g=n("95455"),p=n("41319"),w=n("36297"),S=n("15893"),x=n("95986"),C=function(t){var e=t.stickyRef,n=t.onAllInvView,C=t.onCollapse,I=(0,_.useTranslateFn)(),y=(0,l.useIsNarrowScreen)(),k=(0,b.getChatIdFromURL)(),L=(0,o._)((0,d.useChatStore)(function(t){return[t.insertConversationToLinks]},s.shallow),1)[0],T=(0,u.useConversation)(k),j=(0,o._)((0,r.useState)(!1),2),N=j[0],B=j[1],E=(0,r.useRef)(null),R=(0,m.useChoicenessBotListExcludeConversation)(),F=(0,r.useRef)(new Set),O=(0,u.useBotConversationList)(),A=O.botConversationLinks,P=O.conversationListStatus,M=(0,r.useRef)({oldChatId:k,done:!1});(0,r.useEffect)(function(){k&&T&&P.initiated&&!M.current.done&&k===M.current.oldChatId&&(0,h.isBotConversation)(T)&&T.conversation_id&&(M.current.done=!0,L({conversationId:T.conversation_id,index:1}))},[k,T,P.initiated]);var D=(0,r.useMemo)(function(){return!!k&&(T?(0,h.isBotConversation)(T):R.find(function(t){return t.botID===k}))},[k,T,R]),U=function(t){return!!(!t||F.current.has(t))||(F.current.add(t),!1)},V=function(t){B(function(e){var n=!e;return!(0,c.default)(t)&&(n=!!t),(0,f.trackEvent)("bot_expand_action",{after_click_status:n?"expand":"close"}),n})};(0,r.useEffect)(function(){C(N)},[N]),(0,r.useEffect)(function(){var t,e=E.current;e&&(N?e.style.height="".concat(null===(t=e.firstChild)||void 0===t?void 0:t.offsetHeight,"px"):e.style.height="0px")},[A.length,R.length,P.loading,N]),(0,r.useEffect)(function(){D&&V(!0)},[D]);var G=(0,o._)((0,a.useInView)({initialInView:!1,threshold:.5}),2),H=G[0],W=G[1];return(0,r.useEffect)(function(){n(W)},[W]),(0,i.jsx)(i.Fragment,{children:A.length||R.length?(0,i.jsxs)(g.Section,{children:[(0,i.jsx)(p.AutoSticky,{top:0,threshold:1,getRoot:function(){return e.current},stickyStyle:{backgroundColor:"#fff",boxShadow:"0px 20px 20px 0px #fff"},children:(0,i.jsxs)(g.Section.Item,{className:x.mainItem,onClick:function(){return V()},children:[(0,i.jsx)(g.Section.ItemIcon,{svg:(0,i.jsx)(v.ChatlistBotIcon,{})}),(0,i.jsx)(g.Section.ItemTitle,{className:x.title,children:I("siderbar_bots_entrance")}),N?(0,i.jsx)(v.ArrowDownIcon,{"data-testid":"bot_list_collapse_close_icon",className:x["right-icon"]}):(0,i.jsx)(v.ArrowRightIcon,{"data-testid":"bot_list_collapse_open_icon",className:x["right-icon"]})]})}),(0,i.jsx)("div",{ref:E,className:x["collapse-content"],children:(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[A.length?(0,i.jsx)(i.Fragment,{children:A.map(function(t,e){return 0===R.length&&e===A.length-1?(0,i.jsx)("div",{ref:H,children:(0,i.jsx)(w.ChatItemForConversation,{"data-testid":"chat_list_bot_item",conversationLink:t,hasBotShow:U,enableOverflowTooltip:!y},t.conversationId)},t.conversationId):(0,i.jsx)(r.Fragment,{children:(0,i.jsx)(w.ChatItemForConversation,{"data-testid":"chat_list_bot_item",conversationLink:t,hasBotShow:U,enableOverflowTooltip:!y},t.conversationId)},t.conversationId)})}):null,!P.hasMore&&(0,i.jsx)(i.Fragment,{children:R.map(function(t,e){return e===R.length-1?(0,i.jsx)("div",{ref:H,children:(0,i.jsx)(w.ChatItemForBot,{botLink:t,hasBotShow:U,enableOverflowTooltip:!y},t.botID)},t.botID):(0,i.jsx)(w.ChatItemForBot,{botLink:t,hasBotShow:U,enableOverflowTooltip:!y},t.botID)})}),P.loading&&(0,i.jsx)(S.LoadMorePure,{safeMargin:"6",className:x.load})]})})]}):null})}},66708:function(t,e,n){"use strict";n.d(e,{ChatItem:function(){return P}});var o=n("83316"),i=n("9161"),a=n("16044"),r=n("89334"),s=n("40509"),c=n("97458"),l=n("28377"),u=n("52983"),d=n("87608"),h=n.n(d),v=n("65042"),f=n("78597"),_=n("91165"),m=n("10630"),b=n("87575"),g=n("54769"),p=n("75761"),w=n("53277"),S=n("62920"),x=n("96317"),C=n("32208"),I=n("48160"),y=n("53268"),k=n("97213"),L=n("94686"),T=n("59240"),j=n("2738"),N=n("82169");n("58416");var B=n("29441"),E=n("95455"),R=n("1284"),F=n("9632"),O=n("74307"),A=n("37245"),P=function(t){var e,n,a,d,v,f=t.navTo,C=t.switchChat,I=t.conversation,B=t.bot,E=t.lastMessageIndex,F=t.hasBotShow,P=t.hasMenu,D=void 0===P||P,U=t.conversationType,V=t.className,G=t.onClick,H=t.enableOverflowTooltip,W=void 0===H||H,K=(0,r._)(t,["navTo","switchChat","conversation","bot","lastMessageIndex","hasBotShow","hasMenu","conversationType","className","onClick","enableOverflowTooltip"]),z=(0,g.useMessageLinks)((null==I?void 0:I.conversation_id)||""),q=(0,b.isCocoConversationType)(U),J=(0,s._)((0,l.useInView)({triggerOnce:!0,initialInView:!1,threshold:1}),2),Q=J[0],X=J[1],Y=(0,L.useUserInfo)(),Z=(0,p.getInfoByConversationId)(null==I?void 0:I.conversation_id).botInfo,$=Z||B||{},tt=$.bot_id,te=$.creator_info,tn=$.name,to=(null==te?void 0:te.creator_id)===(null==Y?void 0:Y.user_id_str),ti=(0,R.useReviewStatusText)(null!==(v=null==Z?void 0:Z.disabled_tag)&&void 0!==v?v:"");var ta=(e=to,n=Z,a=I,e?!(0,b.isCocoSubConversation)(a)&&[N.DisabledTag.Reviewing,N.DisabledTag.Ban,N.DisabledTag.Rollback].includes(null==n?void 0:n.disabled_tag):!(0,b.isCocoSubConversation)(a)&&(null==n?void 0:n.disabled_tag)===N.DisabledTag.Ban);var tr=(null==(d=Z)?void 0:d.disabled_tag)===N.DisabledTag.Reviewing?A["review-tag"]:(null==d?void 0:d.disabled_tag)===N.DisabledTag.Ban||(null==d?void 0:d.disabled_tag)===N.DisabledTag.Rollback?A["ban-tag"]:A.tag,ts=(0,j.checkIsCurrentActivedChat)(f),tc=(0,u.useRef)(null),tl=(0,s._)((0,u.useState)(!1),2),tu=tl[0],td=tl[1],th=E?(0,p.getUnreadCount)({message_index:(0,w.getLastMessageIndexForUnreadCount)((null==I?void 0:I.conversation_id)||"",z,E),read_message_index:null==E?void 0:E.read_message_index}):0;(0,u.useEffect)(function(){if(X){if(I&&(0,b.isCocoSubConversation)(I)&&!(null==F?void 0:F(tt||"",null==I?void 0:I.conversation_id))){var t=I.name,e=I.conversation_id,n=I.conversation_type,o=(0,m.getThreadLinksFromConversationLinks)(S.useChatStore.getState()).findIndex(function(t){return t.conversationId===(null==I?void 0:I.conversation_id)});(0,T.trackEvent)("historic_thread_single_show",{thread_rnk:o>-1?o+1:void 0,thread_topic:t,conversation_id:e,conversation_type:n,chat_type:"default_new"})}else(null==F?void 0:F(tt||""))&&(0,T.trackEvent)("show_bot_chat",{bot_id:null!=tt?tt:null==I?void 0:I.bot_id,enter_from:"bot_list",chat_type:(0,p.getChatTypeForTea)(null==I?void 0:I.conversation_id,Z),conversation_type:null==I?void 0:I.conversation_type})}},[X]);var tv=(0,u.useRef)(0);return(0,u.useEffect)(function(){X&&th&&(null==I?void 0:I.conversation_id)&&(null==E?void 0:E.message_index)&&E.message_index>tv.current&&(tv.current=E.message_index,(0,T.trackEvent)("red_dot_show",{bot_id:null!=tt?tt:null==I?void 0:I.bot_id,conversation_id:null==I?void 0:I.conversation_id,conversation_type:null==I?void 0:I.conversation_type,show_from:"chat_bot_list",chat_type:(0,p.getChatTypeForTea)(null==I?void 0:I.conversation_id,Z),red_dot_cnt:th}))},[X,th,null==I?void 0:I.conversation_id,null==E?void 0:E.message_index]),(0,c.jsx)(M,(0,i._)({ref:Q,id:(null==I?void 0:I.conversation_id)?"conversation_".concat(null==I?void 0:I.conversation_id):"bot_".concat(null==B?void 0:B.bot_id),className:V,alt:tn,conversationType:U,navTo:f,switchChat:C,avatarSrc:(0,k.getBotListAvatarUrl)(I)||(0,k.getBotListAvatarUrl)(B),onClick:G,renderContent:function(){var t;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:h()(A.wrapper,(0,o._)({},A.mainBot,q)),onMouseEnter:function(){return td(!0)},onMouseLeave:function(){return td(!1)},children:(0,c.jsxs)("div",{className:A.content,children:[(0,c.jsx)("span",{"data-testid":"chat_list_item_title",className:h()(A.title),ref:tc,children:(null==I?void 0:I.name)||(null==B?void 0:B.name)}),!1,ta&&(0,c.jsx)(y.Tooltip,{content:ti,autoAdjustOverflow:!0,arrowPointAtCenter:!0,showArrow:!0,motion:!0,trigger:"hover",children:(0,c.jsx)(y.Tag,{size:"small",shape:"circle",className:tr,children:ti})}),!(0,b.isCocoSubConversation)(I)&&(null==I?void 0:I.pinned)&&(0,c.jsx)(x.PinnedConversationIcon,{"data-testid":"chat_list_item_pin_icon",className:A.pinned})]})}),(0,c.jsxs)("div",{className:A.extra,children:[(0,c.jsx)("div",{className:A["unread-point-wrapper"],children:ts?null:(0,c.jsx)(_.Badge,{count:th,className:h()(A.badge,"text-10 font-bold"),"data-testid":"chat_list_item_unread_count"})}),D&&!(0,b.isCocoConversation)(I)?(0,c.jsx)("div",{className:A["chat-item-menu-wrapper"],onMouseEnter:function(){return td(!0)},onMouseLeave:function(){return td(!1)},children:(0,c.jsx)(O.ChatItemMenu,{conversation:I,bot:B,trigger:"hover",trackParams:{click_from:"chat_bot_list"}})}):null]}),(0,c.jsx)(y.Tooltip,{className:"chat-item-overflow-tooltip",trigger:"custom",position:"right",showArrow:!1,visible:!!(W&&tu&&(null===(t=tc.current)||void 0===t?void 0:t.offsetWidth)&&tc.current.offsetWidth<tc.current.scrollWidth),content:(0,c.jsx)("span",{"data-testid":"chat_item_overflow_tooltip",children:(null==I?void 0:I.name)||(null==B?void 0:B.name)}),onClickOutSide:function(){td(!1)},children:(0,c.jsx)("div",{className:A["chat-item-overflow-tooltip-trigger"]})})]})}},K))},M=(0,u.forwardRef)(function(t,e){var n=t.id,l=t.navTo,d=t.switchChat,_=t.avatarSrc,m=t.renderContent,g=t.alt,p=t.className,w=t.conversationType,S=t.onClick,x=(0,r._)(t,["id","navTo","switchChat","avatarSrc","renderContent","alt","className","conversationType","onClick"]),k=(0,B.useChatListTheme)().bgUseNewStyle,L=(0,C.useLocation)(),T=(0,f.parseHashOrQuery)(L.search),j=(0,s._)((0,u.useState)(),2),N=j[0],R=j[1],O=(0,u.useRef)(!1),P=(0,v.getIsMobileOrIPad)()&&(0,v.isAppleWebkit)();return(0,c.jsxs)(I.NavLink,(0,a._)((0,i._)({id:n,to:l,className:function(t){var e=t.isActive,n=(0,b.isCocoConversationType)(w),i=e||n&&"1"===T.first_login_app;return h()(E.Style["section-item"],A["chat-item"],k&&A["chat-item-new-bg"],(0,o._)({},A["active-link"],i),(0,o._)({},E.Style.active,i),{"e2e-test-active":i},(0,o._)({},A.mainCoco,(0,b.isCocoConversationType)(w)),"no-select",p)},onClick:function(t){return null==S||S(),d(),t.preventDefault()},onTouchStart:P?function(){O.current=!1}:void 0,onTouchMove:P?function(){O.current=!0}:void 0,onTouchEnd:P?function(){!O.current&&d()}:void 0,draggable:"false",ref:e},x),{children:[!(0,b.isCocoSubConversationType)(w)&&(0,c.jsx)(y.Avatar,{"data-testid":"chat_list_item_avatar",className:A.avatar,src:N||_||F,alt:g||"",onError:function(t){R(F)}}),m()]}))})},36297:function(t,e,n){"use strict";n.d(e,{ChatItemForBot:function(){return L},ChatItemForConversation:function(){return k}});var o=n("9161"),i=n("89334"),a=n("97458"),r=n("52983"),s=n("33434"),c=n("40789"),l=n("46750"),u=n("10630"),d=n("87575"),h=n("62920"),v=n("75761"),f=n("32208"),_=n("99956"),m=n("59240"),b=n("72676"),g=n("3269"),p=n("82169"),w=n("66708"),S=n("18271"),x=function(t,e){if(e){var n=t.findIndex(function(t){return t.conversationId===e.conversation_id});return n>-1?n+1:void 0}},C=function(t,e,n){if((0,d.isCocoConversation)(t))return 0;if((0,d.isCocoSubConversation)(t))return x((0,u.getThreadLinksFromConversationLinks)(h.useChatStore.getState()),t);var o=(0,u.getBotConversationListFromConversationLinks)(h.useChatStore.getState()),i=x(o,t);return i?i:(null==e?void 0:e.bot_id)&&(null==n?void 0:n.length)&&(i=n.findIndex(function(t){return t.botID===e.bot_id}))>-1?o.length+i+1:void 0},I=function(t){var e=t.hasMenu,n=t.conversationLink,r=t.hasBotShow,s=t.onClick,c=t.enableOverflowTooltip,h=(0,i._)(t,["hasMenu","conversationLink","hasBotShow","onClick","enableOverflowTooltip"]),v=(0,b.useTranslateFn)(),_=(0,f.useNavigate)(),m=(0,u.useLocalConversation)(null==n?void 0:n.conversationId),g=m&&(0,d.isCocoConversation)(m)?"./".concat(null==n?void 0:n.conversationId):(0,l.isLocalThreadId)(null==n?void 0:n.threadId,"FirstEnter")||(0,l.isLocalThreadId)(null==n?void 0:n.threadId,"ClickButton")?"./":"./".concat(null==m?void 0:m.conversation_id);return m?(0,a.jsx)(w.ChatItem,(0,o._)({hasMenu:e,hasBotShow:r,conversationType:null==m?void 0:m.conversation_type,navTo:g,switchChat:function(){!(!m||(0,l.isLocalThreadId)(null==n?void 0:n.threadId))&&_(g,{state:{enter_from:"click_chat",bot_position:C(m)}})},conversation:m,fallbackOnboardingInfo:v("im_list_message_placeholder"),onClick:s,enableOverflowTooltip:c},h)):null},y=function(t){var e=t.conversationLink,n=t.bot,r=t.hasBotShow,l=t.onClick,_=t.enableOverflowTooltip,x=(0,i._)(t,["conversationLink","bot","hasBotShow","onClick","enableOverflowTooltip"]),I=(0,b.useTranslateFn)(),y=(0,f.useNavigate)(),k=(0,h.useChatStore)(function(t){return t.lastMessageIndexMap[(null==e?void 0:e.conversationId)||""]},s.shallow),L=(0,g.useChoicenessBotListExcludeConversation)(),T=(0,u.useConversation)(null==e?void 0:e.conversationId),j=T&&(0,d.isCocoConversation)(T)?"./".concat(null==e?void 0:e.conversationId):T?"./".concat(T.conversation_id):"./".concat(null==n?void 0:n.bot_id,"?type=").concat(p.ChatType.Bot),N=(0,S.useFlowSlotsContext)().changeSideBarVisible;return n||T?(0,a.jsx)(w.ChatItem,(0,o._)({hasBotShow:r,conversationType:null==T?void 0:T.conversation_type,navTo:j,switchChat:function(){if(T||n){if(T&&(0,d.isCocoSubConversation)(T)){var t=T.name,e=T.conversation_id,o=T.conversation_type,i=c.usePageHistoryStore.getState().getCurPrevPage(!0).curPage,a=(0,v.getChatTypeForTea)(null==T?void 0:T.conversation_id),r=(0,u.getThreadLinksFromConversationLinks)(h.useChatStore.getState()).findIndex(function(t){return t.conversationId===(null==T?void 0:T.conversation_id)});(0,m.trackEvent)("historic_thread_single_click",{current_page:i,thread_rnk:r>-1?r+1:void 0,thread_topic:t,conversation_id:e,conversation_type:o,chat_type:a,click_from:"chat"})}y(j,{state:{enter_from:"click_chat",bot_position:C(T,n,L)}}),N()}},conversation:T,lastMessageIndex:k,bot:n,fallbackOnboardingInfo:I("im_list_message_placeholder"),onClick:l,enableOverflowTooltip:_},x)):null},k=(0,r.memo)(function(t){var e=t.hasMenu,n=t.conversationLink,r=t.hasBotShow,s=t.onClick,c=t.enableOverflowTooltip,l=(0,i._)(t,["hasMenu","conversationLink","hasBotShow","onClick","enableOverflowTooltip"]);return(null==n?void 0:n.isLocalConversation)?(0,a.jsx)(I,(0,o._)({hasMenu:e,hasBotShow:r,conversationLink:n,onClick:s,enableOverflowTooltip:c},l)):(0,a.jsx)(y,(0,o._)({hasBotShow:r,conversationLink:n,onClick:s,enableOverflowTooltip:c},l))}),L=(0,r.memo)(function(t){var e=t.botLink,n=t.hasBotShow,o=t.enableOverflowTooltip,i=(0,_.useBotInfo)(null==e?void 0:e.botID);return(0,a.jsx)(y,{hasBotShow:n,bot:i,enableOverflowTooltip:o})})},52282:function(t,e,n){"use strict";n.d(e,{ChatList:function(){return y}});var o=n("83316"),i=n("40509"),a=n("97458"),r=n("52983"),s=n("87608"),c=n.n(s),l=n("9317"),u=n("65042"),d=n("88128"),h=n("10630"),v=n("68628"),f=n("62966"),_=n("80693"),m=n("76460"),b=n("29441"),g=n("95455"),p=n("66888"),w=n("73691"),S=n("36297"),x=n("74956"),C=n("52671"),I=n("72192"),y=function(t){var e,n=t.appLoading,s=t.saveSpaceForFloatBtn,y=t.alignToBigHeaderBtn,k=t.bgUseNewStyle,L=t.itemsHasGap,T=(0,d.useIsNarrowScreen)(),j=(0,r.useRef)(new Set),N=(0,r.useRef)(null),B=(0,i._)((0,r.useState)(!1),2),E=B[0],R=B[1],F=(0,i._)((0,r.useState)(!1),2),O=F[0],A=F[1],P=(0,h.useThreadFeedInitiated)(),M=(0,h.useMainConversationLink)(),D=!P||!M,U=(0,v.useCustomScrollbar)(),V=U.className,G=U.onScroll;(0,r.useEffect)(function(){var t,e;return t=f.useGlobalStore.subscribe(function(t){return t.isOffline},function(t){!t&&(0,_.refreshConversationList)()}),e=function(){"visible"===document.visibilityState&&(0,_.refreshConversationList)()},window.addEventListener("visibilitychange",e),function(){t(),window.removeEventListener("visibilitychange",e)}},[]);var H=function(t,e){if(e)return!!j.current.has(e)||(j.current.add(e),!1);return!!(!t||j.current.has(t))||(j.current.add(t),!1)},W=(0,r.useMemo)(function(){return{bgUseNewStyle:k,itemsHasGap:L}},[k,L]);return n||D?(0,a.jsx)("div",{className:c()(I["chat-scroll-view"],(0,o._)({},I["chat-scroll-view-webkit"],(0,u.getIsIPhoneOrIPad)()),V),style:{padding:0},onScroll:G,children:(0,a.jsx)(C.SidebarSkeleton,{style:{border:"none"}})}):(0,a.jsx)(b.ChatListThemeContext.Provider,{value:W,children:(0,a.jsxs)("div",{"data-testid":"chat_list_wrapper",className:c()(I["chat-scroll-content"],I.container,(0,o._)({},I["chat-scroll-content-small-px"],y)),children:[(0,a.jsx)("div",{className:c()(I.mainCoco,"shrink flex flex-col mb-2"),"data-testid":"main_bot_chat_item",children:(0,a.jsx)(g.Section,{children:M&&(0,a.jsx)(S.ChatItemForConversation,{"data-testid":"chat_list_main_bot_item",conversationLink:M,hasBotShow:function(t){return H(t)},onClick:function(){l.landingConfig.markFirstEnterPage()},enableOverflowTooltip:!T},M.conversationId)})}),(0,a.jsx)("div",{ref:N,className:"px-14 shrink min-h-0 flex flex-col",children:(0,a.jsxs)(w.ChatListScrollView,{appLoading:n,children:[(0,a.jsx)(p.default,{hasBotShow:H,stickyRef:N}),(0,a.jsx)(x.ChatListBotList,{stickyRef:N,onAllInvView:function(t){R(t)},onCollapse:function(t){A(t)}}),s&&(0,a.jsx)("div",{className:"h-68"})]})}),(0,a.jsx)("div",{className:c()(I.aiBot,(e={},(0,o._)(e,I["sticky-shadow"],O&&!E),(0,o._)(e,"mt-10",O),e)),children:(0,a.jsx)(m.default,{})})]})})}},73691:function(t,e,n){"use strict";n.d(e,{ChatListScrollView:function(){return b}});var o=n("92769"),i=n("83316"),a=n("88802"),r=n("97458"),s=n("52983"),c=n("87608"),l=n.n(c),u=n("87382"),d=n("65042"),h=n("62920"),v=n("10173"),f=n("68628"),_=n("97530"),m=n("97225"),b=function(t){var e=t.appLoading,n=t.children,c=(0,f.useCustomScrollbar)(),b=c.className,g=c.onScroll,p=(0,s.useCallback)((0,o._)(function(){var t,n,o,i,r,s,c,l;return(0,a.__generator)(this,function(a){switch(a.label){case 0:if(n=(t=h.useChatStore.getState()).conversationListStatus,o=t.loadBotConversationList,i=n.loading,r=n.hasMore,s=n.count,!r||e||i)return[2];c=(0,u.createReportEvent)({eventName:"load_more_bot_conversation_list"}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,o({size:v.chatConversationPageLoadCount,index:s})];case 2:return a.sent(),c.success(),[3,4];case 3:throw l=a.sent(),c.error({reason:"load_more_bot_conversation_list_failed",error:l instanceof Error?l:Error(String(l))}),l;case 4:return[2]}})}),[e]);return(0,r.jsx)(_.ScrollView,{reachBottomThreshold:100,onReachBottom:p,onScroll:function(){g()},className:l()(m["chat-scroll-view"],(0,i._)({},m["chat-scroll-view-webkit"],(0,d.getIsIPhoneOrIPad)()),b),children:(0,r.jsx)("div",{className:l()(m["chat-scroll-content"],m["chat-scroll-content-webkit"]),children:n})})}},18668:function(t,e,n){"use strict";n.d(e,{AutoSticky:function(){return v}});var o=n("9161"),i=n("16044"),a=n("89334"),r=n("40509"),s=n("97458"),c=n("52983"),l=n("2945"),u=n("37903"),d=n("20970"),h=n("84322"),v=function(t){var e=t.children,n=t.autoInit,v=void 0!==n&&n,f=t.root,_=t.top,m=void 0===_?0:_,b=t.threshold,g=t.stickyStyle,p=t.onIntersect,w=void 0===p?l.default:p,S=t.getRoot,x=void 0===S?function(){return null}:S,C=t.onStickyChange,I=(0,a._)(t,["children","autoInit","root","top","threshold","stickyStyle","onIntersect","getRoot","onStickyChange"]),y=(0,c.useRef)(null),k=(0,c.useRef)(null),L=(0,r._)((0,c.useState)(!1),2),T=L[0],j=L[1],N=(0,d.useAutoSticky)({root:f,rootMargin:"-".concat(m,"px 0px 0px 0px"),threshold:void 0===b?0:b,onIntersect:w,autoInit:v}),B=N.entry,E=N.observer,R=N.initObserver,F=function(){if(B){var t,e,n=B.intersectionRatio,o=B.rootBounds,i=B.boundingClientRect,a=T;o&&1>Number(n)&&i.top-m<o.top?(null===(t=k.current)||void 0===t||t.classList.add(h.sticky),k.current.style.top="".concat(null==o?void 0:o.top,"px"),k.current.style.width="".concat(null==i?void 0:i.width,"px"),y.current.style.height="".concat(null==i?void 0:i.height,"px"),a=!0):(y.current.style.height="inherit",null===(e=k.current)||void 0===e||e.classList.remove(h.sticky),a=!1),j(a),null==C||C(a)}},O=function(t){if(y.current){var e=E;"init"===t?(!v&&!e&&(e=R({root:(0,u.default)(f)?(null==x?void 0:x())||null:f})),null==e||e.observe(y.current)):null==e||e.unobserve(y.current)}};return(0,c.useEffect)(function(){B&&F()},[B]),(0,c.useEffect)(function(){return O("init"),function(){O("destroy")}},[]),(0,s.jsx)("div",(0,i._)((0,o._)({ref:y},I),{style:{height:"auto"},children:(0,s.jsx)("div",{ref:k,className:h["sticky-el"],style:T?void 0===g?{}:g:{},children:e})}))}},41319:function(t,e,n){"use strict";n.d(e,{AutoSticky:function(){return o.AutoSticky}}),n("20970");var o=n("18668")},20970:function(t,e,n){"use strict";n.d(e,{useAutoSticky:function(){return a}});var o=n("40509"),i=n("52983"),a=function(t){var e=t.root,n=t.rootMargin,a=void 0===n?"0px":n,r=t.threshold,s=void 0===r?0:r,c=t.autoInit,l=void 0!==c&&c,u=t.onIntersect,d=void 0===e?null:e,h=(0,o._)((0,i.useState)(null),2),v=h[0],f=h[1],_=(0,o._)((0,i.useState)(null),2),m=_[0],b=_[1],g=(0,o._)((0,i.useState)(!1),2),p=g[0],w=g[1],S=(0,o._)((0,i.useState)(1),2),x=S[0],C=S[1],I=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.root;if(v||!IntersectionObserver)return v;var n=new IntersectionObserver(function(t){var e=t[0];b(e),w(e.isIntersecting),C(e.intersectionRatio),e.isIntersecting&&(null==u||u(e))},{root:void 0===e?d:e,rootMargin:a,threshold:s});return f(n),n};return(0,i.useEffect)(function(){l&&I()},[]),{observer:v,entry:m,isIntersecting:p,intersectionRatio:x,initObserver:I}}},66888:function(t,e,n){"use strict";var o=n("83316"),i=n("97458"),a=n("8371"),r=n("25906"),s=n("52983"),c=n("87608"),l=n.n(c),u=n("9317"),d=n("43850"),h=n("88128"),v=n("46750"),f=n("10630"),_=n("96317"),m=n("48160"),b=n("72676"),g=n("58416"),p=n("95455"),w=n("36297"),S=n("58781"),x=n("18271"),C=n("1865");e.default=function(t){var e=t.hasBotShow,n=(0,b.useTranslateFn)(),c=(0,h.useIsNarrowScreen)(),I=(0,f.useThreadList)(),y=I.threadLinks,k=I.threadFeedStatus,L=I.threadListStatus,T=(0,S.useLoadThreadListNextPage)().loadThreadListNextPage,j=(0,s.useRef)({}),N=function(t){if(t)return!j.current[t]&&(j.current[t]=(0,s.createRef)()),j.current[t]},B=(0,d.useIsNewThreadFromURL)(),E=5-(B?1:0),R=(0,s.useMemo)(function(){var t={conversationId:u.landingConfig.currentConversationId,threadId:(0,v.getLocalThreadId)(u.landingConfig.currentConversationId,"ClickButton"),isLocalConversation:!0};return B?[t].concat(null==y?void 0:y.slice(0,E)):null==y?void 0:y.slice(0,E)},[y,B,E]),F=(0,x.useFlowSlotsContext)().changeSideBarVisible;return(0,s.useEffect)(function(){!L.loading&&(!L.initiated||L.hasMore&&y.length<=5)&&T()},[L.loading,L.initiated,L.hasMore,y.length]),(0,i.jsx)(p.Section,{children:R.length?(0,i.jsxs)("div",{className:"pl-10 pb-10 text-14",children:[(0,i.jsxs)("div",{className:"relative pl-22 overflow-hidden",style:{height:"".concat(((null==R?void 0:R.length)||0)*(c?40:36)+((null==R?void 0:R.length)?2*(R.length-1):0),"px")},children:[(0,i.jsx)("div",{className:"absolute top-8 bottom-8 left-10 w-1 bg-black/20"}),(0,i.jsx)(a.default,{className:l()(C["thread-item-transition"],"flex flex-col gap-2"),children:R.map(function(t,n){return(0,i.jsx)(r.default,{nodeRef:N(t.conversationId),timeout:300,classNames:"thread-item-transition",appear:!n,exit:!n,children:(0,i.jsx)("div",{ref:N(t.conversationId),children:(0,i.jsx)(w.ChatItemForConversation,{"data-testid":"chat_list_thread_item","data-local-item":(0,v.isLocalThreadId)(t.threadId)?"chat_list_local_thread_item":void 0,hasMenu:!(0,v.isLocalThreadId)(t.threadId)&&void 0,conversationLink:t,hasBotShow:e,enableOverflowTooltip:!c})})},t.originConversationKey||t.conversationId)})})]}),(k.hasMore||y.length>E)&&(0,i.jsxs)("div",{className:"flex items-center mt-2",onClick:F,children:[(0,i.jsx)(_.ChatListDotsIcon,{}),(0,i.jsx)(m.NavLink,{"data-testid":"view_all_chats_button",to:g.CHAT_ALL_THREADS,className:function(t){var e=t.isActive;return l()("grow text-[var(--s-color-text-secondary)]",p.Style["section-item"],(0,o._)({},p.Style.active,e))},children:n("allChats_button")})]})]}):null})}},76460:function(t,e,n){"use strict";var o=n("97458"),i=n("96317"),a=n("62966"),r=n("72676"),s=n("18271"),c=n("58416"),l=n("29441");e.default=function(){var t=(0,r.useTranslateFn)(),e=(0,l.useGoToDiscover)(),n=(0,s.useFlowSlotsContext)().changeSideBarVisible,u=(0,a.useIsLaunchLoading)();return(0,o.jsx)(o.Fragment,{children:u?null:(0,o.jsx)(l.DiscoverAIBot,{icon:(0,o.jsx)(i.CommonBtnIcon,{}),activeIcon:(0,o.jsx)(i.CommonBtnActiveIcon,{}),text:t("chat_list_discover"),url:c.BOT_DISCOVER_ROUTE,onClick:function(){var t;t=e,n()}})})}},98624:function(t,e,n){"use strict";n.d(e,{PageLoading:function(){return s}});var o=n("97458"),i=n("32156"),a=n("53268"),r=n("82092"),s=function(){return(0,o.jsx)(i.SamanthaLayout.MaxWidthLayout,{children:(0,o.jsx)(a.Spin,{wrapperClassName:r["content-loading"]})})}},69873:function(t,e,n){"use strict";n.d(e,{useGoToSettings:function(){return l}});var o=n("99136"),i=n("65042"),a=n("32208"),r=n("45457"),s=n("58416"),c=n("90780"),l=function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=(0,a.useNavigate)(),n=(0,o.useMobile)().setMobileSidebarVisible,l=function(){if(location.pathname.startsWith(s.SETTINGS_PAGE)){n(!1);return}var t=(0,c.getChatIdFromURL)(),o=(0,c.getChatTypeFromURL)();n(!1),e("".concat(s.SETTINGS_PAGE).concat(t?"?id=".concat(t,"&type=").concat(o):""))},u=function(){var n=(0,c.getChatIdFromURL)(),o=(0,c.getChatTypeFromURL)();if(t&&location.pathname.startsWith("/chat/settings")){e(n?"/chat/".concat(n,"?type=").concat(o):"/chat");return}e("/chat/settings".concat(n?"?id=".concat(n,"&type=").concat(o):""))};return function(){(0,r.getIsNarrowScreen)()||(0,i.getIsMobile)()?l():u()}}},91068:function(t,e,n){"use strict";n.d(e,{ListBottomV2:function(){return x}});var o=n("97458"),i=n("87608"),a=n.n(i),r=n("99136"),s=n("78597"),c=n("96317"),l=n("32208"),u=n("48160"),d=n("53268"),h=n("94686"),v=n("21764"),f=n("66205"),_=n("9932"),m=n("58416"),b=n("95455"),g=n("16629"),p=n("69873"),w=n("18271"),S=n("73299"),x=function(){var t,e=(0,r.useMobile)().setMobileSidebarVisible,n=(0,p.useGoToSettings)(!1),i=(0,h.useUserProfile)(),x=(null==i?void 0:i.entity_id)?"".concat(m.PROFILE_PAGE_ROUTE,"/").concat(i.entity_id):m.USER_PROFILE_ROUTE,C=(null==i?void 0:i.entity_id)?"".concat(_.BROWSER_SETTING_URL_PROTOCOL,"/profile/").concat(i.entity_id):"".concat(_.BROWSER_SETTING_URL_PROTOCOL,"/settings/profile"),I=String((0,l.useLocation)().pathname),y=I.startsWith(x),k=!y&&I.startsWith(m.SETTINGS_PAGE),L=(0,s.isSamanthaClient)(),T=(null==i?void 0:i.nickname)||"",j="rounded-[10px] cursor-pointer ",N=(0,w.useFlowSlotsContext)().changeSideBarVisible;return(0,o.jsxs)("div",{className:a()("gap-2 py-4",S.siderFooter),onClick:N,children:[(0,o.jsx)(b.Section,{className:"flex-1 min-w-0",children:(0,o.jsxs)(u.NavLink,{to:L?C:x,state:{enter_from:"click_navigation"},onClick:function(){return e(!1)},className:a()("flex-1 flex items-center px-12 py-6 w-[122px] h-36",j,S.userProfile,b.Style["section-item"],y&&b.Style.active),children:[(0,o.jsx)(d.Avatar,{className:"flex-none w-24 h-24 rounded-12",src:(null==i?void 0:null===(t=i.image)||void 0===t?void 0:t.tiny_url)||g}),(0,o.jsx)(b.Section.ItemTitle,{title:T,className:a()("flex-1 ml-8 text-14 overflow-hidden text-ellipsis whitespace-nowrap",S.userName),children:T})]})}),L?(0,o.jsx)(v.default,{wrapClassNames:j}):(0,o.jsx)(f.default,{wrapClassNames:j}),(0,o.jsx)(b.Section,{children:(0,o.jsx)(u.NavLink,{to:L?_.BROWSER_SETTING_URL_PROTOCOL:m.SETTINGS_PAGE,onClick:function(t){!L&&(n(),t.preventDefault())},className:a()("p-3 w-36 h-36",j,S.setting,b.Style["section-item"],k&&b.Style.active),children:(0,o.jsx)(c.SettingsIcon,{})})})]})}},20089:function(t,e,n){"use strict";n.d(e,{ChatListBanner:function(){return g}});var o=n("40509"),i=n("97458"),a=n("14670"),r=n("52983"),s=n("33434"),c=n("87608"),l=n.n(c),u=n("45368"),d=n("62920"),h=n("96317"),v=n("53268"),f=n("62966"),_=n("72676"),m=n("26686"),b=n("64826"),g=function(){var t=p(),e=(0,r.useRef)(),n=(0,r.useMemo)(function(){return t.showBanner&&(e.current=t),e.current},[t]),o=(null==n?void 0:n.isLoading)?(0,i.jsx)(v.Spin,{indicator:(0,i.jsx)(h.ChatListBannerLoadingIcon,{}),wrapperClassName:b["loading-icon"]}):(0,i.jsx)(h.ChatListBannerIcon,{});return(0,i.jsx)(a.default,{in:t.showBanner,timeout:300,unmountOnExit:!0,mountOnEnter:!0,children:function(t){return(0,i.jsxs)("div",{className:l()(b["chat-list-banner"],b["chat-list-banner-".concat(t)]),children:[o&&(0,i.jsx)("div",{className:b.icon,children:o}),(0,i.jsx)("div",{className:b.description,children:null==n?void 0:n.content})]})}})},p=function(){var t=(0,_.useTranslateFn)(),e=(0,m.useSocketStatusTextWithDelay)(2e3),n=e.getText,a=e.loading,r=n(),c=(0,f.useGlobalStore)(function(t){return t.isHideNetworkStatus}),l=(0,o._)((0,d.useChatStore)(function(t){var e=t.threadFeedStatus,n=t.conversationListStatus;return[e.loading&&e.isReload||n.loading&&n.isReload,e.failed||n.failed]},s.shallow),2),h=l[0],v=l[1];if(!c&&r)return{showBanner:!0,isLoading:a,content:r};var g=null;return(h?g=t("web_list_load_retry"):v&&(g=(0,i.jsx)("span",{className:b["chat-list-banner-refresh-button"],children:(0,i.jsx)("button",{className:b["primary-button-text"],onClick:function(){return(0,u.initChatAppDataWithId)({isReload:!0})},children:t("chat_list_load_failed")})})),g)?{showBanner:!0,isLoading:h,content:g}:{showBanner:!1}}},42535:function(t,e,n){"use strict";n.d(e,{SidebarHeader:function(){return v}});var o=n("40509"),i=n("97458"),a=n("52983"),r=n("43850"),s=n("78597"),c=n("94686"),l=n("29441"),u=n("18271"),d=n("70164"),h=function(){var t=(0,l.useCreateNewChat)("bot_list_plus"),e=(0,u.useFlowSlotsContext)().changeSideBarVisible,n=(0,r.useIsNewThreadFromURL)(),o=function(){!n&&(t(),e())};return(0,s.useEventListener)("keydown",function(t){"k"===t.key&&t.metaKey&&o()}),(0,i.jsx)(l.HeaderBigBtnsUI,{disabled:n,onClickNewChat:o})},v=function(t){var e=t.loading,n=(0,o._)((0,a.useState)(!0),2),r=n[0],s=n[1],l=(0,c.useUserInfo)();return(0,a.useEffect)(function(){window.Tea.getVar("show_create_bot_btn",!0,function(t){s(t)})},[l]),void 0===e||e?null:(0,i.jsx)("div",{className:d["sidebar__header-container"],children:r?(0,i.jsx)(h,{}):null})}},62030:function(t,e,n){"use strict";n.d(e,{SideBar:function(){return p}});var o=n("97458"),i=n("52983"),a=n("99136"),r=n("40789"),s=n("89066"),c=n("53268"),l=n("45457"),u=n("62966"),d=n("59240"),h=n("30028"),v=n("42535"),f=n("20089"),_=n("91068"),m=n("52282"),b=n("70164"),g=n("77183"),p=function(t){var e=t.visible,n=t.onClose,p=(0,l.useIsNarrowScreen)(),w=(0,u.useIsLaunchLoading)(),S=(0,i.useRef)(null),x=(0,a.useMobile)().mobileSidebarVisible,C=r.VisitPage.CHAT_LIST;(0,i.useLayoutEffect)(function(){(0,s.markCurPage)(C,{isTemporary:!0})},[]),(0,i.useEffect)(function(){(0,d.trackEvent)("enter_page",{page:"bot_list",is_tts:0,is_from_ug:"0"})},[]);var I=(0,s.useMarkCurPageOnClick)(C,{isTemporary:!0}),y=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(v.SidebarHeader,{loading:w}),(0,o.jsx)("div",{className:"flex-1 relative min-h-0",ref:S,children:(0,o.jsx)(m.ChatList,{appLoading:w,saveSpaceForFloatBtn:!1,alignToBigHeaderBtn:!0,bgUseNewStyle:!0,itemsHasGap:!0})}),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(f.ChatListBanner,{}),!w&&(0,o.jsx)(_.ListBottomV2,{})]})]});return((0,h.useShouldShowCookieBanner)(S),(0,g.useShowDownLoadBanner)(S),p)?(0,o.jsx)(c.SideSheet,{visible:e,onCancel:n,closable:!1,placement:"left",headerStyle:{padding:0},bodyStyle:{padding:0,display:"flex",flexDirection:"column"},width:"320px",children:y}):(0,o.jsx)("aside",{ref:I,className:b.sidebar,"sidebar-visible":String(x),children:y})}},18739:function(t,e,n){"use strict";n.d(e,{withChatInit:function(){return r}});var o=n("97458");n("52983");var i=n("33470"),a=function(t){var e=t.children;return(0,i.initChatKit)(),(0,o.jsx)(o.Fragment,{children:e})},r=function(t){return function(){return(0,o.jsx)(a,{children:(0,o.jsx)(t,{})})}}},34827:function(t,e,n){"use strict";n.r(e);var o=n("92769"),i=n("83316"),a=n("40509"),r=n("88802"),s=n("97458"),c=n("52983"),l=n("87608"),u=n.n(l),d=n("87382"),h=n("54915"),v=n("99136"),f=n("65042"),_=n("78597"),m=n("32156"),b=n("59312"),g=n("62920"),p=n("11068"),w=n("26498"),S=n("61760"),x=n("32208"),C=n("1924"),I=n("45457"),y=n("96535"),k=n("62966"),L=n("24306"),T=n("40852"),j=n("3766"),N=n("90222"),B=n("58416"),E=n("2738"),R=n("27428"),F=n("26686"),O=n("18739"),A=n("18271"),P=n("62030"),M=n("98624"),D=n("9592"),U=n("65837"),V=n("50855"),G=n("58013"),H=n("3964"),W=n("32370"),K=function(){var t,e,n,l=(0,x.useLocation)(),v=(0,x.useNavigate)(),C=(0,c.useRef)({pageCreateTime:(null!==(n=null===(e=window)||void 0===e?void 0:e.performance)&&void 0!==n?n:Date).now(),initLocationKey:l.key}).current,I=C.pageCreateTime,y=C.initLocationKey,j=(0,d.useErrorBoundary)().showBoundary,O=(0,E.useIsChatPage)(),D=(0,k.useIsLaunchSuccess)(),V=(0,b.useSystemConfigInfo)().saveChatHistoryPopupEnable,G=(0,a._)((0,c.useState)(!1),2),K=G[0],z=G[1];(0,c.useEffect)(function(){V&&z(!0)},[V]),(0,U.useInterceptInstall)();var q=(t=(0,o._)(function(){var t,e,n,o,i,a,s,c=arguments;return(0,r.__generator)(this,function(r){switch(r.label){case 0:t=c.length>0&&void 0!==c[0]&&c[0],e=function(e){return d.logger.persist.log({message:e,meta:{time:Date.now(),authState:(0,T.getAuthState)(),autoRetry:t}})},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,(0,L.initUserChatApp)(!t,I)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),(0,p.isApiError)(n)&&n.errorOption.code===w.ErrorCodes.NEED_TO_WAIT.toString()&&v(B.WAITLIST_ROUTE),t?(o=(0,T.getAuthState)(),e("Init error and autoRetry"),o===T.AuthState.Finished&&(e("Init error and retry immediately"),q()),o===T.AuthState.InAuthLogin||o===T.AuthState.InCheckLogin||o===T.AuthState.InCheckSSOLogin?(e("Init error and wait to retry"),i=null,a=function(){i&&(clearTimeout(i),i=null),s()},s=(0,T.subscribeAuthState)(function(t){t===T.AuthState.Finished?(e("Init error and retry in subscribe"),q(),a()):t===T.AuthState.Failed&&a()}),i=setTimeout(function(){e("Init error and retry in timeout"),q(),a()},5e3)):o===T.AuthState.Failed?e("Init error and skip retry because of AuthState.Failed"):j(n)):(e("Init error and not autoRetry"),j(n)),[3,4];case 4:return[2]}})}),function(){return t.apply(this,arguments)}),J=function(){(0,N.destroyMusicPlayerManager)()};(0,c.useEffect)(function(){var t,e,n,o=(0,E.canInitChatAppConversationReport)(),a=null===(t=performance.getEntriesByType("navigation"))||void 0===t?void 0:t[0];return g.useChatStore.setState({tracingParams:{chatLayoutCreateTime:I,chatLayoutEnterPageKey:y,flowWebScriptJsFinish:window.docLoadPerformanceTs,canReport:o},chatPageShowTracingCommonParams:(n={},(0,i._)(n,"duration.redirect_start",null==a?void 0:a.redirectStart),(0,i._)(n,"duration.fetch_start",null==a?void 0:a.fetchStart),(0,i._)(n,"duration.response_end",null==a?void 0:a.responseEnd),(0,i._)(n,"duration.dom_interactive",null==a?void 0:a.domInteractive),(0,i._)(n,"duration.dom_content_load_event_start",null==a?void 0:a.domContentLoadedEventStart),(0,i._)(n,"duration.dom_content_load_event_end",null==a?void 0:a.domContentLoadedEventEnd),(0,i._)(n,"duration.load_event_start",null==a?void 0:a.loadEventStart),(0,i._)(n,"duration.chat_root_mount",performance.now()),(0,i._)(n,"duration.app_root_mount",null===(e=window)||void 0===e?void 0:e.app_root_mount),n)}),q(!0),function(){J()}},[]),(0,c.useEffect)(function(){if(D){var t=Date.now(),e=function(){Date.now()-t>36e5&&(t=Date.now(),(0,h.pullFeatureConfigFromUserConfigSingle)({reason:S.UserConfigPullReason.Polling}))};return(0,h.pullFeatureConfigFromUserConfigSingle)(),window.addEventListener("focus",e),function(){return window.removeEventListener("focus",e)}}},[D]),(0,F.useSocketBannerInitDelay)({delay:6e3}),(0,R.useInitPreloadChunk)();var Q=(0,a._)((0,c.useState)(!0),2),X=Q[0],Y=Q[1];(0,_.useTimeout)(function(){Y(!1)},1e4);var Z=(0,A.useFlowSlotsContext)(),$=Z.sidebarVisible,tt=Z.changeSideBarVisible;return(0,s.jsxs)("div",{className:u()(W.container,(0,i._)({},W.mask,!(0,f.isMobile)()&&!D&&X)),children:[(0,f.isMobile)()&&K&&(0,s.jsx)(H.BottomPopup,{}),(0,s.jsxs)(m.SamanthaLayout,{children:[(0,s.jsx)(m.SamanthaLayout.LeftSide,{children:(0,s.jsx)(P.SideBar,{visible:$,onClose:tt})}),D||O?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.SamanthaLayout.CenterScrollMode,{children:(0,s.jsx)(x.Outlet,{context:m.SamanthaLayout.CenterScrollMode})}),(0,s.jsx)(m.SamanthaLayout.CenterFullMode,{children:(0,s.jsx)(x.Outlet,{context:m.SamanthaLayout.CenterFullMode})}),(0,s.jsx)(m.SamanthaLayout.RightSide,{children:(0,s.jsx)(x.Outlet,{context:m.SamanthaLayout.RightSide})})]}):(0,s.jsx)(m.SamanthaLayout.CenterFullMode,{children:(0,s.jsx)(M.PageLoading,{})})]})]})},z=(0,C.getLoginSuccessBackUrl)()||B.CHAT_PAGE_ROUTE,q=y.featureEnableChat?(0,d.withErrorBoundary)((0,j.withRequireAuth)((0,O.withChatInit)(function(){var t=(0,b.useHydration)(),e=(0,a._)((0,c.useState)(!1),2),n=e[0],o=e[1],i=(0,I.useIsNarrowScreen)(),r=(0,c.useMemo)(function(){return{sidebarVisible:n,changeSideBarVisible:function(){i&&o(!n)}}},[n,o,i]),l=(0,a._)((0,c.useState)(!1),2),u=l[0];l[1],(0,c.useEffect)(function(){},[]);var d=(0,E.useIsChatPage)(),h=(0,E.useIsChatLandingPage)();return(t||h)&&!u?(0,s.jsx)(v.MobileProvider,{children:(0,s.jsx)(A.FlowSlotsProvider,{value:r,children:(0,s.jsx)(K,{})})}):(0,s.jsx)(D.ChatSkeletonFull,{showInput:d})}),{successNavigatePath:z}),{errorBoundaryName:"chat_page_error",FallbackComponent:V.ErrorFallback,onError:function(t){}}):G.EmptyComponent;e.default=q},3964:function(t,e,n){"use strict";n.d(e,{BottomPopup:function(){return v}});var o=n("40509"),i=n("97458"),a=n("52983"),r=n("87608"),s=n.n(r),c=n("32208"),l=n("53268"),u=n("72676"),d=n("58416"),h=n("50923"),v=function(){var t=(0,c.useNavigate)(),e=(0,u.useTranslateFn)(),n=(0,o._)((0,a.useState)(!0),2),r=n[0],v=n[1],f=(0,a.useRef)(null),_=(0,a.useRef)(null);(0,a.useEffect)(function(){return r&&(_.current=setTimeout(function(){v(!1)},15e3)),function(){m()}},[r]),(0,a.useEffect)(function(){var t=function(t){f.current&&!f.current.contains(t.target)&&b()};return document.addEventListener("mousedown",t),function(){document.removeEventListener("mousedown",t)}},[f]);var m=function(){_.current&&clearTimeout(_.current),_.current=null},b=function(){v(!1),m()};return(0,i.jsx)(i.Fragment,{children:r?(0,i.jsxs)("div",{ref:f,className:h.wrapper,children:[e("save_ch_toast"),(0,i.jsxs)("div",{className:h["btn-groups"],children:[(0,i.jsx)(l.Button,{size:"large",className:s()(h["btn-item"],h["btn-setting"]),onClick:function(){b(),t(d.ACCOUNT_SETTING_ROUTE)},children:e("go_setting")}),(0,i.jsx)(l.Button,{theme:"solid",size:"large",className:s()(h["btn-item"]),onClick:b,children:e("toast_confirm")})]})]}):null})}},77183:function(t,e,n){"use strict";n.d(e,{useShowDownLoadBanner:function(){return a}}),n("40509"),n("97458"),n("63730");var o=n("52983");n("78520"),n("87608"),n("74446"),n("19266"),n("96317"),n("53268");var i=n("45457");n("72676"),n("87868"),n("72037"),n("52925"),n("66205"),n("10010");var a=function(t){(0,i.useIsNarrowScreen)(),(0,o.useEffect)(function(){if(localStorage.getItem("flow_new_cici_download"))return},[])}},65837:function(t,e,n){"use strict";n.d(e,{useInterceptInstall:function(){return c}});var o=n("92769"),i=n("88802");n("97458");var a=n("52983"),r=n("87382");function s(t,e){r.logger.persist.info({eventName:t,meta:e})}n("53268"),n("70152"),n("85972"),n("59240"),n("72676"),n("58416"),n("33708"),n("91928"),n("93546");var c=function(t){var e=function(e){e.preventDefault(),window.deferredPrompt=e,null==t||t(e)};(0,a.useEffect)(function(){return window.addEventListener("beforeinstallprompt",e),function(){window.removeEventListener("beforeinstallprompt",e)}},[])};(0,o._)(function(t,e){var n;return(0,i.__generator)(this,function(o){switch(o.label){case 0:return s("pwa_system_prompt_show"),null==t||t.prompt(),[4,null==t?void 0:t.userChoice];case 1:return(null==(n=o.sent())?void 0:n.outcome)==="dismissed"?s("pwa_system_prompt_result",{accept:"0"}):(s("pwa_system_prompt_result",{accept:"1"}),null==e||e()),[2]}})})},70152:function(t,e,n){"use strict";n("65042")},97225:function(t){"use strict";t.exports={"chat-list-collapse":"chat-list-collapse-_5dffb",chatListCollapse:"chat-list-collapse-_5dffb","chat-scroll-content":"chat-scroll-content-_6730e",chatScrollContent:"chat-scroll-content-_6730e","chat-scroll-content-skeleton":"chat-scroll-content-skeleton-_7ded7",chatScrollContentSkeleton:"chat-scroll-content-skeleton-_7ded7","chat-scroll-content-webkit":"chat-scroll-content-webkit-ed9b49",chatScrollContentWebkit:"chat-scroll-content-webkit-ed9b49","chat-scroll-view":"chat-scroll-view-_1ce08",chatScrollView:"chat-scroll-view-_1ce08","chat-scroll-view-webkit":"chat-scroll-view-webkit-_663f3",chatScrollViewWebkit:"chat-scroll-view-webkit-_663f3","show-line":"show-line-_648fb",showLine:"show-line-_648fb","show-scrollbar-thumb":"show-scrollbar-thumb-c35a04",showScrollbarThumb:"show-scrollbar-thumb-c35a04"}},95986:function(t){"use strict";t.exports={"collapse-content":"collapse-content-_83ece",collapseContent:"collapse-content-_83ece",load:"load-d03cea",mainItem:"mainItem-_598e7","right-icon":"right-icon-_39b71",rightIcon:"right-icon-_39b71",title:"title-_97516"}},72192:function(t){"use strict";t.exports={aiBot:"aiBot-_2d400","chat-scroll-content":"chat-scroll-content-_74e83",chatScrollContent:"chat-scroll-content-_74e83","chat-scroll-content-skeleton":"chat-scroll-content-skeleton-_702a6",chatScrollContentSkeleton:"chat-scroll-content-skeleton-_702a6","chat-scroll-content-webkit":"chat-scroll-content-webkit-_8b48b",chatScrollContentWebkit:"chat-scroll-content-webkit-_8b48b","chat-scroll-view":"chat-scroll-view-bc70d5",chatScrollView:"chat-scroll-view-bc70d5","chat-scroll-view-webkit":"chat-scroll-view-webkit-_18713",chatScrollViewWebkit:"chat-scroll-view-webkit-_18713",collapse:"collapse-_45af4",container:"container-_2971a",mainCoco:"mainCoco-_2f130","retry-button-wrapper":"retry-button-wrapper-_7ce60",retryButtonWrapper:"retry-button-wrapper-_7ce60","show-line":"show-line-e2033e",showLine:"show-line-e2033e","sticky-shadow":"sticky-shadow-_80dd7",stickyShadow:"sticky-shadow-_80dd7",title:"title-_0c063"}},84322:function(t){"use strict";t.exports={sticky:"sticky-_87d39","sticky-el":"sticky-el-c19bbb",stickyEl:"sticky-el-c19bbb"}},1865:function(t){"use strict";t.exports={"thread-item-transition":"thread-item-transition-_2c58e",threadItemTransition:"thread-item-transition-_2c58e"}},82092:function(t){"use strict";t.exports={"content-loading":"content-loading-baad5f",contentLoading:"content-loading-baad5f"}},73299:function(t){"use strict";t.exports={setting:"setting-_3ee0a",siderFooter:"siderFooter-c52d70",userName:"userName-_55a64",userProfile:"userProfile-_50a7b"}},64826:function(t){"use strict";t.exports={"chat-list-banner":"chat-list-banner-_8c1ed",chatListBanner:"chat-list-banner-_8c1ed","chat-list-banner-entered":"chat-list-banner-entered-a2c2a6",chatListBannerEntered:"chat-list-banner-entered-a2c2a6","chat-list-banner-entering":"chat-list-banner-entering-_9915f",chatListBannerEntering:"chat-list-banner-entering-_9915f","chat-list-banner-exited":"chat-list-banner-exited-_65f3f",chatListBannerExited:"chat-list-banner-exited-_65f3f","chat-list-banner-exiting":"chat-list-banner-exiting-_6de7d",chatListBannerExiting:"chat-list-banner-exiting-_6de7d","chat-list-banner-refresh-button":"chat-list-banner-refresh-button-a68f5c",chatListBannerRefreshButton:"chat-list-banner-refresh-button-a68f5c",description:"description-_4f2c1",icon:"icon-c9ed03","loading-icon":"loading-icon-_18e88",loadingIcon:"loading-icon-_18e88","primary-button-text":"primary-button-text-c05430",primaryButtonText:"primary-button-text-c05430","secondary-button-text":"secondary-button-text-_02b57",secondaryButtonText:"secondary-button-text-_02b57"}},70164:function(t){"use strict";t.exports={banner:"banner-_0a2b9","chat-header":"chat-header-_6088d",chatHeader:"chat-header-_6088d",contentWrapper:"content_wrapper-_1f4f6",content_wrapper:"content_wrapper-_1f4f6","conversation-header":"conversation-header-_5cd04",conversationHeader:"conversation-header-_5cd04",sidebar:"sidebar-a5bf30",sidebarHeader:"sidebar__header-_4de3c",sidebar__header:"sidebar__header-_4de3c",sidebarHeaderContainer:"sidebar__header-container-_64123","sidebar__header-container":"sidebar__header-container-_64123",sidebarHeaderSkeleton:"sidebar__header-skeleton-dfb389","sidebar__header-skeleton":"sidebar__header-skeleton-dfb389"}},32370:function(t){"use strict";t.exports={container:"container-_6297d",grey:"grey-_04a3f",mask:"mask-_3833b"}},50923:function(t){"use strict";t.exports={"btn-groups":"btn-groups-_67882",btnGroups:"btn-groups-_67882","btn-item":"btn-item-_8eab0",btnItem:"btn-item-_8eab0","btn-setting":"btn-setting-cb7f1f",btnSetting:"btn-setting-cb7f1f",wrapper:"wrapper-_5fea2"}},93546:function(t){"use strict";t.exports={button:"button-_1157a",container:"container-_4f394",extension:"extension-bba8f9",extensionDownload:"extensionDownload-dee2aa",icon:"icon-_81f5a",quick:"quick-c790c6"}}}]);