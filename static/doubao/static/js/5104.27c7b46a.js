/*! For license information please see 5104.27c7b46a.js.LICENSE.txt */
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["5104"],{63468:function(e,t,r){"use strict";r.d(t,{getCsrfToken:function(){return f}});var n,i=r("92769"),o=r("88802"),u=r("72662"),a=r("87382"),s=r("18545"),c=r("80812");var f=(n=(0,i._)(function(e){var t,r,n;return(0,o.__generator)(this,function(i){switch(i.label){case 0:t="".concat(e||location.origin,"/passport/safe/csrf_token/"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,(0,u.default)(t,{method:"GET",headers:(0,c.getCommonHeaders)(),params:(0,c.getCommonParams)()})];case 2:if(r=i.sent().data,(0,s.isAccountErrorResponse)(r))throw s.PassportApiError.from(r);return a.logger.persist.success({eventName:"safe_csrf_token_success"}),[2,r.data.passport_csrf_token];case 3:return n=i.sent(),a.logger.persist.error({eventName:"safe_csrf_token_error",error:n instanceof Error?n:Error(String(n))}),[2];case 4:return[2]}})}),function(e){return n.apply(this,arguments)})},37884:function(e,t,r){"use strict";r.r(t),r.d(t,{FlowAccount:function(){return n.FlowAccount},getFp:function(){return n.getFp},getSSOEmail:function(){return o.getSSOEmail},getSSOEmailUsername:function(){return o.getSSOEmailUsername},setSSOEmail:function(){return o.setSSOEmail},thirdPlatformConfig:function(){return n.thirdPlatformConfig},useFetchThirdLoginKeys:function(){return i.useFetchThirdLoginKeys},useTrackMetaFromState:function(){return i.useTrackMetaFromState}});var n=r("54078"),i=r("16110"),o=r("37059")},54078:function(e,t,r){"use strict";r.d(t,{FlowAccount:function(){return k},getFp:function(){return U},thirdPlatformConfig:function(){return O}});var n,i=r("92769"),o=r("69420"),u=r("93426"),a=r("9161"),s=r("6462"),c=r("29048"),f=r("88802"),l=r("87382"),d=r("33220"),g=r("78597"),_=r("49022"),h=r("49503"),p=r("1924"),v=r("6314"),m=r("26330"),S=r("53991"),b=r("94686"),C=r("20945"),A=r("72676"),w=r("58416");r("63468");var P=r("59240"),L=r("76185");function I(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(void 0===t?"undefined":(0,c._)(t))?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y=location.host,U=function(){var e=(0,P.checkAndGetTeaToken)().web_id||String(window.Tea.getConfig("user_unique_id"));return"verify_".concat(e)};var E=(n=(0,i._)(function(){var e;return(0,f.__generator)(this,function(e){switch(e.label){case 0:return[3,2];case 1:e.sent(),e.label=2;case 2:return[2,(0,a._)({isOversea:!1,aid:(0,w.getAid)(),appKey:"2094abfcccefaeaffd24c622475fba10",isBoe:!1,region:"cn"},{})]}})}),function(){return n.apply(this,arguments)}),F="".concat("https://".concat(y),"/auth/callback"),O={google:void 0,apple:{clientId:"com.botweb.doubao",platformId:9155,callbackUrl:F},aweme_v2:{clientId:"aw4293rjg7ggbx9m",platformId:8949,callbackUrl:F},sso:void 0,line:{clientId:"2002351850",platformId:2200,callbackUrl:F,extraParams:{redirect_uri:F}},facebook:{clientId:"1819912395072617",platformId:2204,callbackUrl:F,redirectUrl:void 0}},T=function e(){var t;(0,o._)(this,e),I(this,"getLanguage",function(){return h.I18n.language}),I(this,"getTranslate",function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return(t=h.I18n).t.apply(t,[e].concat((0,s._)(n)))}),I(this,"useTranslateFn",A.useTranslateFn)},N=function e(){(0,o._)(this,e),I(this,"trackEvent",function(e,t,r){(0,P.trackEvent)(e,t,r)})},k=function(){function e(){(0,o._)(this,e)}return e.getInitReturnValue=function(){var e=this;return(0,i._)(function(){var t;return(0,f.__generator)(this,function(n){switch(n.label){case 0:if(e._module)return[3,2];return[4,(0,g.retryLoad)(function(){return Promise.all([r.e("9891"),r.e("3799"),r.e("4559"),r.e("3624"),r.e("2967"),r.e("4853"),r.e("2933")]).then(r.bind(r,"56799"))})];case 1:e._module=n.sent(),n.label=2;case 2:return!e._initReturnValue&&(t=e._module.initFlowAccount,e._initReturnValue=t({safetyApi:L.apiService.safety,passportConfig:E,i18n:e.flowI18n,tea:e.flowTea,logger:l.logger,thirdPlatformConfig:O,logoutPathPostProcess:function(e){return(0,p.addLoginSuccessBackUrl)((0,p.addHideHomepageUrl)(e))},storageRegion:v.getCountry,settingApi:L.apiService.setting})),[2,e._initReturnValue]}})})()},(0,u._)(e,null,[{key:"flowI18n",get:function(){return!this._flowI18n&&(this._flowI18n=new T),this._flowI18n}},{key:"flowTea",get:function(){return!this._flowTea&&(this._flowTea=new N),this._flowTea}},{key:"passportApi",get:function(){return!this._passportApi&&(this._passportApi=(0,g.bindPromiseProperty)(this.getInitReturnValue().then(function(e){return e.passportApi})),this._passportApi.on("afterLogout",function(){(0,S.notifyLoginStatusChange)(!1),(0,P.resetTeaToken)().then(P.updateTeaGuestUid),(0,C.resetGuestChatInited)(),(0,_.dropAdaptors)(),(0,b.resetUserProfile)(),(0,d.setNotLogined)(),(0,m.resetLaunchPromise)()})),this._passportApi}},{key:"flowAccount",get:function(){if(!this._flowAccount){var e=(0,g.bindPromiseProperty)(this.getInitReturnValue().then(function(e){return e.flowAccount}));this._flowAccount={ageGate:(0,g.bindPromiseProperty)(e.ageGate),third:(0,g.bindPromiseProperty)(e.third)}}return this._flowAccount}},{key:"FlowAccountComponents",get:function(){return!this._FlowAccountComponents&&(this._FlowAccountComponents=(0,g.bindPromiseProperty)(this.getInitReturnValue().then(function(e){return e.FlowAccountComponents}),!0)),this._FlowAccountComponents}}]),e}();I(k,"_module",void 0),I(k,"_flowI18n",void 0),I(k,"_flowTea",void 0),I(k,"_initReturnValue",void 0),I(k,"_passportApi",void 0),I(k,"_flowAccount",void 0),I(k,"_FlowAccountComponents",void 0)},37059:function(e,t,r){"use strict";r.d(t,{getSSOEmail:function(){return u},getSSOEmailUsername:function(){return a},setSSOEmail:function(){return o}});var n=r("17072"),i="FLOW_CURRENT_USER_EMAIL",o=function(e){e&&n.SyncStorageWithCache.setItem(i,e)},u=function(){var e=n.SyncStorageWithCache.getItem(i);return e&&"undefined"!==e?e:null},a=function(){var e=u();return e&&e.split("@").shift()||""}},16110:function(e,t,r){"use strict";r.d(t,{useFetchThirdLoginKeys:function(){return u},useTrackMetaFromState:function(){return o}}),r("92769"),r("88802"),r("52983"),r("26107"),r("87382");var n=r("32208"),i=r("40852"),o=function(){var e,t=null===(e=(0,n.useLocation)().state)||void 0===e?void 0:e.trackMeta;if("object"==typeof t)return t},u=function(){(0,i.updateThirdLoginListLoaded)(!0)}},4012:function(e,t,r){"use strict";r.d(t,{checkSamanthaHitStatus:function(){return f},runSamanthaAbLogicAndIfReturn:function(){return h}});var n=r("92769"),i=r("88802"),o=r("87382"),u=r("65042"),a=r("85397"),s=r("13625"),c=r("76185");function f(){return l.apply(this,arguments)}function l(){return(l=(0,n._)(function(){var e;return(0,i.__generator)(this,function(t){switch(t.label){case 0:return[4,c.apiService.samantha.GetSamanthaWebHitStatus()];case 1:return[2,{result:e=t.sent(),isHitSamantha:e.status===a.SamanthaWebHitStatus.Hit}]}})})).apply(this,arguments)}function d(){return(d=(0,n._)(function(e){return(0,i.__generator)(this,function(t){return[2,new Promise(function(t){var r,n=window.Tea;null===(r=n.getABconfig)||void 0===r||r.call(n,{new_register_user:"1",user_id:e},function(e){var r,n=(null==e?void 0:null===(r=e.is_samantha)||void 0===r?void 0:r.val)||!1;window.Tea.getVar("is_samantha",!1,function(e){}),t(n)})})]})})).apply(this,arguments)}function g(){return(g=(0,n._)(function(e,t){var r,n;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.addDurationPoint("fetch_libra_start"),[4,function(e){return d.apply(this,arguments)}(e)];case 1:return r=i.sent(),t.addDurationPoint("fetch_libra_end"),t.addDurationPoint("update_web_hit_start"),[4,c.apiService.samantha.UpdateSamanthaWebHitStatus({status:r?a.SamanthaWebHitStatus.Hit:a.SamanthaWebHitStatus.NotHit})];case 2:return i.sent(),t.addDurationPoint("update_web_hit_end"),[2,!!r];case 3:return n=i.sent(),t.error({error:n,reason:"[samantha_ab] new_user_logic"}),[3,4];case 4:return[2]}})})).apply(this,arguments)}function _(){return(_=(0,n._)(function(e){var t,r;return(0,i.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e.addDurationPoint("get_web_hit_start"),[4,f()];case 1:return t=n.sent().isHitSamantha,e.addDurationPoint("get_web_hit_end"),[2,!!t];case 2:return r=n.sent(),e.error({error:r,reason:"[samantha_ab] old_user_logic"}),[3,3];case 3:return[2]}})})).apply(this,arguments)}function h(e){return p.apply(this,arguments)}function p(){return(p=(0,n._)(function(e){var t,r,n;return(0,i.__generator)(this,function(i){switch(i.label){case 0:if((0,u.isSamanthaClient)())return[2,!0];if(t=e.new_user,r=(0,o.createReportEvent)({eventName:"samantha_ab_event",meta:{is_new_user:t}}),(0,s.default)("context.set","account_user_id",e.user_id_str),!t)return[3,2];return[4,function(e,t){return g.apply(this,arguments)}(e.user_id_str,r)];case 1:return n=i.sent(),[3,4];case 2:return[4,function(e){return _.apply(this,arguments)}(r)];case 3:n=i.sent(),i.label=4;case 4:return r.success({meta:{is_samantha:n?1:0}}),[2,n]}})})).apply(this,arguments)}},40852:function(e,t,r){"use strict";r.d(t,{AuthState:function(){return c},getAuthState:function(){return d},getThirdLoginKeyList:function(){return v},getThirdLoginListLoaded:function(){return m},subscribeAuthState:function(){return g},subscribeThirdLoginListLoaded:function(){return _},updateAuthState:function(){return h},updateThirdLoginList:function(){return S},updateThirdLoginListLoaded:function(){return b},useAuthState:function(){return l},useAuthStore:function(){return f},useThirdLoginKeyList:function(){return p}});var n,i=r("37222"),o=r("85205"),u=r("45002"),a=r("87382"),s=Object.keys((0,u.default)({aweme_v2:!0,apple:!0,google:!1},function(e){return!!e}));var c=((n={}).BeforeAll="before_all",n.InCheckSSOLogin="in_check_sso_login",n.InAuthLogin="in_auth_login",n.InCheckLogin="in_check_login",n.Finished="finished",n.Failed="failed",n),f=(0,o.create)()((0,i.subscribeWithSelector)(function(e,t){return{authState:c.BeforeAll,setAuthState:function(t){return e({authState:t})},thirdLoginList:s,setThirdLoginList:function(t){return e({thirdLoginList:t})},thirdLoginListLoaded:!1,setThirdLoginListLoaded:function(t){return e({thirdLoginListLoaded:t})}}})),l=function(){return f(function(e){return e.authState})},d=function(){return f.getState().authState},g=function(e){return f.subscribe(function(e){return e.authState},e)},_=function(e){return f.subscribe(function(e){return e.thirdLoginListLoaded},e)},h=function(e){f.getState().setAuthState(e)};g(function(e){a.logger.persist.info({eventName:"auth_state_change",meta:{authState:e}})});var p=function(){return f(function(e){return e.thirdLoginList})},v=function(){return f.getState().thirdLoginList},m=function(){return f.getState().thirdLoginListLoaded},S=function(e){f.getState().setThirdLoginList(e)},b=function(e){f.getState().setThirdLoginListLoaded(e)}},20945:function(e,t,r){"use strict";r.d(t,{resetGuestChatInited:function(){return l},useGuestConfigStore:function(){return f}});var n=r("9161"),i=r("16044"),o=r("6462"),u=r("37222"),a=r("85205"),s={guestChatInited:!1,discoverActive:!0,discoverActiveInit:!1,refDestroyAgeGateModal:r("2945").default,abTestParams:{support_unlogin_chat:!1,discover_in_landing:!1,has_landing_search:!1,preset_bot_use_recommend:!1,login_landing_to_search:!1,bot_support_search:!1,unlogin_search_suggest:!1},guestAbTestParams:{disableGuidance:!1}},c=function(e){return(0,i._)((0,n._)({},s),{setGuestChatInited:function(t){e({guestChatInited:t})},resetGuestChatInited:function(){e({guestChatInited:!1})},setDiscoverActive:function(t){e({discoverActive:t})},initAbTestParams:function(t){e({abTestParams:t})},initGuestAbTestParams:function(t){e({guestAbTestParams:t})},setRefDestroyAgeGateModal:function(t){e({refDestroyAgeGateModal:t})}})},f=(0,a.create)()((0,u.subscribeWithSelector)(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n._)({},c.apply(void 0,(0,o._)(t)))})),l=function(){return f.getState().resetGuestChatInited()}},94686:function(e,t,r){"use strict";r.d(t,{getUserId:function(){return n.getUserId},getUserInfo:function(){return n.getUserInfo},resetUserProfile:function(){return n.resetUserProfile},useUserInfo:function(){return n.useUserInfo},useUserInfoAction:function(){return n.useUserInfoAction},useUserProfile:function(){return n.useUserProfile},useUserStore:function(){return n.useUserStore}});var n=r("91861")},31374:function(e,t,r){"use strict";r.d(t,{persistOptions:function(){return o}});var n=r("9161"),i=r("7288"),o={name:"flow-web-user-store",storage:(0,i.createStorage)(),partialize:function(e){var t;return{userProfile:{nickname:null===(t=e.userProfile)||void 0===t?void 0:t.nickname}}},version:1.1,merge:function(e,t){try{return(0,n._)({},t,null!=e?e:{})}catch(e){i.persistLogger.persist.error({message:"persist merge error",error:e})}return t},onRehydrateStorage:function(e){return i.persistLogger.info({message:"hydration started",meta:{state:e}}),function(e,t){t?i.persistLogger.persist.error({message:"hydration error",error:t instanceof Error?t:Error(String(t))}):i.persistLogger.info({message:"hydration finished",meta:{state:e}})}}}},91861:function(e,t,r){"use strict";r.d(t,{getUserId:function(){return I},getUserInfo:function(){return P},resetUserProfile:function(){return U},useUserInfo:function(){return L},useUserInfoAction:function(){return w},useUserProfile:function(){return y},useUserStore:function(){return A}});var n,i=r("92769"),o=r("9161"),u=r("16044"),a=r("88802"),s=r("33434"),c=r("37222"),f=r("85205"),l=r("87382"),d=r("75995"),g=r("11068"),_=r("26498"),h=r("53268"),p=r("45431"),v=r("4012"),m=r("76185"),S=r("31374"),b={userInfo:null,userProfile:null,featureConfig:{},hitStatusHitSource:void 0},C=function(e,t){return(0,u._)((0,o._)({},b),{updateUserInfo:function(r){var n,i=null===(n=t().userInfo)||void 0===n?void 0:n.user_id_str,o=r.user_id_str;if(i&&o&&i!==o)try{d.useFeatureConfigStore.getState().resetFeatureConfig()}catch(e){l.logger.persist.error({message:"[createUserSlice] genUserDefaultProfile resetFeatureConfig failed",error:e})}e({userInfo:r}),t().getProfileInfo(null==r?void 0:r.user_id_str)},getProfileInfo:function(r){return(0,i._)(function(){var n,i,s;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,m.apiService.profile.ProfileInfo({visit_id:r})];case 1:if(n=a.sent().data)return e({userProfile:(0,u._)((0,o._)({},null==n?void 0:n.profile_brief),{botCount:Number(null==n?void 0:null===(i=n.profile_bot_info)||void 0===i?void 0:i.total)||0})}),[2,null==n?void 0:n.profile_brief];return[3,3];case 2:return s=a.sent(),(0,g.isApiError)(s)&&s.errorOption.code===_.ErrorCodes.USER_NOT_EXISTED.toString()&&(l.logger.persist.info({eventName:"gen_user_profile_for_user_stay_on_chat_page",meta:{user_id:r}}),t().updateUserProfile({entity_id:r,avatar_url:"",nickname:"",user_name:""})),[3,3];case 3:return[2]}})})()},updateUserProfile:function(e){return(0,i._)(function(){var r,n,i,o,u,s;return(0,a.__generator)(this,function(a){switch(a.label){case 0:r=(0,l.createReportEvent)({eventName:"update_user_profile",meta:{user_id:e.entity_id}}),a.label=1;case 1:return a.trys.push([1,6,,7]),r.addDurationPoint("start"),[4,m.apiService.profile.UpdateProfile(e)];case 2:if(i=(n=a.sent()).code,o=n.msg,u=n.data,!(0===i&&(null==u?void 0:u.entity_id)))return[3,4];return r.addDurationPoint("success"),r.success(),[4,t().getProfileInfo(null==u?void 0:u.entity_id)];case 3:return a.sent(),[2,0];case 4:return o&&h.Toast.error(o),[2,-1];case 5:return[3,7];case 6:return s=a.sent(),r.error({reason:"update_user_profile_failed",error:s}),e.nickname&&h.Toast.error(s.errorOption.message),[2,-1];case 7:return[2]}})})()},resetUserProfile:function(){e({userProfile:b.userProfile})},genUserDefaultProfile:function(e){return(0,i._)(function(){var t,r,n,i;return(0,a.__generator)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,Promise.all([m.apiService.profile.UpdateProfile({entity_id:e,avatar_url:"",nickname:"",user_name:""}),m.apiService.profile.UserHitProfileRegister()])];case 1:return[2,(null==(n=o.sent())?void 0:null===(r=n[1])||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.profile_enable)||!1];case 2:return i=o.sent(),l.logger.persist.error({message:"[genUserDefaultProfile] genUserDefaultProfile failed",error:i}),[2,!1];case 3:return[2]}})})()},localUpdateNickName:function(r){var n;e({userProfile:(0,u._)((0,o._)({},t().userProfile),{botCount:(null===(n=t().userProfile)||void 0===n?void 0:n.botCount)||0,nickname:r,is_default_nickname:!1})})},updateUserHitStatusHitSource:function(){return(0,i._)(function(){var r,n;return(0,a.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,v.checkSamanthaHitStatus)()];case 1:return e({hitStatusHitSource:r=n.sent().result.hit_source}),[2,r];case 2:return n.sent(),[2,t().hitStatusHitSource];case 3:return[2]}})})()}})};var A=(n=(0,c.persist)((0,c.subscribeWithSelector)(C),S.persistOptions),(0,p.isEnableDebug)()?(0,f.create)()((0,c.devtools)(n,{name:"flow-web-user-store"})):(0,f.create)()(n)),w=function(){return A(function(e){return{updateUserInfo:e.updateUserInfo,getProfileInfo:e.getProfileInfo,updateUserProfile:e.updateUserProfile,resetUserProfile:e.resetUserProfile,genUserDefaultProfile:e.genUserDefaultProfile,localUpdateNickName:e.localUpdateNickName}},s.shallow)},P=function(){return A.getState().userInfo},L=function(){return A(function(e){return e.userInfo},s.shallow)},I=function(){var e;return null===(e=P())||void 0===e?void 0:e.user_id_str},y=function(){return A(function(e){return e.userProfile},s.shallow)},U=function(){A.getState().resetUserProfile()}},7288:function(e,t,r){"use strict";r.d(t,{createStorage:function(){return n.createStorage},persistLogger:function(){return n.persistLogger}});var n=r("52265")},52265:function(e,t,r){"use strict";r.d(t,{createStorage:function(){return c},persistLogger:function(){return s}});var n=r("92769"),i=r("88802"),o=r("68461"),u=r("83680"),a=r.n(u),s=r("87382").logger.createLoggerWith({ctx:{namespace:"persist"}}),c=function(){var e,t,r,u=a().createInstance({name:"flow-web",storeName:"store"});var s={getItem:(e=(0,n._)(function(e){return(0,i.__generator)(this,function(t){switch(t.label){case 0:return[4,u.getItem(e)];case 1:return[2,t.sent()]}})}),function(t){return e.apply(this,arguments)}),setItem:(t=(0,n._)(function(e,t){return(0,i.__generator)(this,function(r){switch(r.label){case 0:return[4,u.setItem(e,t)];case 1:return r.sent(),[2]}})}),function(e,r){return t.apply(this,arguments)}),removeItem:(r=(0,n._)(function(e){return(0,i.__generator)(this,function(t){switch(t.label){case 0:return[4,u.removeItem(e)];case 1:return t.sent(),[2]}})}),function(e){return r.apply(this,arguments)})};return s&&(s.setItem=(0,o.default)(s.setItem,1e3)),s}},53991:function(e,t,r){"use strict";r.d(t,{notifyLoginStatusChange:function(){return f}});var n=r("92769"),i=r("9161"),o=r("16044"),u=r("88802"),a=r("87382"),s=r("45194");function c(){return(c=(0,n._)(function(e){var t,r,n,c;return(0,u.__generator)(this,function(u){if(t=(0,s.parseHashOrQuery)(location.search).extId,r=(0,o._)((0,i._)({},e),{body:(0,o._)((0,i._)({},null==e?void 0:e.body),{originContext:"web"})}),t)try{return[2,null===(c=chrome)||void 0===c?void 0:null===(n=c.runtime)||void 0===n?void 0:n.sendMessage(t,e)]}catch(e){a.logger.persist.error({message:"[ext-helper] sendMessage via chrome.runtime.sendMessage error",error:e})}try{window.postMessage(r,location.origin)}catch(e){a.logger.persist.error({message:"[ext-helper] sendMessage error, retry via window.postMessage",error:e})}return[2]})})).apply(this,arguments)}function f(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e){return c.apply(this,arguments)}({name:"update-auth-info",body:{isLogin:e}})}},26330:function(e,t,r){"use strict";r.d(t,{resetLaunchPromise:function(){return i}});var n=r("26107"),i=function(){window[n.PromiseName.Launch]=Promise.resolve(null)}},85397:function(e,t,r){"use strict";r.d(t,{HitSource:function(){return a},SamanthaWebHitStatus:function(){return s},ShareStatus:function(){return c},SkillInputOptionType:function(){return f}});var n,i,o,u,a=((n={})[n.NewUser=0]="NewUser",n[n.RegisteredUser=1]="RegisteredUser",n);var s=((i={})[i.NotHit=0]="NotHit",i[i.Hit=1]="Hit",i);var c=((o={})[o.Generating=1]="Generating",o[o.Succeed=2]="Succeed",o[o.Failed=3]="Failed",o[o.Deleted=4]="Deleted",o);var f=((u={})[u.None=0]="None",u[u.Placeholder=1]="Placeholder",u[u.Language=2]="Language",u[u.Select=3]="Select",u)},61760:function(e,t,r){"use strict";r.d(t,{UserConfigObject:function(){return o},UserConfigPullReason:function(){return u}});var n,i,o=((n={})[n.AnswerWithSuggest=1]="AnswerWithSuggest",n[n.AnswerWithVideo=2]="AnswerWithVideo",n[n.HighlightKeyword=3]="HighlightKeyword",n[n.OptOutVoice=4]="OptOutVoice",n[n.PersonalizedRecommend=5]="PersonalizedRecommend",n[n.SaveChatHistory=6]="SaveChatHistory",n[n.InputSuggest=10]="InputSuggest",n[n.UserAuth=30]="UserAuth",n[n.UseOgfSwitch=50]="UseOgfSwitch",n[n.CopilotSwitch=60]="CopilotSwitch",n[n.ActionBarSwitch=200]="ActionBarSwitch",n[n.ActionBarSwitch_DoubaoSpeak=201]="ActionBarSwitch_DoubaoSpeak",n);var u=((i={})[i.Startup=1]="Startup",i[i.Polling=2]="Polling",i[i.Notified=3]="Notified",i)},54915:function(e,t,r){"use strict";r.d(t,{getFeatureConfigValue:function(){return b},intersectFeatureConfigFromLaunch:function(){return m},intersectFeatureConfigFromUserConfig:function(){return S},pullFeatureConfigFromUserConfigSingle:function(){return C},syncFeatureConfigFromUserConfig:function(){return A},useFeatureConfig:function(){return w}});var n,i,o,u=r("92769"),a=r("9161"),s=r("6462"),c=r("88802"),f=r("33434"),l=r("73560"),d=r("59574"),g=r("87382"),_=r("61760"),h=r("78142"),p=r("75995"),v=r("49461"),m=function(e,t){return Object.fromEntries((0,l.default)((0,s._)(Object.keys(e)).concat((0,s._)(Object.keys(t||{})))).map(function(r){var n=e[r],i=null==t?void 0:t[r];return(0,d.default)(i)?[]:[r,{enabled:i.enabled,default_value:i.default_value,value:null==n?void 0:n.value,version:null==n?void 0:n.version}]}).filter(function(e){return!!(null==e?void 0:e.length)}))},S=function(e,t){return t?Object.fromEntries(Object.keys(e).map(function(r){var n,i=e[r],o=null==t?void 0:null===(n=t.configs)||void 0===n?void 0:n.find(function(e){return e.object===v.FEATURE_CONFIG_KEY_MAPS[r]});return o?[r,(0,a._)({},i,Number(o.version)<Number(null==i?void 0:i.version)?{}:{version:o.version,value:!!Number(o.value)})]:[r,i]})):e},b=function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{enabled:null==e?void 0:e.enabled,value:null!==(r=null!==(t=(null==e?void 0:e.enabled)?null==e?void 0:e.value:void 0)&&void 0!==t?t:null==e?void 0:e.default_value)&&void 0!==r?r:n}};var C=(i=(n=(0,u._)(function(e,t,r){var n,i,o,u,a,s,f;return(0,c.__generator)(this,function(c){switch(c.label){case 0:return o=void 0===(i=(n=t||{}).objects)?Object.values(v.FEATURE_CONFIG_KEY_MAPS):i,a=void 0===(u=n.reason)?_.UserConfigPullReason.Startup:u,s=++e,[4,h.FlowApi.apiService.setting.PullUserConfig({objects:o,reason:a}).catch(function(){return g.logger.persist.warning("fetchUserConfig fail"),{data:void 0}})];case 1:if(f=c.sent().data,s<e&&!r||!f)throw Error("skipped setFeatureConfig");return p.useFeatureConfigStore.getState().setFeatureConfigFromUserConfig(f),[2]}})}),function(e,t,r){return n.apply(this,arguments)}),o=null,function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(o&&!t)return o;(o=i(0,e,t)).then(function(){o=null}).catch(function(e){g.logger.info("setFeatureConfig skipped")})}),A=function(e){return h.FlowApi.apiService.setting.SyncUserConfig({configs:e}).catch(function(e){var t;g.logger.persist.warning({message:"UpdateUserConfig",meta:{error_code:null==e?void 0:null===(t=e.errorOption)||void 0===t?void 0:t.code}})})},w=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,p.useFeatureConfigStore)(function(r){var n;return b(null===(n=r.featureConfig)||void 0===n?void 0:n[e],t)},f.shallow)}},49461:function(e,t,r){"use strict";r.d(t,{FEATURE_CONFIG_KEY_MAPS:function(){return i}});var n=r("61760"),i={answer_with_suggest:n.UserConfigObject.AnswerWithSuggest,answer_with_video:n.UserConfigObject.AnswerWithVideo,named_entity_highlight:n.UserConfigObject.HighlightKeyword,personalized_recommend:n.UserConfigObject.PersonalizedRecommend,save_chat_history:n.UserConfigObject.SaveChatHistory}},75995:function(e,t,r){"use strict";r.d(t,{useFeatureConfigStore:function(){return b}});var n,i=r("83316"),o=r("9161"),u=r("16044"),a=r("89334"),s=r("99466"),c=r("37222"),f=r("85205"),l=r("83911"),d=r("87382"),g=r("5890"),_=r("61760"),h=r("49461"),p=r("54915"),v=r("71530"),m={featureConfig:{}},S=function(e,t){return g.resetStoreManager.push(function(){return e(m)}),(0,u._)((0,o._)({},m),(0,i._)({resetFeatureConfig:function(){e({featureConfig:m.featureConfig})},setFeatureConfigFromLaunch:function(r){e({featureConfig:(0,p.intersectFeatureConfigFromLaunch)(t().featureConfig,r)})},setFeatureConfigFromUserConfig:function(r){e({featureConfig:(0,p.intersectFeatureConfigFromUserConfig)(t().featureConfig,r)})},toggleFeatureConfig:function(e){var r;t().updateFeatureConfig(e,!(null===(r=t().featureConfig[e])||void 0===r?void 0:r.value))}},"updateFeatureConfig",function(r,n){var c=t(),f=c.featureConfig[r],g=(0,a._)(c.featureConfig,[r].map(s._));if((0,l.default)(f)||!(null==f?void 0:f.enabled)){d.logger.persist.warning({message:"toggle invalid key in feature_config",meta:{config_key:r}});return}e({featureConfig:(0,u._)((0,o._)({},g),(0,i._)({},r,(0,u._)((0,o._)({},f),{value:n})))}),h.FEATURE_CONFIG_KEY_MAPS[r]&&(0,p.syncFeatureConfigFromUserConfig)([{object:h.FEATURE_CONFIG_KEY_MAPS[r],value:n?"1":"0",version:null==f?void 0:f.version}]).finally(function(){return(0,p.pullFeatureConfigFromUserConfigSingle)({reason:_.UserConfigPullReason.Notified},!0)})}))};var b=(n=(0,c.subscribeWithSelector)(S),(0,v.isEnableDebug)()?(0,f.create)()((0,c.devtools)(n,{name:"flow-web-feature-config-store"})):(0,f.create)()(n))},33220:function(e,t,r){"use strict";r.d(t,{FLOW_WEB_LOGIN_KEY:function(){return i},isLogined:function(){return a},setHasLogined:function(){return o},setNotLogined:function(){return u}});var n=r("78597"),i="flow_web_has_login",o=function(){n.SyncStorage.setItem(i,"true")},u=function(){n.SyncStorage.removeItem(i)},a=function(){return"true"===n.SyncStorage.getItem(i)}},18545:function(e,t,r){"use strict";r.d(t,{PassportApiError:function(){return f},PassportErrorCodes:function(){return c},isAccountError:function(){return _},isAccountErrorResponse:function(){return h},isCloseCaptchaError:function(){return g},isPassportApiError:function(){return l},isPassportApiUserNotFoundError:function(){return d}});var n,i=r("69420"),o=r("73209"),u=r("67941"),a=r("26379"),s=r("37903");var c=((n={})[n.NOT_LOGGED_IN=13]="NOT_LOGGED_IN",n[n.APP_NO_ACCESS=16]="APP_NO_ACCESS",n[n.ALREADY_BIND_CONFLICT=1041]="ALREADY_BIND_CONFLICT",n[n.TARGET_BIND_CONFLICT=1030]="TARGET_BIND_CONFLICT",n[n.NO_BIND_MOBILE=1342]="NO_BIND_MOBILE",n[n.LAST_PASSPORT=1038]="LAST_PASSPORT",n[n.PHONE_BIND_CONFLICT=1057]="PHONE_BIND_CONFLICT",n[n.PHONE_ALREADY_REGISTERED=1001]="PHONE_ALREADY_REGISTERED",n[n.VERIFY_CODE_EXCEED=1206]="VERIFY_CODE_EXCEED",n[n.BIND_TOO_OFTEN=2068]="BIND_TOO_OFTEN",n),f=function(e){(0,o._)(r,e);var t=(0,a._)(r);function r(e,n,o){var u;return(0,i._)(this,r),(u=t.call(this,n)).code=e,u.description=n,u.raw=o,u}return r.from=function(e){var t,n,i=null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.description,o=null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.error_code,u=null==e?void 0:e.data;return new r(o,i?String(i):void 0,u)},r}((0,u._)(Error)),l=function(e){return e instanceof f},d=function(e){return l(e)&&1011===e.code},g=function(e){return"CLOSE_CAPTCHA"===e},_=function(e){return!(0,s.default)(null==e?void 0:e.description)&&!(0,s.default)(null==e?void 0:e.error_code)},h=function(e){return(null==e?void 0:e.message)==="error"}},49022:function(e,t,r){"use strict";r.d(t,{dropAdaptors:function(){return i}});var n=r("96049");function i(){n.FlowNetAdaptor.socketAdaptor.drop(),n.FlowNetAdaptor.httpChunkAdaptor.drop(),n.FlowNetAdaptor.httpAdaptor.drop()}}}]);