/*! For license information please see lib-i18n-starling.4e404710.js.LICENSE.txt */
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["1760"],{93276:function(t,e,i){"use strict";i.d(e,{default:function(){return u}});var n,o,r=i("82604"),a=function(){return(a=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function s(t,e,i){function n(t){return t&&t.indexOf("###")>-1?t.replace(/###/g,"."):t}function o(){return!t||"string"==typeof t}void 0===i&&(i=null);for(var r="string"!=typeof e?[].concat(e):e.split(".");r.length>1;){if(o())return{};var a=n(r.shift());!t[a]&&i&&(t[a]=new i),t=t[a]}return o()?{}:{obj:t,k:n(r.shift())}}(n=o||(o={})).keepRaw="keepRaw",n.replaceAnyway="replaceAnyway",o.replaceAnyway;var c={memoize:!1,memoizeFallback:!1,bindI18n:!1,bindI18nStore:!1,onParseError:o.replaceAnyway},u=function(){function t(){this.mem={}}return t.staticInit=function(e){t._i18nextInstance=e},t.prototype.init=function(e,i){var n=this;void 0===e&&(e=t._i18nextInstance);var o={};if((null==e?void 0:e.options)&&(e.options.i18nFormat&&(o=e.options.i18nFormat),o.onParseError=e.options.onParseError,o.missingInterpolationHandler=e.options.missingInterpolationHandler,o.icuConfig=e.options.icuConfig,o.ignoreWarning=!!e.options.ignoreWarning),this.options=Object.assign(c,i,o),this.formats=this.options.formats,e){var a=this.options,s=a.bindI18n,u=a.bindI18nStore,l=a.memoize;e.IntlMessageFormat=r.default,this.IntlMessageFormat=r.default,e.ICU=this,l&&(s&&e.on(s,function(){return n.clearCache()}),u&&e.store.on(u,function(){return n.clearCache()}))}this.options.localeData&&("[object Array]"===Object.prototype.toString.apply(this.options.localeData)?this.options.localeData.forEach(function(t){return n.addLocaleData(t)}):this.addLocaleData(this.options.localeData))},t.prototype.addLocaleData=function(t){("[object Array]"===Object.prototype.toString.apply(t)?t:[t]).forEach(function(t){t&&t.locale&&r.default.__addLocaleData(t)})},t.prototype.addUserDefinedFormats=function(t){this.formats=this.formats?a(a({},this.formats),t):t},t.prototype.checkMissingInterpolation=function(t,e,i,n,r){if(!1===(this.options.icuConfig||{}).strict)return i;for(var a={},s=0;s<t.length;s++){var c=t[s];if(1===c.type){var u=c.value;if(null===i[u]||void 0===i[u]){if("function"==typeof this.options.missingInterpolationHandler){var l=this.options.missingInterpolationHandler({key:r,text:e,locale:n,interpolation:{key:u,val:i[u]}});if("string"==typeof l){a[u]=l;continue}}switch(this.options.onParseError){case o.keepRaw:throw Error();case o.replaceAnyway:a[u]="{"+u+"}";continue}if("function"==typeof this.options.onParseError){var h=this.options.onParseError(e,u,n,this.IntlMessageFormat);if(!0===h)throw Error();a[u]="string"==typeof h?h:"{"+u+"}"}else this.options.ignoreWarning,a[u]="{"+u+"}"}}}return Object.assign({},i,a)},t.prototype.parse=function(t,e,i,n,o,r){var a,c,u,l,h,p=r&&r.resolved&&r.resolved.res,f=this.options.memoize&&i+"."+n+"."+o.replace(/\./g,"###");!p&&e.thirdParamFallback&&e.fallbackText&&(t=e.fallbackText),this.options.memoize&&(h=function(t,e){var i=s(t,e),n=i.obj,o=i.k;if(n)return n[o]}(this.mem,f));try{if(!h&&(h=new this.IntlMessageFormat(t,i,this.formats,(this.options.icuConfig||{}).formatOptions),this.options.memoize&&(this.options.memoizeFallback||!r||p))){;a=this.mem,c=f,u=h,(l=s(a,c,Object)).obj[l.k]=u}return h.format(this.checkMissingInterpolation(h.getAst(),t,e||{},i,o))}catch(e){return t}},t.prototype.addLookupKeys=function(t,e,i,n,o){return t},t.prototype.clearCache=function(){this.mem={}},t.type="i18nFormat",t._i18nextInstance=null,t}();u.name},24264:function(t,e,i){"use strict";i.d(e,{default:function(){return r}});var n=function(){return(n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=/^\s*\[\[__starling_(\d+)_(.*)__\]\]\s*$/;"undefined"!=typeof window&&(window.__STARLING_INCONTEXT_GLOBAL__HOOK__=n({},window.__STARLING_INCONTEXT_GLOBAL__HOOK__||{payload:{}}));var r={name:"inContext",type:"postProcessor",process:function(t,e,i,n){if(!(window&&document.getElementById("INCONTEXT-KEY-MATCH"))||i.__STARLING_INCONTEXT_FLAG__)return t;!window.__STARLING_INCONTEXT_GLOBAL_I18N__&&(window.__STARLING_INCONTEXT_GLOBAL_I18N__=n),delete i.keySeparator,delete i.lngs;var r=0;if(e=e.toString(),o.test(e)){var a=e.match(o);a[0];var s=a[1],c=a[2];r=s,e=c}if(o.test(t)){var a=t.match(o);a[0];var s=a[1],c=a[2];t=c}if(window.__STARLING_INCONTEXT_GLOBAL__HOOK__.payload[e]){var u=window.__STARLING_INCONTEXT_GLOBAL__HOOK__.payload[e].findIndex(function(t){return JSON.stringify(t.options)===JSON.stringify(i)});u>-1?(window.__STARLING_INCONTEXT_GLOBAL__HOOK__.payload[e][u].default=t,r=u):r=window.__STARLING_INCONTEXT_GLOBAL__HOOK__.payload[e].push({options:i,default:t})-1}else window.__STARLING_INCONTEXT_GLOBAL__HOOK__.payload[e]=[{options:i,default:t}],r=0;return"[[__starling_"+r+"_"+e+"__]]"}}},82356:function(t,e){"use strict";var i,n=function(t,e){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};function o(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var r=function(t,e){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},a=function(){return(a=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function s(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{c(n.next(t))}catch(t){r(t)}}function s(t){try{c(n.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})}function c(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(i)throw TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}var u=function(t){function e(e,i,n){var o=t.call(this,i)||this;return o.code=e,o.message=i,o.originError=n,o.name="StarlingError",o.code=e,o.message=i,o.originError=n,Error.captureStackTrace&&Error.captureStackTrace(o,o.constructor),o}return!function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),e}(Error),l={API_PARAMS_ERROR:{ERROR_CODE:103,ERROR_MESSAGE:"Request failed, confirm your apiKey and namespace is correct"},PARAMS_ERROR:{ERROR_CODE:110,ERROR_MESSAGE:"Check your params, parameter apiKey, namespace and zoneHost is required!"},PARAMS_ERROR_2:{ERROR_CODE:111,ERROR_MESSAGE:"Check your params, parameter request and store is required!"},CACHE_ERROR:{ERROR_CODE:112,ERROR_MESSAGE:"Cache error!"},VERSION_NOT_FOUND:{ERROR_CODE:120,ERROR_MESSAGE:"Version is not found, please check your param [version]!"}},h={zone:"CN",locale:"zh",timeout:15e3,test:!1,mode:"normal",format:"merged",lazyUpdate:!1,fallbackLang:["zh"],tracker:function(){},cache:!0},p=function(){function t(t){this.options=t,this.options=t}return t.prototype.getText=function(t,e){return s(this,void 0,void 0,function(){return c(this,function(i){switch(i.label){case 0:return[4,this._request(t,e)];case 1:return[2,i.sent()]}})})},t.prototype.getTexts=function(t){var e=this;return Promise.all(t.map(function(t){var i=t[0],n=t[1];return e.getText(i,n)}))},t.prototype._request=function(t,e){return s(this,void 0,void 0,function(){var i,n,o,r,a,s,h,p,f,d,g;return c(this,function(c){switch(c.label){case 0:if(i=(0,this.options.getReleaseVersion)(t),t&&i&&e)return[2,{}];return n=this.getUrl(t,e),r=(o=this.options).request,[4,r(n,{timeout:o.timeout})];case 1:if(s=(a=c.sent().data).status,h=a.message,200==+s)return[2,this._mapResponse(h)];if(1001==+s)throw f=(p=l.VERSION_NOT_FOUND).ERROR_CODE,new u(f,p.ERROR_MESSAGE);throw g=(d=l.API_PARAMS_ERROR).ERROR_CODE,new u(g,d.ERROR_MESSAGE)}})})},t.prototype.getUrl=function(t,e){var i=this.options,n=i.apiKey,o=i.locale,r=i.fallbackLang,a=i.zoneHost,s=i.mode,c=i.getReleaseVersion,u=[o].concat(r),l=a+"/check_and_get_text/"+n+"/"+s+"/"+t+"?lang="+u,h=c(t);return h&&(l=a+"/text_by_release_version/"+n+"/"+s+"/"+t+"/"+h+"?lang="+u),"string"==typeof e&&(l+="&version="+e),l},t.prototype._mapResponse=function(t){return t?Object.keys(t).reduce(function(e,i){return e[i.toLowerCase()]=t[i],e},{}):{}},t}(),f=function(){function t(t){this.options=t,this.options=t}return t.prototype._setCache=function(t,e){try{return this.options.store.set(t,e)}catch(t){var i=l.CACHE_ERROR.ERROR_CODE;this.options.tracker("cache_error",{code:i,message:t.message,stack:t.stack});return}},t.prototype._getCache=function(t){var e=this.options,i=e.store,n=e.cache;try{return n&&i.get(t)}catch(t){var o=l.CACHE_ERROR.ERROR_CODE;this.options.tracker("cache_error",{code:o,message:t.message,stack:t.stack});return}},t.prototype.getVersion=function(t){var e=this.options,i=e.apiKey,n=e.locale,o=e.getReleaseVersion,r="version."+i+"."+t+"."+n,a=o(t);return(a&&(r+="."+a),this.getText(t))?this._getCache(r):null},t.prototype.getVersions=function(t){var e=this;return Promise.all(t.map(function(t){return e.getVersion(t)}))},t.prototype.getText=function(t){var e=this.options,i=e.apiKey,n=e.locale,o=e.getReleaseVersion,r="text."+i+"."+t+"."+n,a=o(t);return a&&(r+="."+a),this._getCache(r)},t.prototype.getTexts=function(t){var e=this;return Promise.all(t.map(function(t){return e.getText(t)}))},t.prototype.refresh=function(t,e,i,n){return s(this,void 0,void 0,function(){var o,r,a,s,u,l=this;return c(this,function(c){switch(c.label){case 0:return r=(o=this.options).apiKey,a=o.getReleaseVersion,s=o.cache,u=[],e.forEach(function(o,c){var h="text."+r+"."+t[c]+"."+n[c],p="version."+r+"."+t[c]+"."+n[c],f=a(t[c]);f&&(h+="."+f,p+="."+f),s&&(u.push(l._setCache(h,e[c])),u.push(l._setCache(p,i[c])))}),[4,Promise.all(u)];case 1:return c.sent(),[2,e.reduce(function(t,e){return Object.assign(t,e)},{})]}})})},t}(),d=function(){function t(t){void 0===t&&(t=[]),this._list=[],this._list=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),t.prototype.getList=function(){return this._list},t.prototype.getNamespaces=function(){return this._list.map(function(t){return t.namespace})},t.prototype.addNamespace=function(t){this._list.push(t)},t.prototype.insertTexts=function(t){this._list.forEach(function(e,i){e.texts=t[i]})},t.prototype.sortByPrior=function(){return this._list.sort(function(t,e){return t.prior-e.prior}),this._list},t.prototype.concat=function(e){return new t(this._list.concat(e.getList()))},t}(),g=function(){function t(t,e,i){this._promiseRefresh=Promise.resolve(null),this.remote=t,this.local=e,this.options=i}return t.prototype._checkVersions=function(t){return s(this,void 0,void 0,function(){var e,i,n,o,r,a;return c(this,function(s){switch(s.label){case 0:return e=this.options.locale,[4,this.local.getVersions(t)];case 1:return i=s.sent(),n=t.map(function(t,e){return[t,i[e]]}),[4,this.remote.getTexts(n)];case 2:return o=s.sent(),r=new d,a=new d,t.forEach(function(t,n){var s=o[n],c=s.updated,u=s.version,l=s.data,h=s.lang;c?a.addNamespace({namespace:t,prior:n,version:u,texts:l,lang:h}):r.addNamespace({namespace:t,prior:n,version:i[n],lang:e})}),[2,{equalNs:r,diffNs:a}]}})})},t.prototype.waitForRefresh=function(){return this._promiseRefresh},t.prototype._refresh=function(t){var e=t.getList(),i=[],n=[],o=[],r=[];return e.forEach(function(t){i.push(t.namespace),n.push(t.version),o.push(t.texts),r.push(t.lang)}),this.local.refresh(i,o,n,r)},t.prototype._getLocalTexts=function(t){return s(this,void 0,void 0,function(){var e;return c(this,function(i){switch(i.label){case 0:return[4,this.local.getTexts(t.getNamespaces())];case 1:return e=i.sent(),t.insertTexts(e),[2,e]}})})},t.prototype.load=function(t){return s(this,void 0,void 0,function(){var e,i,n,o,r,a;return c(this,function(s){switch(s.label){case 0:return e=this.options.format,[4,this._checkVersions(t)];case 1:if(n=(i=s.sent()).equalNs,o=i.diffNs,!n.length)return[3,3];return[4,this._getLocalTexts(n)];case 2:return s.sent(),[3,4];case 3:s.label=4;case 4:if(r=this._formatTexts(e,o.concat(n)),!(a=o.length))return[3,6];return[4,this._refresh(o)];case 5:a=s.sent(),s.label=6;case 6:return[2,{texts:r,diffNs:o.getNamespaces(),equalNs:n.getNamespaces()}]}})})},t.prototype._getCacheText=function(t){return s(this,void 0,void 0,function(){var e,i,n,o,r,a;return c(this,function(s){switch(s.label){case 0:return i=(e=this.options).locale,n=e.format,[4,this.local.getTexts(t)];case 1:return o=s.sent(),[4,this.local.getVersions(t)];case 2:return r=s.sent(),a=new d(o.map(function(e,n){if(e)return{namespace:t[n],version:r[n],lang:i,texts:e}}).filter(function(t){return!!t})),[2,this._formatTexts(n,a)]}})})},t.prototype.lazyLoad=function(t){return s(this,void 0,void 0,function(){var e,i,n;return c(this,function(o){switch(o.label){case 0:return[4,this._getCacheText(t)];case 1:if(i=0===Object.keys(e=o.sent()).length,this._promiseRefresh=this.load(t),!i)return[3,3];return[4,this._promiseRefresh];case 2:e=(n=o.sent()).texts,o.label=3;case 3:return[2,{texts:e,diffNs:i?n&&n.diffNs:[],equalNs:i?n&&n.equalNs:t}]}})})},t.prototype._formatTexts=function(t,e){var i,n;if("splitted"===t)return e.getList().reduce(function(t,e){var i=e.namespace,n=e.lang,o=e.texts,r=e.version;return t[i]={lang:n,texts:o,version:r},t},{});return i=e.sortByPrior().map(function(t){return t.texts}),(n?i.concat(n):i).reduce(function(t,e){return Object.assign(t,e)},{})},t}();"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t){if(null==t)throw TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},writable:!0,configurable:!0});var _={EVENT_EXCEPTION:"client_exception",EVENT_LOAD:"client_load",EVENT_CACHE:"client_cache",EVENT_LOAD_TIME:"client_load_time"};(D||(D={})).AfterLoad="afterLoad";var m=function(){function t(t){this.afterLoadPlugins=[],this.setConfig(t)}return t.prototype._init=function(t){var e=this;this.options=function(t){var e=(t=Object.assign({},h,t)).namespace,i=t.apiKey,n=t.request,o=t.store,r=t.zoneHost;if(t.test&&(t.mode="test"),t.namespace=e=e?Array.isArray(e)?e:[e]:[],t.apiKey=i=i||t.api_key,!n||!o){var a=l.PARAMS_ERROR_2,s=a.ERROR_CODE,c=a.ERROR_MESSAGE;throw new u(s,c,null)}if(!i||!e.length||!r){var p=l.PARAMS_ERROR,s=p.ERROR_CODE,c=p.ERROR_MESSAGE;throw new u(s,c,null)}return t}(t);var i=this.options,n=i.apiKey,o=i.locale,r=i.zoneHost,s=i.request,c=i.timeout,d=i.fallbackLang,_=i.store,m=i.lazyUpdate,v=i.test,y=i.mode,b=i.format,E=i.cache,w={mode:m?"lazy":v?"test":"prod",zone:r,locale:o,apiKey:n};this._tracker=function(t,i){try{e.options.tracker(t,a(a({},w),i))}catch(t){}};var S=this._getReleaseVersionByNamespace.bind(this),k=new p({request:s,timeout:c,apiKey:n,locale:o,zoneHost:r,fallbackLang:d,mode:y,getReleaseVersion:S}),A=new f({apiKey:n,locale:o,store:_,tracker:this._tracker,getReleaseVersion:S,cache:E});this._textManager=new g(k,A,{locale:o,format:b}),this.initPlugin()},t.prototype.initPlugin=function(){var t=this,e=this.options.plugins||[];Array.isArray(e)&&e.every(function(t){return"object"==typeof t})&&e.forEach(function(e){e.type===D.AfterLoad&&t.afterLoadPlugins.push(e)})},t.prototype._getReleaseVersionByNamespace=function(t){var e=this.options.namespace,i=this.options.version,n=null;return Array.isArray(i)?n=i[e.findIndex(function(e){return e===t})]:i&&"object"==typeof i?n=i[t]:"string"==typeof i&&(n=i),n},t.prototype.setConfig=function(t){var e=Object.assign({},this.options,t);this._init(e)},t.prototype.waitForRefresh=function(){return s(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return[4,this._textManager.waitForRefresh()];case 1:return[2,(t=e.sent())?t.texts:null]}})})},t.prototype._load=function(){return s(this,void 0,void 0,function(){var t,e,i,n,o;return c(this,function(r){switch(r.label){case 0:if(e=(t=this.options).namespace,i=t.lazyUpdate,n=e,!i)return[3,2];return[4,this._textManager.lazyLoad(n)];case 1:return o=r.sent(),[3,4];case 2:return[4,this._textManager.load(n)];case 3:o=r.sent(),r.label=4;case 4:return[2,o]}})})},t.prototype.load=function(t,e){return s(this,void 0,void 0,function(){var i,n,o,r,a,s,u,l,h,p,f,d,g,m=this;return c(this,function(c){switch(c.label){case 0:i=Date.now(),n=this.options.namespace,c.label=1;case 1:return c.trys.push([1,5,,10]),this._tracker(_.EVENT_LOAD,{state:"start",version:"0.5.9"}),[4,this._load()];case 2:if(r=(o=c.sent()).diffNs,a=o.equalNs,s=o.texts,!(Array.isArray(u=this.afterLoadPlugins)&&u.length))return[3,4];return[4,u.reduce(function(t,e){return t.then(function(t){return"function"==typeof e.process?e.process(t||s,m.options):t})},Promise.resolve(s))];case 3:s=c.sent()||s,c.label=4;case 4:return t&&t(s),this._tracker(_.EVENT_LOAD_TIME,{time:Date.now()-i}),this._tracker(_.EVENT_LOAD,{state:"success",version:"0.5.9"}),l=r.length,h=a.length,f=(h/(p=n.length)).toFixed(2),this._tracker(_.EVENT_CACHE,{diffLen:l,diff:r.join(","),equalLen:h,equal:a.join(","),namespaces:a.join(","),namespacesLen:p,ratio:f}),[2,s];case 5:if(d=c.sent(),this._tracker(_.EVENT_LOAD,{state:"fail"}),this._tracker(_.EVENT_EXCEPTION,{code:d.code,message:d.message,stack:d.stack}),!(d||{}).useWebCache)return[3,9];c.label=6;case 6:return c.trys.push([6,8,,9]),[4,this._textManager._getCacheText(n)];case 7:return(g=c.sent())&&"object"==typeof g?d.response.data=g:d.response.data={},[3,9];case 8:return c.sent(),[3,9];case 9:if(!e)return[2,Promise.reject(d)];e(d);return[3,10];case 10:return[2]}})})},t}(),v=new(function(){function t(){}return t.prototype.get=function(t){if(localStorage&&localStorage.getItem)return function(t){if("string"==typeof t)try{return JSON.parse(t)}catch(e){return t||void 0}}(localStorage.getItem(t))},t.prototype.set=function(t,e){if(localStorage&&localStorage.setItem)localStorage.setItem(t,JSON.stringify(e))},t}()),y=function(t){function e(e,i,n,o,r,a){var s=t.call(this,e)||this;return s.url=i,s.code=n,s.request=o,s.response=r,s.useWebCache=a,s.url=i,s.code=n,s.request=o,s.response=r,s.useWebCache=!!a,s}return o(e,t),e}(Error);function b(t,e){var i=e.timeout;return new Promise(function(e,n){var o=new XMLHttpRequest;o.open("GET",t),o.withCredentials=!1,o.onreadystatechange=function(){if(!!o&&4===o.readyState){if(0!==o.status||o.responseURL&&0===o.responseURL.indexOf("file:")){var i,r,a,s,c,u=function(t){try{return JSON.parse(t)}catch(t){return{}}}(o.responseText);var l=(i=u).message&&"object"==typeof i.message?i:null;if(o.status<200||o.status>=300||!l){;r=o,a=n,s=t,c=(c=(u||{}).message||"")?", reason is: ".concat(c):"",a(new y("Request failed with status code "+r.status+c,s,null,r,{data:{}},!0)),o=null;return}e({data:l,status:o.status,statusText:o.statusText,request:o}),o=null}}},o.onerror=function(){n(new y("Network Error",t,null,o,{data:{}},!0)),o=null},o.timeout=i,o.ontimeout=function(){n(new y("timeout of "+i+"ms exceeded",t,"ECONNABORTED",o)),o=null},o.send()})}var E=function(t){function e(e){var i=this;return!e.store&&(e.store=v),!e.request&&(e.request=b),i=t.call(this,e)||this}return o(e,t),e}(m),w=function(){return(w=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function S(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}}function k(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,o,r=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=r.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return a}function A(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(k(arguments[e]));return t}var D,T,O=function(){function t(){this._hooks={},this._cache=[],this._hooksCache={}}return t.prototype.on=function(t,e){t&&e&&"function"==typeof e&&(this._hooks[t]||(this._hooks[t]=[]),this._hooks[t].push(e))},t.prototype.once=function(t,e){var i=this;t&&e&&"function"==typeof e&&this.on(t,function n(o){e(o),i.off(t,n)})},t.prototype.off=function(t,e){if(t&&this._hooks[t]&&this._hooks[t].length){if(e){var i=this._hooks[t].indexOf(e);-1!==i&&this._hooks[t].splice(i,1)}else this._hooks[t]=[]}},t.prototype.emit=function(t,e,i){i?!!t&&(-1!==this._cache.indexOf(i)?this._emit(t,e):(this._hooksCache.hasOwnProperty(i)||(this._hooksCache[i]={}),this._hooksCache[i].hasOwnProperty(t)||(this._hooksCache[i][t]=[]),this._hooksCache[i][t].push(e))):this._emit(t,e)},t.prototype._emit=function(t,e){t&&this._hooks[t]&&this._hooks[t].length&&A(this._hooks[t]).forEach(function(t){try{t(e)}catch(t){}})},t.prototype.set=function(t){t&&-1===this._cache.indexOf(t)&&this._cache.push(t)},t}(),R=function(t){return null!=t&&"[object Object]"==Object.prototype.toString.call(t)},M=function(t){return Array.isArray(t)},C=(T=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return T+=1}),G=function(t){return function(t,e,i){if("string"==typeof t&&"number"==typeof e&&"number"==typeof i){var n,o=[],r=String.fromCharCode((i=i<=25?i:i%25)+97);n=t.split(r);for(var a=0;a<n.length;a++){var s=parseInt(n[a],i),c=String.fromCharCode(s=1*s^e);o.push(c)}return o.join("")}}(t,64,25)},I=function(t){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",t,!1):window.addEventListener("beforeunload",t,!1)},x=function(t,e,i){var n=document.createElement("script");n.src=t,n.onerror=function(){i(t)},n.onload=function(){e()},document.getElementsByTagName("head")[0].appendChild(n)},N=function(){var t=0;return["hidden","msHidden","webkitHidden"].forEach(function(e){void 0!==document[e]&&(t=1)}),t},z=function(t,e){void 0===t&&(t=function(){}),void 0===e&&(e=1e3);var i,n=Date.now()+e;return i=window.setTimeout(function o(){var r=Date.now()-n;t(),n+=e,i=window.setTimeout(o,Math.max(0,e-r))},e),function(){window.clearTimeout(i)}},P=function(t){var e=document.createElement("a");return e.href=t,e},L=function(t){var e={};try{var i=P(t).search;(i=i.slice(1)).split("&").forEach(function(t){var i,n,o=t.split("=");o.length&&(i=o[0],n=o[1]);try{e[i]=decodeURIComponent(void 0===n?"":n)}catch(t){e[i]=n}})}catch(t){}return e},B=function(t){for(var e=0,i=0,n=(t+="").length,o=0;o<n;o++)((e=31*e+t.charCodeAt(i++))>0x7fffffffffff||e<-140737488355328)&&(e&=0xffffffffffff);return e<0&&(e+=0x7ffffffffffff),e};function U(t,e){return t(e={exports:{}},e.exports),e.exports}var V=U(function(t,e){t.exports=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function i(n){function o(){}function r(e,i,r){if("undefined"!=typeof document){"number"==typeof(r=t({path:"/"},o.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var a=JSON.stringify(i);/^[\{\[]/.test(a)&&(i=a)}catch(t){}i=n.write?n.write(i,e):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in r)r[c]&&(s+="; "+c,!0!==r[c]&&(s+="="+r[c].split(";")[0]));return document.cookie=e+"="+i+s}}function a(t,i){if("undefined"!=typeof document){for(var o={},r=document.cookie?document.cookie.split("; "):[],a=0;a<r.length;a++){var s=r[a].split("="),c=s.slice(1).join("=");i||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=e(s[0]);if(c=(n.read||n)(c,u)||e(c),i)try{c=JSON.parse(c)}catch(t){}if(o[u]=c,t===u)break}catch(t){}}return t?o[t]:o}}return o.set=r,o.get=function(t){return a(t,!1)},o.getJSON=function(t){return a(t,!0)},o.remove=function(e,i){r(e,"",t(i,{expires:-1}))},o.defaults={},o.withConverter=i,o}(function(){})}()}),j=function(t,e){try{return V.get(t,{domain:e||document.domain})}catch(t){return""}},K=function(t,e,i,n){try{var o=n||document.domain,r=+new Date+(i||6048e5);V.set(t,e,{expires:new Date(r),path:"/",domain:o})}catch(t){}},$=function(){function t(){this.cache={}}return t.prototype.setItem=function(t,e){this.cache[t]=e},t.prototype.getItem=function(t){return this.cache[t]},t.prototype.removeItem=function(t){this.cache[t]=void 0},t.prototype.getCookie=function(t,e){return j(t,e)},t.prototype.setCookie=function(t,e,i,n){K(t,e,i,n)},t}(),q,H,W={getItem:function(t){try{var e=localStorage.getItem(t),i=e;try{e&&"string"==typeof e&&(i=JSON.parse(e))}catch(t){}return i||{}}catch(t){}return{}},setItem:function(t,e){try{var i="string"==typeof e?e:JSON.stringify(e);localStorage.setItem(t,i)}catch(t){}},removeItem:function(t){try{localStorage.removeItem(t)}catch(t){}},getCookie:function(t,e){return j(t,e)},setCookie:function(t,e,i,n){K(t,e,i,n)},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(t){return!1}}()},J={getItem:function(t){try{var e=sessionStorage.getItem(t),i=e;try{e&&"string"==typeof e&&(i=JSON.parse(e))}catch(t){}return i||{}}catch(t){}return{}},setItem:function(t,e){try{var i="string"==typeof e?e:JSON.stringify(e);sessionStorage.setItem(t,i)}catch(t){}},removeItem:function(t){try{sessionStorage.removeItem(t)}catch(t){}},getCookie:function(t,e){return j(t,e)},setCookie:function(t,e,i,n){K(t,e,i,n)},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(t){return!1}}()},F=function(){function t(t,e){this._storage=e&&"session"===e?J:!t&&W.isSupportLS?W:new $}return t.prototype.getItem=function(t){return this._storage.getItem(t)},t.prototype.setItem=function(t,e){this._storage.setItem(t,e)},t.prototype.getCookie=function(t,e){return this._storage.getCookie(t,e)},t.prototype.setCookie=function(t,e,i,n){this._storage.setCookie(t,e,i,n)},t.prototype.removeItem=function(t){this._storage.removeItem(t)},t}(),X=function(){function t(t,e,i){this.appid=t,this.domain=e,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=i}return t.prototype.init=function(){var t=window.navigator.userAgent,e=window.navigator.language,i=document.referrer,n=i?P(i).hostname:"",o=L(window.location.href),r=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web";this.utm=function(t,e,i,n){var o=new F(!1),r=new F(!1,"session"),a=t?"_tea_utm_cache_"+t:"_tea_utm_cache",s=t?"_$utm_from_url_"+t:"_$utm_from_url",c={},u=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],l={ad_id:Number(e.ad_id)||void 0,campaign_id:Number(e.campaign_id)||void 0,creative_id:Number(e.creative_id)||void 0,utm_source:e.utm_source,utm_medium:e.utm_medium,utm_campaign:e.utm_campaign,utm_term:e.utm_term,utm_content:e.utm_content,tr_shareuser:e.tr_shareuser,tr_admaster:e.tr_admaster,tr_param1:e.tr_param1,tr_param2:e.tr_param2,tr_param3:e.tr_param3,tr_param4:e.tr_param4};try{var h=!1;for(var p in l)l[p]&&(-1!==u.indexOf(p)?(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data[p]=l[p]):c[p]=l[p],h=!0);if(h)r.setItem(s,"1"),o.setCookie(a,JSON.stringify(c),n,i);else{var f=o.getCookie(a,i);f&&(c=JSON.parse(f))}r.getItem(s)&&(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data.$utm_from_url=1)}catch(t){return l}return c}(this.appid,o,this.domain,this.cookie_expire);var a=this.browser(),s=this.os();return{browser:a.browser,browser_version:a.browser_version,platform:r,os_name:s.os_name,os_version:s.os_version,userAgent:t,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(s.os_name),language:e,referrer:i,referrer_host:n,utm:this.utm,latest_data:this.last(i,n)}},t.prototype.last=function(t,e){var i="",n="",o="",r=location.hostname,a=!1;if(t&&e&&r!==e){i=t,n=e,a=!0;var s=L(t);s.keyword&&(o=s.keyword)}return{$latest_referrer:i,$latest_referrer_host:n,$latest_search_keyword:o,isLast:a}},t.prototype.browser=function(){var t,e,i="",n=""+parseFloat(this.appVersion),o=this.userAgent;return -1!==o.indexOf("Edge")||-1!==o.indexOf("Edg")?(i="Microsoft Edge",-1!==o.indexOf("Edge")?(t=o.indexOf("Edge"),n=o.substring(t+5)):(t=o.indexOf("Edg"),n=o.substring(t+4))):-1!==(t=o.indexOf("MSIE"))?(i="Microsoft Internet Explorer",n=o.substring(t+5)):-1!==o.indexOf("Chrome")?-1!==(t=o.indexOf("TTWebView"))?(i="TTWebView",n=o.substring(t+10,t+23)):-1!==(t=o.indexOf("Chrome"))?(i="Chrome",n=o.substring(t+7)):-1!==(t=o.indexOf("Chrome"))&&(i="Chrome",n=o.substring(t+7)):-1!==o.indexOf("Safari")?-1!==(t=o.indexOf("Safari"))&&(i="Safari",n=o.substring(t+7),-1!==(t=o.indexOf("Version"))&&(n=o.substring(t+8))):-1!==(t=o.indexOf("Firefox"))&&(i="Firefox",n=o.substring(t+8)),-1!==(e=n.indexOf(";"))&&(n=n.substring(0,e)),-1!==(e=n.indexOf(" "))&&(n=n.substring(0,e)),-1!==(e=n.indexOf(")"))&&(n=n.substring(0,e)),{browser:i,browser_version:n}},t.prototype.os=function(){for(var t,e,i="",n="",o=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],r=0;r<o.length;r++){var a=o[r];if(a.r.test(this.userAgent)){"Mac OS X"===(i=a.s)&&this.isNewIpad()&&(i="iOS");break}}var s=function(t,e){var i=t.exec(e);return i&&i[1]?i[1]:""},c=function(t,e){var i=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+t+")","i").exec(e);return i?i.slice(1)[0]:""};switch(/Windows/.test(i)&&(n=s(/Windows (.*)/,i),i="windows"),i){case"Mac OS X":n=c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),i="mac";break;case"Android":(e=s(/Android ([\.\_\d]+)/,t=this.userAgent))||(e=s(/Android\/([\.\_\d]+)/,t)),n=e,i="android";break;case"iOS":n=this.isNewIpad()?c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(n=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?n[1]+"."+n[2]+"."+(0|n[3]):"",i="ios"}return{os_name:i,os_version:n}},t.prototype.getDeviceModel=function(t){var e="";try{if("android"===t)navigator.userAgent.split(";").forEach(function(t){t.indexOf("Build/")>-1&&(e=t.slice(0,t.indexOf("Build/")))});else if("ios"===t||"mac"===t||"windows"===t){if(this.isNewIpad())e="iPad";else{var i=navigator.userAgent.replace("Mozilla/5.0 (",""),n=i.indexOf(";");e=i.slice(0,n)}}}catch(t){}return e.trim()},t.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>1},t}(),Y={sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},Z={va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},Q={sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z21z1ez4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z49z23z21z1cz18z21z22z4ez18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k"},tt={sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az23z21z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az23z21z4az22z1gz1iz22z1mz1iz4az1az1mz1k"},te="5.1.4_oversea_safe",ti=function(){function t(t,e){this.collector=t,this.config=e,this.eventNameWhiteList=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure"],this.paramsNameWhiteList=["$inactive","$inline","$target_uuid_list","$source_uuid","$is_spider","$source_id","$is_first_time","_staging_flag"],this.regStr=RegExp("^[a-zA-Z0-9][a-z0-9A-Z_.-]{1,255}$")}return t.prototype.checkVerify=function(t){var e=this;if(!t||!t.length)return!1;var i=t[0];if(!i)return!1;var n=i.events,o=i.header;if(!n||!n.length)return!1;var r=!0;return n.forEach(function(t){if(!t)return r=!1,void(t.checkEvent="\u4E8B\u4EF6\u5F02\u5E38");e.checkEventName(t.event)||(r=!1,t.checkEvent="\u4E8B\u4EF6\u540D\u4E0D\u80FD\u4EE5 $ or __\u5F00\u5934"),e.checkEventParams(t.params)||(r=!1,t.checkParams="\u5C5E\u6027\u540D\u4E0D\u80FD\u4EE5 $ or __\u5F00\u5934")}),this.checkEventParams(o)||(r=!1),r},t.prototype.checkEventName=function(t){return!!t&&this.calculate(t,"event")},t.prototype.checkEventParams=function(t){var e=t;if("string"==typeof t&&(e=JSON.parse(e)),!Object.keys(e).length)return!0;for(var i in e)return!!this.calculate(i,"params")&&!("string"==typeof e[i]&&e[i].length>1024);return!0},t.prototype.calculate=function(t,e){return -1!==("event"===e?this.eventNameWhiteList:this.paramsNameWhiteList).indexOf(t)||!RegExp("^\\$").test(t)&&!RegExp("^__").test(t)},t}();(ei=q||(q={})).Init="init",ei.Config="config",ei.Start="start",ei.Ready="ready",ei.TokenComplete="token-complete",ei.TokenStorage="token-storage",ei.TokenFetch="token-fetch",ei.TokenError="token-error",ei.ConfigUuid="config-uuid",ei.ConfigWebId="config-webid",ei.ConfigDomain="config-domain",ei.CustomWebId="custom-webid",ei.TokenChange="token-change",ei.TokenReset="token-reset",ei.ConfigTransform="config-transform",ei.EnvTransform="env-transform",ei.SessionReset="session-reset",ei.SessionResetTime="session-reset-time",ei.Event="event",ei.Events="events",ei.EventNow="event-now",ei.CleanEvents="clean-events",ei.BeconEvent="becon-event",ei.SubmitBefore="submit-before",ei.SubmitScuess="submit-scuess",ei.SubmitAfter="submit-after",ei.SubmitError="submit-error",ei.SubmitVerify="submit-verify",ei.DestoryInstance="destory-instance",ei.Stay="stay",ei.ResetStay="reset-stay",ei.StayReady="stay-ready",ei.SetStay="set-stay",ei.RouteChange="route-change",ei.RouteReady="route-ready",ei.Ab="ab",ei.AbVar="ab-var",ei.AbAllVars="ab-all-vars",ei.AbConfig="ab-config",ei.AbExternalVersion="ab-external-version",ei.AbVersionChangeOn="ab-version-change-on",ei.AbVersionChangeOff="ab-version-change-off",ei.AbOpenLayer="ab-open-layer",ei.AbCloseLayer="ab-close-layer",ei.AbReady="ab-ready",ei.AbComplete="ab-complete",ei.AbTimeout="ab-timeout",ei.Profile="profile",ei.ProfileSet="profile-set",ei.ProfileSetOnce="profile-set-once",ei.ProfileUnset="profile-unset",ei.ProfileIncrement="profile-increment",ei.ProfileAppend="profile-append",ei.ProfileClear="profile-clear",ei.Autotrack="autotrack",ei.AutotrackReady="autotrack-ready",ei.CepReady="cep-ready",ei.TracerReady="tracer-ready",ei.sessionRecord="session-record",ei.SessionRecordStart="session-record-start",ei.SessionRecordPause="session-record-pause",ei.SessionRecordEnd="session-record-end",ei.SessionRecordReport="session-record-report",ei.VisualCollectReady="visual-collect-ready",ei.VisualApiReady="visual-api-ready",ei.VisualApiUpdate="visual-api-update",(en=H||(H={})).DEBUGGER_MESSAGE="debugger-message",en.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",en.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",en.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",en.DEBUGGER_MESSAGE_EVENT="debugger-message-event",en.DEVTOOL_WEB_READY="devtool-web-ready";var tn=q,to=void 0,tr=(new Date).getTimezoneOffset(),ta=parseInt(""+-tr/60,10),ts=60*tr,tc=function(){function t(t,e){this.is_first_time=!0,this.configPersist=!1,this.initConfig=e,this.collect=t;var i=new X(e.app_id,e.cookie_domain||"",e.cookie_expire||6048e5).init();this.eventCheck=new ti(t,e);var n="__tea_cache_first_"+e.app_id;this.configKey="__tea_cache_config_"+e.app_id,this.sessionStorage=new F(!1,"session"),this.localStorage=new F(!1,"local"),this.channelUrl="tcpy"===e.channel_type||"ttp"===e.channel_type?{WEBID_URL:"/v1/user/webid",TOB_URL:"",REPORT_URL:"/v1/list"}:{WEBID_URL:"/webid",TOB_URL:"/tobid",REPORT_URL:"/list"},e.configPersist&&(this.configPersist=!0,this.storage=1===e.configPersist?this.sessionStorage:this.localStorage);var o=this.localStorage.getItem(n);o&&1==o?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(n,"1")),this.envInfo={user:{user_unique_id:to,user_type:to,user_id:to,user_is_auth:to,user_is_login:to,device_id:to,web_id:to,ip_addr_id:to,user_unique_id_type:to},header:{app_id:to,app_name:to,app_install_id:to,install_id:to,app_package:to,app_channel:to,app_version:to,ab_version:to,os_name:i.os_name,os_version:i.os_version,device_model:i.device_model,ab_client:to,traffic_type:to,client_ip:to,device_brand:to,os_api:to,access:to,language:i.language,region:to,app_language:to,app_region:to,creative_id:i.utm.creative_id,ad_id:i.utm.ad_id,campaign_id:i.utm.campaign_id,log_type:to,rnd:to,platform:i.platform,sdk_version:te,sdk_lib:"js",province:to,city:to,timezone:ta,tz_offset:ts,tz_name:to,sim_region:to,carrier:to,resolution:i.screen_width+"x"+i.screen_height,browser:i.browser,browser_version:i.browser_version,referrer:i.referrer,referrer_host:i.referrer_host,width:i.screen_width,height:i.screen_height,screen_width:i.screen_width,screen_height:i.screen_height,utm_term:i.utm.utm_term,utm_content:i.utm.utm_content,utm_source:i.utm.utm_source,utm_medium:i.utm.utm_medium,utm_campaign:i.utm.utm_campaign,tracer_data:JSON.stringify(i.utm.tracer_data),custom:{},wechat_unionid:to,wechat_openid:to}},this.ab_version="",this.ab_uuid_cache={},this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(i),this.initDomain(),this.initABData()}return t.prototype.initDomain=function(t){var e=this.initConfig.channel_domain;if(e)this.domain=e;else{var i=t||this.initConfig.channel,n=this.initConfig&&this.initConfig.channel_type?"tcpy"===this.initConfig.channel_type?Q[i]:tt[i]:Y[i];this.domain=G(n)}},t.prototype.setDomain=function(t){this.customDomain=!0,this.domain=t},t.prototype.getDomain=function(t){return this.customDomain||t&&this.initDomain(t),this.domain},t.prototype.initABData=function(){var t="__tea_sdk_ab_version_"+this.initConfig.app_id,e=null;if(this.initConfig.ab_cross){var i=this.localStorage.getCookie(t,this.initConfig.ab_cookie_domain);e=i?JSON.parse(i):null}else e=this.localStorage.getItem(t);this.setAbCache(e)},t.prototype.setAbCache=function(t){this.ab_cache=t},t.prototype.getAbCache=function(){return this.ab_cache},t.prototype.clearAbCache=function(){this.ab_cache={},this.ab_version=""},t.prototype.setAbVersion=function(t){this.ab_version=t},t.prototype.getAbVersion=function(){return this.ab_version},t.prototype.setAbUuidCache=function(t,e){var i=e||this.envInfo.user.user_unique_id;this.ab_uuid_cache[""+i]||(this.ab_uuid_cache[""+i]=[]),-1===this.ab_uuid_cache[""+i].indexOf(t)&&this.ab_uuid_cache[""+i].push(t)},t.prototype.getAbUuidCache=function(t){return this.ab_uuid_cache[""+t]},t.prototype.getUrl=function(t){var e="";switch(t){case"event":e=this.channelUrl.REPORT_URL;break;case"webid":e=this.channelUrl.WEBID_URL;break;case"tobid":e=this.channelUrl.TOB_URL}var i="";return this.initConfig.caller&&(i="?sdk_version="+te+"&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+e+i},t.prototype.setCustom=function(t){if(t&&t.latest_data&&t.latest_data.isLast)for(var e in delete t.latest_data.isLast,this.isLast=!0,t.latest_data)this.envInfo.header.custom[e]=t.latest_data[e]},t.prototype.setAppid=function(t){this.envInfo.header.app_id=t},t.prototype.set=function(t){var e=this;Object.keys(t).forEach(function(i){void 0!==t[i]&&null!==t[i]||e.delete(i);try{e.eventCheck.calculate(i,"config")}catch(t){}if("traffic_type"===i&&e.isLast&&(e.envInfo.header.custom.$latest_traffic_source_type=t[i]),"evtParams"===i)e.evtParams=w({},e.evtParams||{},t.evtParams||{});else if("_staging_flag"===i)e.evtParams=w({},e.evtParams||{},{_staging_flag:t._staging_flag});else if("reportErrorCallback"===i&&"function"==typeof t[i])e.reportErrorCallback=t[i];else{var n="",o="";if(i.indexOf(".")>-1){var r=i.split(".");n=r[0],o=r[1]}n?"user"===n||"header"===n?e.envInfo[n][o]=t[i]:e.envInfo.header.custom[o]=t[i]:Object.hasOwnProperty.call(e.envInfo.user,i)?["user_type","ip_addr_id"].indexOf(i)>-1?e.envInfo.user[i]=t[i]?Number(t[i]):t[i]:["user_id","web_id","user_unique_id","user_unique_id_type"].indexOf(i)>-1?e.envInfo.user[i]=t[i]?String(t[i]):t[i]:["user_is_auth","user_is_login"].indexOf(i)>-1?e.envInfo.user[i]=!!t[i]:"device_id"===i&&(e.envInfo.user[i]=t[i]):Object.hasOwnProperty.call(e.envInfo.header,i)?e.envInfo.header[i]=t[i]:e.envInfo.header.custom[i]=t[i]}})},t.prototype.get=function(t){try{return t?"evtParams"===t?this.evtParams:"reportErrorCallback"===t?this[t]:Object.hasOwnProperty.call(this.envInfo.user,t)?this.envInfo.user[t]:Object.hasOwnProperty.call(this.envInfo.header,t)?this.envInfo.header[t]:JSON.parse(JSON.stringify(this.envInfo[t])):JSON.parse(JSON.stringify(this.envInfo))}catch(t){this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.setStore=function(t){try{if(!this.configPersist)return;var e=this.storage.getItem(this.configKey)||{};if(e&&Object.keys(t).length){var i=Object.assign(t,e);this.storage.setItem(this.configKey,i)}}catch(t){this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.getStore=function(){try{if(!this.configPersist)return null;var t=this.storage.getItem(this.configKey)||{};return t&&Object.keys(t).length?t:null}catch(t){return this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message}),null}},t.prototype.delete=function(t){try{if(!this.configPersist)return;var e=this.storage.getItem(this.configKey)||{};e&&Object.hasOwnProperty.call(e,t)&&(delete e[t],this.storage.setItem(this.configKey,e))}catch(t){this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t}(),tu=function(){function t(t,e){this.isLog=e||!1,this.name=t||""}return t.prototype.info=function(t){this.isLog},t.prototype.warn=function(t){this.isLog},t.prototype.error=function(t){this.isLog},t.prototype.throw=function(t){throw this.error(this.name),Error(t)},t}(),tl=function(){function t(){this.spiderBot=["Baiduspider","googlebot","360Spider","haosouspider","YoudaoBot","Sogou News Spider","Yisouspider","Googlebot","Headless","Applebot","Bingbot","PetalBot"]}return t.prototype.checkSpider=function(t){if(!t.enable_spider)return!1;var e=window.navigator.userAgent;if(!e)return!0;var i=!1;return this.spiderBot.forEach(function(t){-1!==e.indexOf(t)&&(i=!0)}),i},t}(),th=function(){function t(t,e){this.collect=t,this.native=e}var e=t.prototype;return e.bridgeInject=function(){try{return!!this.native&&!!AppLogBridge}catch(t){return!1}},e.bridgeReady=function(){var t=this;return new Promise(function(e,i){try{t.bridgeInject()?AppLogBridge.hasStarted(function(t){t?e(!0):i(!1)}):i(!1)}catch(t){i(!1)}})},e.setNativeAppId=function(t){try{AppLogBridge.setNativeAppId(JSON.stringify(t))}catch(t){}},e.setConfig=function(t){var e=this;try{Object.keys(t).forEach(function(i){"user_unique_id"===i?e.setUserUniqueId(t[i]):t[i]?e.addHeaderInfo(i,t[i]):e.removeHeaderInfo(i)})}catch(t){}},e.setUserUniqueId=function(t){try{AppLogBridge.setUserUniqueId(t)}catch(t){}},e.addHeaderInfo=function(t,e){try{AppLogBridge.addHeaderInfo(t,e)}catch(t){}},e.setHeaderInfo=function(t){try{AppLogBridge.setHeaderInfo(JSON.stringify(t))}catch(t){}},e.removeHeaderInfo=function(t){try{AppLogBridge.removeHeaderInfo(t)}catch(t){}},e.reportPv=function(t){this.onEventV3("predefine_pageview",t)},e.onEventV3=function(t,e){try{AppLogBridge.onEventV3(t,e),this.collect.emit(DebuggerMesssge.DEBUGGER_MESSAGE,{type:DebuggerMesssge.DEBUGGER_MESSAGE_EVENT,info:"bridge\u57CB\u70B9\u4E0A\u62A5",time:Date.now(),data:[{events:[{event:t,params:e}]}],code:200,status:"success"})}catch(t){}},e.profileSet=function(t){try{AppLogBridge.profileSet(t)}catch(t){}},e.profileSetOnce=function(t){try{AppLogBridge.profileSetOnce(t)}catch(t){}},e.profileIncrement=function(t){try{AppLogBridge.profileIncrement(t)}catch(t){}},e.profileUnset=function(t){try{AppLogBridge.profileUnset(t)}catch(t){}},e.profileAppend=function(t){try{AppLogBridge.profileAppend(t)}catch(t){}},t}(),tp=function(){function t(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return t.prototype.apply=function(t,e){var i=this;this.collect=t,this.config=e,this.configManager=t.configManager,this.eventCheck=new ti(t,e),this.cacheStorgae=new F(!0),this.localStorage=new F(!1),this.maxReport=e.max_report||10,this.reportTime=e.reportTime||30,this.timeout=e.timeout||1e5,this.enable_ttwebid=e.enable_ttwebid,this.reportUrl=e.report_url||this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.refer_key="__tea_cache_refer_"+this.configManager.get("app_id"),this.collect.on(tn.Ready,function(){i.reportAll(!1)}),this.collect.on(tn.ConfigDomain,function(){i.reportUrl=i.configManager.getUrl("event")}),this.collect.on(tn.Event,function(t){i.event(t)}),this.collect.on(tn.BeconEvent,function(t){i.beconEvent(t)}),this.collect.on(tn.CleanEvents,function(){i.reportAll(!1)}),this.linster()},t.prototype.linster=function(){var t=this;window.addEventListener("unload",function(){t.reportAll(!0)},!1),I(function(){t.reportAll(!0)}),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&t.reportAll(!0)},!1)},t.prototype.reportAll=function(t){this.report(t),this.reportBecon()},t.prototype.event=function(t){var e=this;try{var i=A(t,this.cacheStorgae.getItem(this.eventKey)||[]);if(this.cacheStorgae.setItem(this.eventKey,i),this.reportTimeout&&clearTimeout(this.reportTimeout),i.length>=this.maxReport)this.report(!1);else{var n=this.reportTime;this.reportTimeout=setTimeout(function(){e.report(!1),e.reportTimeout=null},n)}}catch(t){this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.beconEvent=function(t){var e=A(t,this.cacheStorgae.getItem(this.beconKey)||[]);this.cacheStorgae.setItem(this.beconKey,e),this.collect.destroy||this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))},t.prototype.reportBecon=function(){if(!this.collect.destroy&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var t=this.cacheStorgae.getItem(this.beconKey)||[];t&&t.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(t)),!0))}},t.prototype.report=function(t){if(!this.collect.destroy&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var e=this.cacheStorgae.getItem(this.eventKey)||[];e.length&&(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(e,t))}},t.prototype.sliceEvent=function(t,e){if(t.length>this.eventLimit)for(var i=0;i<t.length;i+=this.eventLimit){n=t.slice(i,i+this.eventLimit);var n,o=this.split(this.merge(n));this.send(o,e)}else o=this.split(this.merge(t)),this.send(o,e)},t.prototype.handleRefer=function(){var t="";try{if(this.config.spa||this.config.autotrack){var e=this.localStorage.getItem(this.refer_key)||{};t=e.routeChange?e.refer_key:this.configManager.get("referrer")}else t=this.configManager.get("referrer")}catch(e){t=document.referrer}return t},t.prototype.merge=function(t,e){var i=this,n=this.configManager.get(),o=n.header,r=n.user;o.custom=JSON.stringify(o.custom),o.referrer=this.handleRefer();var a=this.configManager.get("evtParams"),s=this.configManager.get("user_unique_id_type"),c=JSON.parse(JSON.stringify({events:t.map(function(t){try{Object.keys(a).length&&!e&&(t.params=w({},a,t.params)),s&&(t.params.$user_unique_id_type=s);var n=i.configManager.getAbCache(),o=i.configManager.getAbUuidCache(r.user_unique_id);if(n&&n.uuid&&n.uuid===r.user_unique_id){var c=i.configManager.getAbVersion();if(i.config.enable_ab_uuid){if(o&&o.length){var u=o.join(",");c&&c.includes(u)&&(t.ab_sdk_version=c)}}else c&&(t.ab_sdk_version=c)}return t.session_id=i.collect.sessionManager.getSessionId(),t.params=JSON.stringify(t.params),t}catch(e){return i.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message}),t}}),user:r,header:o}));c.local_time=Math.floor(Date.now()/1e3),c.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,c.verbose=1;var u=[];return u.push(c),u},t.prototype.split=function(t){return t=t.map(function(t){var e=[];return e.push(t),e})},t.prototype.send=function(t,e){var i=this;t.length&&(this.config.disable_track_event||t.forEach(function(t){try{var n=JSON.parse(JSON.stringify(t));i.config.filter&&(n=i.config.filter(n)),i.collect.eventFilter&&n&&(n=i.collect.eventFilter(n));var o=n||t,r=JSON.parse(JSON.stringify(o));if(i.eventCheck.checkVerify(r),!o.length)return;i.collect.emit(tn.SubmitBefore,o),i.collect.emit(tn.SubmitVerify,o),i.collect.requestManager.useRequest({url:i.reportUrl,data:o,success:function(t,e){t&&0!==t.e?(i.collect.emit(tn.SubmitError,{type:"f_data",eventData:e,errorCode:t.e,response:t}),i.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u5931\u8D25",time:Date.now(),data:r,code:t.e,failType:"\u6570\u636E\u5F02\u5E38\u5931\u8D25",status:"fail"})):(i.collect.emit(tn.SubmitScuess,{eventData:e,res:t}),i.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u6210\u529F",time:Date.now(),data:r,code:200,status:"success"}))},fail:function(t,e){i.configManager.get("reportErrorCallback")(t,e),i.collect.emit(tn.SubmitError,{type:"f_net",eventData:t,errorCode:e}),i.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u7F51\u7EDC\u5F02\u5E38",time:Date.now(),data:r,code:e,failType:"\u7F51\u7EDC\u5F02\u5E38\u5931\u8D25",status:"fail"})},timeout:i.timeout,useBeacon:!i.config.disable_sendbeacon&&e,withCredentials:i.enable_ttwebid}),i.collect.emit(tn.SubmitAfter,o)}catch(t){i.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}}))},t}(),tf=function(){return(function t(e){return e?(e^16*Math.random()>>e/4).toString(10):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,t)})().replace(/-/g,"").slice(0,19)},td=function(){function t(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return t.prototype.apply=function(t,e){var i=this;this.collect=t,this.config=e,this.configManager=this.collect.configManager,this.storage=new F(!1),this.tokenKey="__tea_cache_tokens_"+e.app_id,this.enable_ttwebid=e.enable_ttwebid,this.enableCustomWebid=e.enable_custom_webid,this.collect.on(tn.ConfigUuid,function(t){i.setUuid(t)}),this.collect.on(tn.ConfigWebId,function(t){i.setWebId(t)}),this.enableCookie=e.cross_subdomain,this.expiresTime=e.cookie_expire||6048e5,this.cookieDomain=e.cookie_domain||"",this.checkStorage()},t.prototype.checkStorage=function(){var t=this;if(this.enableCookie){var e=this.storage.getCookie(this.tokenKey,this.cookieDomain);this.cacheToken=e&&"string"==typeof e?JSON.parse(e):{}}else this.cacheToken=this.storage.getItem(this.tokenKey)||{};this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid?this.enableCustomWebid?this.collect.on(tn.CustomWebId,function(){t.tokenReady=!0,t.collect.emit(tn.TokenComplete)}):this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},t.prototype.check=function(){this.cacheToken&&this.cacheToken.web_id?this.complete(this.cacheToken):this.config.disable_webid?this.complete({web_id:tf(),user_unique_id:this.configManager.get("user_unique_id")||tf()}):this.remoteWebid()},t.prototype.checkEnv=function(){var t=window.navigator.userAgent;if(-1!==t.indexOf("miniProgram")||-1!==t.indexOf("MiniProgram")){var e=L(window.location.href);return!(!e||!e.Web_ID)&&(this.complete({web_id:""+e.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+e.Web_ID}),!0)}return!1},t.prototype.remoteWebid=function(){var t=this,e=this.configManager.getUrl("webid"),i={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""};this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u53D1\u8D77WEBID\u8BF7\u6C42",logType:"fetch",level:"info",time:Date.now(),data:i});var n=tf();this.collect.requestManager.useRequest({url:e,data:i,success:function(e){var i;e&&0===e.e?(i=e.web_id,t.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8BF7\u6C42\u6210\u529F",logType:"fetch",level:"info",time:Date.now(),data:e})):(i=n,t.collect.configManager.set({localWebId:n}),t.collect.emit(tn.TokenError),t.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8BF7\u6C42\u8FD4\u56DE\u503C\u5F02\u5E38",logType:"fetch",level:"warn",time:Date.now(),data:e}),t.collect.logger.warn("appid: "+t.config.app_id+" get webid error, use local webid~")),t.complete({web_id:t.configManager.get("web_id")||i,user_unique_id:t.configManager.get("user_unique_id")||i})},fail:function(){t.complete({web_id:t.configManager.get("web_id")||n,user_unique_id:t.configManager.get("user_unique_id")||n}),t.collect.configManager.set({localWebId:n}),t.collect.emit(tn.TokenError),t.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8BF7\u6C42\u7F51\u7EDC\u5F02\u5E38",logType:"fetch",level:"error",time:Date.now(),data:null}),t.collect.logger.warn("appid: "+t.config.app_id+", get webid error, use local webid~")},timeout:3e5})},t.prototype.complete=function(t){var e=t.web_id,i=t.user_unique_id;t.timestamp=Date.now(),this.collect.configManager.set({web_id:e,user_unique_id:i}),this.setStorage(t),this.tokenReady=!0,this.collect.emit(tn.TokenComplete)},t.prototype.completeTtWid=function(t){var e=t.user_unique_id||"",i=this.configManager.get("user_unique_id");(i||e)&&this.configManager.set({user_unique_id:i||e}),this.setStorage(t),this.tokenReady=!0,this.collect.emit(tn.TokenComplete)},t.prototype.setUuid=function(t){if(t&&-1===["null","undefined","Null","None"].indexOf(t)){var e=String(t),i=this.configManager.get("user_unique_id"),n=this.cacheToken&&this.cacheToken.user_unique_id;(e!==i||e!==n)&&(this.configManager.set({user_unique_id:e}),this.cacheToken||(this.cacheToken={}),this.cacheToken.user_unique_id=e,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(tn.TokenChange,"uuid"),this.collect.emit(tn.SessionReset))}else this.clearUuid()},t.prototype.clearUuid=function(){this.config.enable_ttwebid||this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(tn.TokenReset))},t.prototype.setWebId=function(t){if(t&&!this.config.enable_ttwebid){this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==t&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?t:this.cacheToken.user_unique_id,this.cacheToken.web_id=t):(this.cacheToken={},this.cacheToken.web_id=t,this.cacheToken.user_unique_id=t),this.cacheToken.timestamp=Date.now();var e=this.configManager.get("web_id"),i=this.configManager.get("user_unique_id");i&&i!==e||(this.configManager.set({user_unique_id:t}),this.collect.emit(tn.TokenChange,"uuid")),e!==t&&(this.configManager.set({web_id:t}),this.collect.emit(tn.TokenChange,"webid")),this.setStorage(this.cacheToken)}},t.prototype.setStorage=function(t){t._type_=this.enableCustomWebid?"custom":"default",delete t["diss".split("").reverse().join("")],this.enableCookie||this.enable_ttwebid?(this.storage.setCookie(this.tokenKey,t,this.expiresTime,this.cookieDomain),this.enable_ttwebid&&(delete t.web_id,this.storage.setItem(this.tokenKey,t))):this.storage.setItem(this.tokenKey,t),this.cacheToken=t},t.prototype.getReady=function(){return this.tokenReady},t.prototype.getTobId=function(){var t=this;return new Promise(function(e){"tcpy"!==t.config.channel_type&&"ttp"!==t.config.channel_type?t.collect.requestManager.useRequest({url:t.configManager.getUrl("tobid"),data:{app_id:t.config.app_id,user_unique_id:t.configManager.get("user_unique_id"),web_id:t.configManager.get("web_id"),user_unique_id_type:t.configManager.get("user_unique_id_type")},success:function(t){t&&0===t.e?e(t.tobid):e("")},fail:function(){e("")},time:3e4,withCredentials:t.enable_ttwebid}):e("")})},t}(),tg=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},t_=function(){function t(){}return t.prototype.apply=function(t,e){var i=this;this.collect=t,this.storage=new F(!1,"session"),this.sessionKey="__tea_session_id_"+e.app_id,this.expireTime=e.expireTime||18e5,this.disableSession=e.disable_session,this.disableSession||(this.setSessionId(),this.collect.on(tn.SessionReset,function(){i.resetSessionId()}),this.collect.on(tn.SessionResetTime,function(){i.updateSessionIdTime()}))},t.prototype.updateSessionIdTime=function(){var t=this.storage.getItem(this.sessionKey);if(t&&t.sessionId){var e=t.timestamp;Date.now()-e>this.expireTime?t={sessionId:tg(),timestamp:Date.now()}:t.timestamp=Date.now(),this.storage.setItem(this.sessionKey,t),this.resetExpTime()}},t.prototype.setSessionId=function(){var t=this,e=this.storage.getItem(this.sessionKey);e&&e.sessionId?e.timestamp=Date.now():e={sessionId:tg(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e),this.sessionExp=setInterval(function(){t.checkEXp()},this.expireTime)},t.prototype.getSessionId=function(){var t=this.storage.getItem(this.sessionKey);return this.disableSession?"":t&&t.sessionId?t.sessionId:""},t.prototype.resetExpTime=function(){var t=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval(function(){t.checkEXp()},this.expireTime))},t.prototype.resetSessionId=function(){var t={sessionId:tg(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,t)},t.prototype.checkEXp=function(){var t=this.storage.getItem(this.sessionKey);t&&t.sessionId&&Date.now()-t.timestamp+30>=this.expireTime&&(t={sessionId:tg(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t))},t}(),tm={XHR_ON:500,TIMEOUT:5005},tv=function(t,e,i,n){try{var o=t.match(/\/v\d\//),r="";r=o?o[0]:-1!==t.indexOf("/v1/")?"/v1/":"/v2/";var a=t.split(r)[0];if(!a)return void n(t,e,4001);e.forEach(function(o){var r=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&void 0!==t[i]&&(e+="&"+i+"="+encodeURIComponent(JSON.stringify(t[i])));return e="&"===e[0]?e.slice(1):e}(o),s=new Image(1,1);s.onload=function(){s=null,i&&i()},s.onerror=function(){s=null,n&&n(t,e,4e3)},s.src=a+"/gif?"+r})}catch(i){n&&n(t,e,4002,i.message)}},ty=function(t,e,i,n,o,r,a,s){var c=window.navigator.userAgent;if(-1===window.navigator.appName.indexOf("Microsoft Internet Explorer")||-1===c.indexOf("MSIE 8.0")&&-1===c.indexOf("MSIE 9.0")){if(a)return window.navigator&&window.navigator.sendBeacon?void(window.navigator.sendBeacon(t,JSON.stringify(e))?o():r(t,e,4003)):void tv(t,e,o,r)}else tv(t,e,o,r);!function(t,e,i,n,o,r,a,s,c){try{var u=new XMLHttpRequest;u.open("POST",""+t,!0),u.setRequestHeader("Content-Type","application/json; charset=utf-8"),a&&u.setRequestHeader("X-MCS-AppKey",""+a),n&&(u.withCredentials=!0),u.onload=function(){if(o){var t=null;if(u.responseText){try{t=JSON.parse(u.responseText)}catch(e){t={}}o(t,e)}}},i&&(u.timeout=i,u.ontimeout=function(){r&&r(e,tm.TIMEOUT)}),u.onerror=function(){u.abort(),r&&r(e,tm.XHR_ON)},c?u.send(e):u.send(JSON.stringify(e))}catch(t){}}(t,e,i,n,o,r,"","",s)},tb=function(){function t(t,e){this.collector=t,this.config=e,this.requestType=e.request_type||"xhr",this.supportBeacon=!(!window.navigator||!window.navigator.sendBeacon),this.errorCode={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005}}return t.prototype.useFetch=function(t){var e=t.url,i=t.data,n=t.method,o=t.success,r=t.fail;window.fetch?fetch(e,{method:n||"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(i)}).then(function(t){return t.json()}).then(function(t){o&&o(t)}).catch(function(t){r&&r(i,t)}):(this.requestType="xhr",this.useRequest({url:e,data:i,method:n,success:o,fail:r}))},t.prototype.useBeacon=function(t){var e=t.url,i=t.data,n=t.success,o=t.fail;window.navigator.sendBeacon(e,JSON.stringify(i))?n&&n():o&&o(i,this.errorCode.BEACON_FALSE)},t.prototype.useRequest=function(t){var e=this,i=t.url,n=t.data,o=t.method,r=t.success,a=t.fail,s=t.timeout,c=t.useBeacon,u=t.withCredentials,l=t.app_key,h=t.forceXhr;if(c&&this.supportBeacon)this.useBeacon({url:i,data:n,method:o,success:r,fail:a});else if("fetch"!==this.requestType||h)try{var p=new XMLHttpRequest,f=o||"POST";p.open(f,""+i,!0),p.setRequestHeader("Content-Type","application/json; charset=utf-8"),l&&p.setRequestHeader("X-MCS-AppKey",""+l),u&&(p.withCredentials=!0),s&&(p.timeout=s,p.ontimeout=function(){a&&a(n,e.errorCode.TIMEOUT)}),p.onload=function(){if(r){var t=null;if(p.responseText){try{t=JSON.parse(p.responseText)}catch(e){t={}}r(t,n)}}},p.onerror=function(){p.abort(),a&&a(n,e.errorCode.XHR_ON)},p.send(JSON.stringify(n))}catch(t){}else this.useFetch({url:i,data:n,method:o,success:r,fail:a})},t}(),tE=function(){function t(t,e){if(this.devToolReady=!1,this.devToolOrigin="*",this.sendAlready=!1,e.enable_debug){this.collect=t,this.config=e,this.app_id=e.app_id;var i=t.adapters.storage;this.cacheStorgae=new i(!1,"session"),this.filterEvent=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","bav2b_page","bav2b_beat","bav2b_page_statistics","bav2b_click","bav2b_page_exposure","_be_active","predefine_pageview","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append","predefine_page_alive","predefine_page_close","abtest_exposure"],this.load()}}return t.prototype.loadScript=function(t){try{var e=document.createElement("script");e.src=t,e.onerror=function(){},e.onload=function(){},document.getElementsByTagName("body")[0].appendChild(e)}catch(t){}},t.prototype.parseUrl=function(){var t={};try{var e=window.location.href.split("?")[1].split("&");e.length&&e.forEach(function(e){var i=e.split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])})}catch(t){}return t},t.prototype.load=function(){try{var t=this.parseUrl();if(t.open_devtool_web&&t.app_id){if(parseInt(t.app_id)!==this.app_id)return}else if(!this.getStorage())return;this.loadBaseInfo(),this.loadHook(),this.setStorage(),this.addLintener(),this.loadDebuggerModule(),this.loadDevTool()}catch(t){}},t.prototype.getStorage=function(){var t=this.cacheStorgae.getItem("__applog_devtool_web");return t&&parseInt(t)===this.app_id},t.prototype.setStorage=function(){this.cacheStorgae.setItem("__applog_devtool_web",this.app_id)},t.prototype.loadDevTool=function(){this.loadScript("https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/devtool/debug-web.js")},t.prototype.loadBaseInfo=function(){var t=this;this.info=[{title:"\u57FA\u672C\u4FE1\u606F",type:1,infoName:{app_id:this.config.app_id,channel:this.config.channel,\u4E0A\u62A5\u57DF\u540D:this.collect.configManager.getDomain(),SDK\u7248\u672C:te,SDK\u5F15\u5165\u65B9\u5F0F:"npm"}},{title:"\u7528\u6237\u4FE1\u606F",type:2,infoName:{uuid:this.collect.configManager.get("user").user_unique_id||"",web_id:this.collect.configManager.get("user").web_id||"",ssid:"\u70B9\u51FB\u83B7\u53D6SSID"}},{title:"\u516C\u5171\u53C2\u6570\u4FE1\u606F",type:2,infoName:{\u6D4F\u89C8\u5668:this.collect.configManager.get("browser"),\u6D4F\u89C8\u5668\u7248\u672C:this.collect.configManager.get("browser_version"),\u5E73\u53F0:this.collect.configManager.get("platform"),\u8BBE\u5907\u578B\u53F7:this.collect.configManager.get("device_model"),\u64CD\u4F5C\u7CFB\u7EDF:this.collect.configManager.get("os_name"),\u64CD\u4F5C\u7CFB\u7EDF\u7248\u672C:this.collect.configManager.get("os_version"),\u5C4F\u5E55\u5206\u8FA8\u7387:this.collect.configManager.get("os_version"),\u6765\u6E90:this.collect.configManager.get("referrer"),\u81EA\u5B9A\u4E49\u4FE1\u606F:""}},{title:"\u914D\u7F6E\u4FE1\u606F",type:3,infoName:{\u5168\u57CB\u70B9:!!this.config.autotrack,\u505C\u7559\u65F6\u957F:!!this.config.enable_stay_duration}},{title:"A/B\u914D\u7F6E\u4FE1\u606F",type:4,infoName:{"A/B\u5B9E\u9A8C":!!this.config.enable_ab_test}},{title:"\u5BA2\u6237\u7AEF\u4FE1\u606F",type:3,infoName:{\u6253\u901A\u5F00\u5173:!!this.config.Native}}],this.log=[],this.event=[],this.collect.on(tn.Ready,function(){t.info[1].infoName.uuid=t.collect.configManager.get("user").user_unique_id,t.info[1].infoName.web_id=t.collect.configManager.get("user").web_id,t.info[2].infoName["\u81EA\u5B9A\u4E49\u4FE1\u606F"]=JSON.stringify(t.collect.configManager.get("custom")),t.config.enable_ab_test&&(t.info[4].infoName["\u5DF2\u66DD\u5149VID"]=t.collect.configManager.getAbVersion(),t.info[4].infoName["A/B\u57DF\u540D"]=t.config.ab_channel_domain||G(Z[t.config.channel]),t.info[4].infoName["\u5168\u90E8\u914D\u7F6E"]=t.collect.configManager.getAbData()),t.config.Native&&(t.info[5].infoName["\u662F\u5426\u6253\u901A"]=!!t.collect.bridgeReport)})},t.prototype.loadHook=function(){var t=this;this.collect.on(H.DEBUGGER_MESSAGE,function(e){switch(e.type){case H.DEBUGGER_MESSAGE_SDK:var i={time:e.time,type:e.logType||"sdk",level:e.level,name:e.info,show:!0,levelShow:!0,needDesc:!!e.data};return e.data&&(i.desc={content:JSON.stringify(e.data)}),t.updateLog(i),e.secType&&"AB"===e.secType?(t.info[4].infoName["\u5DF2\u66DD\u5149VID"]=t.collect.configManager.getAbVersion(),t.info[4].infoName["\u5168\u90E8\u914D\u7F6E"]=t.collect.configManager.getAbData()):"USER"===e.secType&&(t.info[1].infoName.uuid=t.collect.configManager.get("user").user_unique_id,t.info[1].infoName.web_id=t.collect.configManager.get("user").web_id),void t.updateInfo();case H.DEBUGGER_MESSAGE_EVENT:if(e.data&&e.data.length){var n=e.data[0],o=n.events;if(!o.length)return;o.forEach(function(i){i.checkShow=!0,i.searchShow=!0,i.success=e.status,i.type=-1!==t.filterEvent.indexOf(i.event)?"sdk":"cus",i.type=t.collect.bridgeReport?"bridge":i.type,i.info="","fail"===e.status&&(i.info={message:"code: "+e.code+"\uFF0C msg: "+e.failType})}),t.updateEvent(n)}return}})},t.prototype.addLintener=function(){var t=this;window.addEventListener("message",function(e){if(e.origin===location.origin){if(e&&e.data&&"devtool:web:ready"===e.data.type){if(t.devToolOrigin=e.origin,t.devToolReady=!0,t.sendAlready)return;t.sendData("devtool:web:init",{info:t.info,log:t.log,event:t.event}),t.sendAlready=!0}e&&e.data&&"devtool:web:ssid"===e.data.type&&t.collect.getToken(function(e){t.info[1].infoName.ssid=e.tobid,t.updateInfo()})}})},t.prototype.sendData=function(t,e){try{(window.opener||window.parent).postMessage({type:t,payload:e},this.devToolOrigin)}catch(t){}},t.prototype.updateInfo=function(){this.devToolReady&&this.sendData("devtool:web:info",this.info)},t.prototype.updateLog=function(t){this.devToolReady?this.sendData("devtool:web:log",t):this.log.push(t)},t.prototype.updateEvent=function(t){this.devToolReady?this.sendData("devtool:web:event",t):this.event.push(t)},t.prototype.loadDebuggerModule=function(){var t=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");e.appendChild(document.createTextNode("#debugger-applog-web {\n      position: absolute;\n      width: 90px;\n      height: 30px;\n      background: #23c243;\n      border-radius: 6px;\n      color: #fff;\n      font-size: 12px;\n      bottom: 5%;\n      right: 10%;\n      text-align: center;\n      line-height: 30px;\n      cursor: pointer;\n      z-index:100;\n    }")),t.appendChild(e);var i=document.createElement("div");i.innerHTML='<div id="debugger-applog-web" class="debugger-applog-web">AppLog\u8C03\u8BD5</div>';var n=document.createElement("div");n.innerHTML='<div id="debugger-container" class="debugger-container"></div>',document.getElementsByTagName("body")[0].appendChild(i),document.getElementsByTagName("body")[0].appendChild(n),document.getElementById("debugger-applog-web").addEventListener("click",function(){(window.opener||window.parent).postMessage({type:"devtool:web:open-draw"},location.origin)})},t}(),tw={autotrack:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/autotrack.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/autotrack.js"},object:"LogAutoTrack"},ab:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/ab.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/ab.js"},object:"LogAb"},stay:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/stay.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/stay.js"},object:"LogStay"},route:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/route.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/route.js"},object:"LogRoute"},cep:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/cep.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/cep.js"},object:"LogCep"},tracer:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/tracer.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/tracer.js"},object:"LogTracer"},retry:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/retry.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/retry.js"},object:"LogRetry"},visual:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/visual.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/visual.js"},object:"LogVisual"}},tS=["ab","autotrack","Stay","store","et","profile","cep","heartbeat","monitor","route","tracer"],tk=function(){function t(t){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroy=!1,this.sdkReady=!1,this.adapters={},this.loadType="base",this.name=t,this.hook=new O,this.remotePlugin=new Map,this.Types=tn,this.adapters.storage=F,this.loadType="full"}return t.usePlugin=function(e,i,n){if(i){for(var o=!1,r=0,a=t.plugins.length;r<a;r++)if(t.plugins[r].name===i){t.plugins[r].plugin=e,t.plugins[r].options=n||{},o=!0;break}o||t.plugins.push({name:i,plugin:e,options:n})}else t.plugins.push({plugin:e})},t.prototype.usePlugin=function(t,e,i){t&&("full"===this.loadType&&tS.includes(t)||(e?"string"==typeof e?this.remotePlugin.get(t)||this.remotePlugin.set(t,{src:e,call:i}):this.remotePlugin.get(t)||this.remotePlugin.set(t,{instance:e}):this.remotePlugin.get(t)||this.remotePlugin.set(t,"sdk")))},t.prototype.init=function(e){var i,n,o=this;try{i=JSON.parse(JSON.stringify(e))}catch(t){i=e}if(this.logger=new tu(this.name,i.log),this.inited)this.logger.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!");else if(i&&R(i)){if(i.app_id&&"number"==typeof(n=i.app_id)&&!isNaN(n)){if(i.app_key&&"string"!=typeof i.app_key)this.logger.warn("app_key param is error, must be string, please check!");else{var r=i.channel_type&&"tcpy"===i.channel_type?["sg","va","in"]:["sg","va"];i.channel_domain||-1!==r.indexOf(i.channel)||(this.logger.warn("channel must "+r.join(" ,")+"!!!"),i.channel="sg"),this.spider=new tl,this.spider.checkSpider(i)?this.logger.warn("The current environment may be a spider, can not report!"):(this.appBridge=new th(this,i.enable_native),this.requestManager=new tb(this,i),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new tc(this,i),this.debugger=new tE(this,i),this.initConfig=i,this.emit(tn.Init),this.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CINIT",data:i,level:"info",time:Date.now()}),i.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport||(this.configManager.setAppid(i.app_id),this.eventManager=new tp,this.tokenManager=new td,this.sessionManager=new t_,Promise.all([new Promise(function(t){o.once(tn.TokenComplete,function(){t(!0)})}),new Promise(function(t){o.once(tn.Start,function(){t(!0)})})]).then(function(){try{t.plugins.reduce(function(t,e){var i=e.plugin,n=e.options,r=Object.assign(o.initConfig,n),a=new i;return a.apply(o,r),t.push(a),t},o.pluginInstances)}catch(t){o.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}o.sdkReady=!0,o.emit(tn.Ready),o.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u521D\u59CB\u5316\u5B8C\u6210",time:Date.now(),level:"info",data:o.configManager.get("user")}),o.logger.info("appid: "+i.app_id+", userInfo:"+JSON.stringify(o.configManager.get("user"))),o.logger.info("appid: "+i.app_id+", sdk is ready, version is "+te+", you can report now !!!"),i.disable_auto_pv&&(o.disableAutoPageView=!0);try{("full"===o.loadType&&i.enable_ab_test||i.autotrack)&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(t){o.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}o.pageView(),o.on(tn.TokenChange,function(t){"webid"===t&&o.pageView(),o.logger.info("appid: "+i.app_id+" token change, new userInfo:"+JSON.stringify(o.configManager.get("user"))),o.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u8BBE\u7F6E\u4E86\u7528\u6237\u4FE1\u606F",time:Date.now(),secType:"USER",level:"info",data:o.configManager.get("user")})}),o.on(tn.TokenReset,function(){o.logger.info("appid: "+i.app_id+" token reset, new userInfo:"+JSON.stringify(o.configManager.get("user"))),o.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u91CD\u7F6E\u4E86\u7528\u6237\u4FE1\u606F",time:Date.now(),secType:"USER",level:"info",data:o.configManager.get("user")})}),o.on(tn.RouteChange,function(t){t.init||i.disable_route_report||o.pageView()})}),this.tokenManager.apply(this,i),this.eventManager.apply(this,i),this.sessionManager.apply(this,i)),this.inited=!0)}}else this.logger.warn("app_id param is error, must be number, please check!")}else this.logger.warn("init params error,please check")},t.prototype.config=function(t){if(this.inited){if(t&&R(t)){var e;try{e=JSON.parse(JSON.stringify(e))}catch(i){e=t}if(this.bridgeReport)this.appBridge.setConfig(e);else{e._staging_flag&&1===e._staging_flag&&(this.staging=!0),e.disable_auto_pv&&(this.disableAutoPageView=!0,delete e.disable_auto_pv);var i=w({},e);if(this.initConfig&&this.initConfig.configPersist){var n=this.configManager.getStore();n&&(i=Object.assign(n,e)),this.configManager.setStore(e)}i.web_id,i.user_unique_id;var o=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)0>e.indexOf(n[o])&&(i[n[o]]=t[n[o]])}return i}(i,["web_id","user_unique_id"]);i.hasOwnProperty("web_id")&&this.emit(tn.ConfigWebId,i.web_id),i.hasOwnProperty("user_unique_id")&&this.emit(tn.ConfigUuid,i.user_unique_id),this.configManager.set(o),this.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CCONFIG",level:"info",time:Date.now(),data:i})}}else this.logger.warn("config params is error, please check")}else this.logger.warn("config must be use after function init")},t.prototype.setDomain=function(t){this.configManager&&this.configManager.setDomain(t),this.emit(tn.ConfigDomain)},t.prototype.getConfig=function(t){return this.configManager.get(t)},t.prototype.send=function(){this.start()},t.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.emit(tn.Start),this.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CSTART",level:"info",time:Date.now()}),this.bridgeReport&&(this.pageView(),this.emit(tn.Ready)))},t.prototype.event=function(t,e){var i=this;try{var n=[];if(Array.isArray(t))t.forEach(function(t){var e=i.processEvent(t[0],t[1]||{});e&&n.push(e)});else{var o=this.processEvent(t,e);if(!o)return;n.push(o)}this.bridgeReport?n.forEach(function(t){var e=t.event,n=t.params;i.appBridge.onEventV3(e,JSON.stringify(n))}):n.length&&(this.emit(tn.Event,n),this.emit(tn.SessionResetTime))}catch(t){this.logger.warn("something error, please check"),this.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.beconEvent=function(t,e){if(Array.isArray(t))this.logger.warn("beconEvent not support batch report, please check");else{var i=[],n=this.processEvent(t,e||{});n&&(i.push(n),i.length&&(this.emit(tn.BeconEvent,i),this.emit(tn.SessionResetTime)))}},t.prototype.processEvent=function(t,e){void 0===e&&(e={});try{if(!t)return this.logger.warn("eventName is null\uFF0C please check"),null;var i=t;/^event\./.test(t)&&(i=t.slice(6));var n=e;"object"!=typeof n&&(n={}),n.profile?delete n.profile:n.event_index=C();var o=void 0;return n.local_ms?(o=n.local_ms,delete n.local_ms):o=+new Date,{event:i,params:n,local_time_ms:o,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}}catch(i){return this.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:i.message}),{event:t,params:e}}},t.prototype.filterEvent=function(t){this.eventFilter=t},t.prototype.on=function(t,e){this.hook.on(t,e)},t.prototype.once=function(t,e){this.hook.once(t,e)},t.prototype.off=function(t,e){this.hook.off(t,e)},t.prototype.emit=function(t,e,i){this.hook.emit(t,e,i)},t.prototype.set=function(t){this.hook.set(t)},t.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},t.prototype.predefinePageView=function(t){if(void 0===t&&(t={}),this.inited){var e={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+(this.configManager&&this.configManager.is_first_time||!1)},i=w({},e,t);this.event("predefine_pageview",i)}else this.logger.warn("predefinePageView should call after init")},t.prototype.clearEventCache=function(){this.emit(tn.CleanEvents)},t.prototype.setWebIDviaUnionID=function(t){if(t){var e=B(t);this.config({web_id:""+e,wechat_unionid:t}),this.emit(tn.CustomWebId)}},t.prototype.setWebId=function(t){this.config({web_id:""+t})},t.prototype.setWebIDviaOpenID=function(t){if(t){var e=B(t);this.config({web_id:""+e,wechat_openid:t}),this.emit(tn.CustomWebId)}},t.prototype.setNativeAppId=function(t){this.bridgeReport&&this.appBridge.setNativeAppId(t)},t.prototype.resetStayDuration=function(t,e,i){this.emit(tn.ResetStay,{url_path:t,title:e,url:i},tn.Stay)},t.prototype.resetStayParams=function(t,e,i){void 0===t&&(t=""),void 0===e&&(e=""),void 0===i&&(i=""),this.emit(tn.SetStay,{url_path:t,title:e,url:i},tn.Stay)},t.prototype.getToken=function(t,e){var i=this;if(this.inited){var n=!1,o=function(e){if(!n){n=!0;var o=i.configManager.get().user;return e&&(o.tobid=e,o["diss".split("").reverse().join("")]=e),t(w({},o))}},r=function(){i.tokenManager.getTobId().then(function(t){o(t)})};this.sdkReady?r():(e&&setTimeout(function(){o()},e),this.on(tn.Ready,function(){r()}))}else this.logger.warn("predefinePageView should call after init")},t.prototype.profileSet=function(t){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(t)):this.emit(tn.ProfileSet,t,tn.Profile),this.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileSet",level:"info",time:Date.now(),data:t})},t.prototype.profileSetOnce=function(t){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(t)):this.emit(tn.ProfileSetOnce,t,tn.Profile),this.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileSetOnce",level:"info",time:Date.now(),data:t})},t.prototype.profileIncrement=function(t){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(t)):this.emit(tn.ProfileIncrement,t,tn.Profile),this.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileIncrement",level:"info",time:Date.now(),data:t})},t.prototype.profileUnset=function(t){this.bridgeReport?this.appBridge.profileUnset(t):this.emit(tn.ProfileUnset,t,tn.Profile),this.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileUnset",level:"info",time:Date.now(),data:t})},t.prototype.profileAppend=function(t){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(t)):this.emit(tn.ProfileAppend,t,tn.Profile),this.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileAppend",level:"info",time:Date.now(),data:t})},t.prototype.setExternalAbVersion=function(t){this.emit(tn.AbExternalVersion,"string"==typeof t&&t?(""+t).trim():null,tn.Ab)},t.prototype.getVar=function(t,e,i,n){this.emit(tn.AbVar,{name:t,defaultValue:e,callback:i,uuid:n},tn.Ab)},t.prototype.getABconfig=function(t,e){this.emit(tn.AbConfig,{params:t,callback:e},tn.Ab)},t.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},t.prototype.onAbSdkVersionChange=function(t){var e=this;return this.emit(tn.AbVersionChangeOn,t,tn.Ab),function(){e.emit(tn.AbVersionChangeOff,t,tn.Ab)}},t.prototype.offAbSdkVersionChange=function(t){this.emit(tn.AbVersionChangeOff,t,tn.Ab)},t.prototype.openOverlayer=function(){this.emit(tn.AbOpenLayer,"",tn.Ab)},t.prototype.closeOverlayer=function(){this.emit(tn.AbCloseLayer,"",tn.Ab)},t.prototype.getAllVars=function(t){this.emit(tn.AbAllVars,t,tn.Ab)},t.prototype.autoInitializationRangers=function(t){var e,i,n,o,r,a,s;e=t.app_id,i=t.channel,n=t.onTokenReady,o=Y[i]+"/webid",r=new F(!1),a="__tea_cache_tokens_"+e,(s=r.getItem(a))&&s.web_id?n(s.web_id):ty(o,{app_key:"",app_id:e,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer},3e3,!1,function(t){if(t&&0===t.e){n(t.web_id);var e={web_id:t.web_id,user_unique_id:t.web_id,timestamp:Date.now()};r.setItem(a,e)}else n("")},function(){n("")},!0)},t.prototype.destoryInstace=function(){this.destroy||(this.destroy=!0,this.off(tn.TokenComplete),this.emit(tn.DestoryInstance))},t.prototype.destroyInstance=function(){this.destroy||(this.destroy=!0,this.off(tn.TokenComplete),this.emit(tn.DestoryInstance))},t.plugins=[],t}(),tA="__rangers_ab_style__",tD={},tT=[],tO=function(t){t.length&&t.forEach(function(t){tT.push(t)})};function tR(t,e,i,n){var o=t&&t.source||window.opener||window.parent,r=t&&t.origin||n||"*";o.postMessage(JSON.stringify({type:e,payload:i}),r)}function tM(t,e){tD[t]=tD[t]||[],tD[t].push(e)}function tC(t){if(tT.some(function(t){return"*"===t})||tT.some(function(e){return t.origin.indexOf(e)>-1})){var e=t.data;if("string"==typeof t.data)try{e=JSON.parse(t.data)}catch(t){e=void 0}if(e){var i=e.type,n=e.payload;tD[i]&&tD[i].forEach(function(e){"function"==typeof e&&e(t,n)})}}}function tG(t,e){var i=w({},t);delete i.filter,(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:i,version:e},"*"),window.addEventListener("message",tC,!1)}var tI="",tx=!1;function tN(t){var e=t.event,i=t.editorUrl;t.collectInstance,t.fromSession,tx||(tx=!0,x(i,function(){tR(e,"abEditorScriptloadSuccess")},function(){e&&tR(e,"abEditorScriptloadError"),tx=!1}))}(eo=er||(er={}))[eo.Var=0]="Var",eo[eo.All=1]="All";var tz=function(){function t(){this.fetchStatus="no",this.refreshFetchStatus="no",this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.enable_multilink=!1,this.enable_ab_visual=!1,this.editMode=!1,this.callbacks=[],this.data={},this.changeListener=new Map,this.readyStatus=!1,this.exposureCache=[]}return t.prototype.apply=function(t,e){var i=this;if(this.collect=t,this.config=e,this.config.enable_ab_test){var n=e.enable_multilink,o=e.ab_channel_domain,r=e.enable_ab_visual,a=e.ab_cross,s=e.ab_cookie_domain,c=e.ab_timeout,u=o||G(Z[e.channel||"sg"]),l=t.adapters.storage;this.cacheStorgae=new l(!1),this.timeout=c||3e3,this.enable_multilink=n,this.enable_ab_visual=r,this.abKey="__tea_sdk_ab_version_"+e.app_id,this.ab_cross=a,this.ab_cookie_domain=s||"",this.fetchUrl=u+"/service/2/abtest_config/",this.reportUrl=this.collect.configManager.getUrl("event"),this.exposureLimit=e.exposure_limit||20,this.ab_batch_time=e.ab_batch_time||500;var h=this.collect.Types;this.types=h,this.collect.on(h.TokenChange,function(t){"uuid"===t&&i.readyStatus&&(i.clearCache(),i.fetchAB())}),this.collect.on(h.AbVar,function(t){var e=t.name,n=t.defaultValue,o=t.callback;i.getVar(e,n,o)}),this.collect.on(h.AbAllVars,function(t){i.getAllVars(t)}),this.collect.on(h.AbConfig,function(t){var e=t.params,n=t.callback;i.getABconfig(e,n)}),this.collect.on(h.AbExternalVersion,function(t){i.setExternalAbVersion(t)}),this.collect.on(h.AbOpenLayer,function(){i.openOverlayer()}),this.collect.on(h.AbCloseLayer,function(){i.closeOverlayer()}),this.collect.on(h.AbVersionChangeOn,function(t){i.changeListener.set(t,t)}),this.collect.on(h.AbVersionChangeOff,function(t){i.changeListener.get(t)&&i.changeListener.delete(t)}),this.loadMode(),(this.enable_ab_visual||this.enable_multilink)&&this.openOverlayer(this.config.multilink_timeout_ms||500),this.checkLocal(),this.ready("ab"),this.readyStatus||(this.fetchAB(),this.readyStatus=!0),this.collect.emit(h.AbReady)}},t.prototype.ready=function(t){var e=this;if(this.collect.set(t),this.collect.hook._hooksCache.hasOwnProperty(t)){var i=this.collect.hook._hooksCache[t];if(!Object.keys(i).length)return;var n=function(t){i[t].length&&i[t].forEach(function(i){e.collect.hook.emit(t,i)})};for(var o in i)n(o)}},t.prototype.loadMode=function(){var t,e,i=function(){try{return JSON.parse(atob(window.name))||void 0}catch(t){return}}(),n="";if(i){var o=i.scenario,r=i.href;o?(this.editMode=!0,n=o):r&&(-1!==r.indexOf("datatester")||-1!==r.indexOf("visual-editor"))&&(this.editMode=!0,n="visual-editor")}this.enable_ab_visual&&(function(t,e){window.TEAVisualEditor=window.TEAVisualEditor||{},tO(["*"]);var i,n="";tG(e,te);var o="";try{var r=window.performance.getEntriesByType("resource");if(r&&r.length&&(r.forEach(function(t){"script"===t.initiatorType&&t.name&&-1!==t.name.indexOf("collect")&&(o=t.name)}),o||document.currentScript&&(o=document.currentScript.src),o&&(i=o.split("/"))&&i.length)){n="https:/";for(var a=2;a<i.length&&a!==i.length-1;a++)n=n+"/"+i[a];n+="/visual-ab-core"}}catch(t){}tM("tea:openVisualABEditor",function(i){var o=i.data;if("string"==typeof i.data)try{o=JSON.parse(i.data)}catch(t){o=void 0}if(o){var r=o.lang;if(o.appId!==e.app_id)return void tR(i,"appIdError");var a=o.version;tI=a&&n?n+(a?"."+a:".1.0.1")+".js?query="+Date.now():"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/visual-ab-core.js?query="+Date.now(),window.TEAVisualEditor.lang=r,window.TEAVisualEditor.__ab_domin=e.channel_domain||"",tN({event:i,editorUrl:tI,collectInstance:t})}})}(this.collect,this.config),"visual-editor"===n)?this.collect.destoryInstace():this.enable_multilink&&(t=this.collect,e=this.config,window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.appId=e.app_id,tM("tea:openTesterEventInspector",function(e){var i=e.data;if("string"==typeof e.data)try{i=JSON.parse(e.data)}catch(t){i=void 0}if(i){var n=i.referrer,o=i.lang,r=i.appId;window.TEAVisualEditor.__editor_ajax_domain=n||"",window.TEAVisualEditor.__ab_appId=r||"",window.TEAVisualEditor.lang=o||"",tN({event:e,editorUrl:"https://lf16-data.bytepluscdn.com/obj/data-static-sg/log-sdk/collect/tester-event-inspector.js?query="+Date.now(),collectInstance:t})}}))},t.prototype.checkLocal=function(){var t=this.getABCache(),e=t.ab_version,i=t.ab_ext_version,n=t.ab_version_multilink,o=(t.data,this.checkFromUrl());o?this.mulilinkVersions.push(o):this.mulilinkVersions=n||[],this.extVersions=i||[],this.versions=e||[];var r=this.versions.concat(this.extVersions);this.enable_multilink&&(r=r.concat(this.mulilinkVersions))},t.prototype.checkFromUrl=function(){var t=L(window.location.href);return t&&t.vid?t.vid:""},t.prototype.updateVersions=function(){var t=this.extVersions.length?this.versions.concat(this.extVersions):this.versions;this.enable_multilink&&(t=t.concat(this.mulilinkVersions)),this.configVersions(t.join(",")),this.updateABCache(),this.changeListener.size>0&&this.changeListener.forEach(function(e){"function"==typeof e&&e(t)})},t.prototype.configVersions=function(t){this.collect.configManager.setAbVersion(t)},t.prototype.getVar=function(t,e,i,n){if(!t)throw Error("variable must not be empty");if(void 0===e)throw Error("variable no default value");if("function"!=typeof i)throw Error("callback must be a function");var o={name:t,defaultValue:e,callback:i,type:er.Var};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealVar(o,t,n):this.callbacks.push(o)},t.prototype.setAbUuid=function(t,e){this.collect.configManager.setAbUuidCache(t,e)},t.prototype.getRealVar=function(t,e,i){var n=t.name,o=t.defaultValue,r=t.callback,a=this.data;if(a){if(R(a[n])){var s=a[n].vid;return"$ab_url"===e?this.mulilinkVersions.includes(s)||this.mulilinkVersions.push(s):this.versions.includes(s)||this.versions.push(s),this.setAbUuid(s,i),this.updateVersions(),this.fechEvent(s,e,o),r(a[n].val),void this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u66DD\u5149\u4E86\u5B9E\u9A8C"+n,level:"info",time:Date.now(),data:a[n]})}this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8C03\u7528getVar",level:"info",time:Date.now(),data:o}),r(o)}else r(o)},t.prototype.getAllVars=function(t){if("function"!=typeof t)throw Error("callback must be a function");var e={callback:t,type:er.All};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealAllVars(e):this.callbacks.push(e)},t.prototype.getRealAllVars=function(t){(0,t.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{}),this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8C03\u7528getAllVars",level:"info",time:Date.now(),data:this.data})},t.prototype.fechEvent=function(t,e,i){try{if(this.config.disable_track_event||!t)return;var n=this.collect.configManager.get(),o=n.header,r=n.user,a=this.getABCache();if(a&&a.uuid&&a.uuid!==r.user_unique_id)return;var s={event:"abtest_exposure",ab_sdk_version:""+t,params:JSON.stringify({app_id:this.config.appId,ab_url:"$ab_url"===e?i:window.location.href,data:this.data}),local_time_ms:Date.now()};o.custom=JSON.stringify(o.custom);this.reportExposure({events:[s],user:r,header:o},e)}catch(t){this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.reportExposure=function(t,e){var i=this;this.exposureCache.push(t),this.reportTimeout&&clearTimeout(this.reportTimeout),this.exposureCache.length>=this.exposureLimit?this.report(e):this.reportTimeout=setTimeout(function(){i.report(e),clearTimeout(i.reportTimeout)},this.ab_batch_time)},t.prototype.report=function(t){var e=this;this.collect.requestManager.useRequest({url:this.reportUrl,data:this.exposureCache,timeout:2e4,useBeacon:"$ab_url"===t}),this.exposureCache.forEach(function(t){e.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u6210\u529F",time:Date.now(),data:[t],code:200,status:"success"})}),this.exposureCache=[]},t.prototype.setExternalAbVersion=function(t){this.extVersions=[t],this.updateVersions()},t.prototype.getABconfig=function(t,e){var i=Object.keys(t);i&&i.length&&this.collect.configManager.set(t),this.fetchAB(e)},t.prototype.get=function(t){if(this.ab_cross){var e=this.cacheStorgae.getCookie(t,this.ab_cookie_domain);return e?JSON.parse(e):{}}return this.cacheStorgae.getItem(t)},t.prototype.set=function(t,e){this.ab_cross?this.cacheStorgae.setCookie(t,e,2592e6,this.ab_cookie_domain):this.cacheStorgae.setItem(t,e),this.collect.configManager.setAbCache(e),this.collect.event("abtest_cache",{env_uuid:this.collect.configManager.get("user").user_unique_id||"",cache:JSON.stringify(e)})},t.prototype.getABCache=function(t){var e={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""};return e=this.get(this.abKey)||e,t?e[t]:e},t.prototype.updateABCache=function(){var t=this.getABCache();t.ab_version_multilink=this.mulilinkVersions,t.ab_ext_version=this.extVersions,t.ab_version=this.versions,t.timestamp=Date.now(),this.set(this.abKey,t)},t.prototype.setAbCache=function(t){var e=this.getABCache();e.data=this.data,e.uuid=t,e.timestamp=Date.now(),this.set(this.abKey,e)},t.prototype.clearCache=function(){this.refreshFetchStatus="ing",this.data={},this.extVersions=[],this.mulilinkVersions=[],this.versions=[],this.collect.configManager.clearAbCache()},t.prototype.openOverlayer=function(t){var e=this;if(function(){if(!document.getElementById(tA)){var t="body { opacity: 0 !important; }",e=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=tA,i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t)),e.appendChild(i)}}(),t)var i=setTimeout(function(){e.closeOverlayer(),clearTimeout(i)},t)},t.prototype.closeOverlayer=function(){var t;(t=document.getElementById(tA))&&t.parentElement.removeChild(t)},t.prototype.fetchComplete=function(t,e){var i=this;try{if(t&&"[object Object]"==Object.prototype.toString.call(t)){this.data=t,this.setAbCache(e);var n=[];Object.keys(t).forEach(function(e){var i=t[e].vid;i&&n.push(i)}),this.versions=this.versions.filter(function(t){return n.includes(t)});var o=t.$ab_url,r=t.$ab_modification;if(r&&r.val&&this.enable_ab_visual){if(this.collect.destroy)return;this.getVar("$ab_modification",window.location.href,function(){var t;t=r.val,window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.__ab_config=t,x("https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/visual-ab-loader.js?query="+Date.now(),function(){},function(){}),i.closeOverlayer()})}else if(o&&this.enable_multilink){this.mulilinkVersions=this.mulilinkVersions.filter(function(t){return n.includes(t)});var a=o.val,s=o.vid;a&&s&&this.getVar("$ab_url",a,function(){i.editMode||(a!==window.location.href?setTimeout(function(){if(!i.collect.destroy){var t=""+a;t=-1===t.indexOf("http")?"https://"+t:t,P(t).host!==location.host?t=t+"&vid="+s:window.history.replaceState("","",t),window.location.href=t}},100):i.closeOverlayer())})}this.updateVersions()}else this.closeOverlayer();this.callbacks.forEach(function(t){return i[t.type===er.Var?"getRealVar":"getRealAllVars"](t,"")}),this.callbacks=[]}catch(t){}},t.prototype.fetchAB=function(t){var e=this,i=this.collect.configManager.get(),n={header:w({aid:this.config.app_id},i.user||{},i.header||{},{ab_sdk_version:this.collect.configManager.getAbVersion(),ab_url:window.location.href})},o=i.user.user_unique_id;this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u53D1\u8D77AB\u5B9E\u9A8C\u8BF7\u6C42",level:"info",logType:"fetch",time:Date.now(),data:n}),this.collect.requestManager.useRequest({url:this.fetchUrl,data:n,success:function(i){e.fetchStatus="complete",e.refreshFetchStatus="complete";var n=i.data;"success"===i.message?(e.fetchComplete(n,o),t&&t(n)):(e.fetchComplete(null,o),t&&t(null)),e.collect.emit(e.types.AbComplete,n),e.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5B9E\u9A8C\u8BF7\u6C42\u6210\u529F",level:"info",logType:"fetch",time:Date.now(),data:n})},fail:function(){e.fetchStatus="complete",e.refreshFetchStatus="complete",e.fetchComplete(null,i.user.user_unique_id),e.collect.emit(e.types.AbTimeout),t&&t(null),e.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5B9E\u9A8C\u8BF7\u6C42\u7F51\u7EDC\u5F02\u5E38",level:"error",logType:"fetch",time:Date.now()})},timeout:this.timeout})},t.prototype.filterUrl=function(t){try{var e="";-1!==t.indexOf("&multilink=true")?e="&multilink=true[\0-\xff]*":-1!==t.indexOf("?multilink=true")&&(e="\\?multilink=true[\0-\xff]*");var i=RegExp(e,"g");t=t.replace(i,"")}catch(t){}return t},t}(),tP=function(){function t(){}return t.prototype.apply=function(t,e){var i=this;if(e.event_verify_url&&"string"==typeof e.event_verify_url&&(this.url=e.event_verify_url+"/v1/list_test",this.url)){var n=t.Types;t.on(n.SubmitBefore,function(e){t.requestManager.useBeacon({url:i.url,data:e})})}},t}(),tL=function(){function t(t,e){this.maxDuration=432e5,this.aliveDTime=6e4,this.options={aliveName:"predefine_page_alive",params:{}},this.collect=t,this.config=e,this.pageStartTime=Date.now(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,R(e.enable_stay_duration)&&(this.options=Object.assign(this.options,e.enable_stay_duration))}return t.prototype.setParams=function(t,e,i){this.set_path=t,this.set_url=i,this.set_title=e},t.prototype.enable=function(t,e,i){this.url_path=t,this.url=i,this.title=e,this.disableCallback=this.enablePageAlive()},t.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},t.prototype.sendEvent=function(t,e){void 0===e&&(e=!1);var i=e?this.aliveDTime:Date.now()-this.sessionStartTime;i<0||i>this.aliveDTime||Date.now()-this.pageStartTime>this.maxDuration||e&&"hidden"===document.visibilityState||(this.collect.beconEvent(this.options.aliveName,w({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),duration:i,is_support_visibility_change:N(),startTime:this.sessionStartTime,hidden:document.visibilityState,leave:t},this.options.params)),this.sessionStartTime=Date.now())},t.prototype.getParams=function(t){switch(t){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},t.prototype.setUpTimer=function(){var t=this;return this.timerHandler&&clearInterval(this.timerHandler),setInterval(function(){Date.now()-t.sessionStartTime>t.aliveDTime&&t.sendEvent(!1,!0)},1e3)},t.prototype.visibilitychange=function(){"hidden"===document.visibilityState?this.timerHandler&&(clearInterval(this.timerHandler),this.sendEvent(!1)):"visible"===document.visibilityState&&(this.sessionStartTime=Date.now(),this.timerHandler=this.setUpTimer())},t.prototype.beforeunload=function(){document.hidden||this.sendEvent(!0)},t.prototype.enablePageAlive=function(){var t=this;this.timerHandler=this.setUpTimer();var e=this.visibilitychange.bind(this),i=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",e),I(i),function(){t.beforeunload(),document.removeEventListener("visibilitychange",e),window.removeEventListener("beforeunload",i),window.removeEventListener("pagehide",i)}},t}(),tB=function(){function t(t,e){var i=this;this.maxDuration=432e5,this.aliveDTime=6e4,this.options={closeName:"predefine_page_close",params:{}},this.visibilitychange=function(){"hidden"===document.visibilityState?i.activeEndTime=Date.now():"visible"===document.visibilityState&&(i.activeEndTime&&(i.totalTime+=i.activeEndTime-i.activeStartTime,i.activeTimes+=1),i.activeEndTime=void 0,i.activeStartTime=Date.now())},this.beforeunload=function(){if(i.totalTime+=(i.activeEndTime||Date.now())-i.activeStartTime,i.config.autotrack)try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:i.totalTime,page_title:document.title||location.pathname}))}catch(t){}i.sendEventPageClose()},this.collect=t,this.config=e,this.maxDuration=e.maxDuration||864e5,this.pageStartTime=Date.now(),R(e.enable_stay_duration)&&(this.options=Object.assign(this.options,e.enable_stay_duration)),this.resetData()}return t.prototype.setParams=function(t,e,i){this.set_path=t,this.set_url=i,this.set_title=e},t.prototype.resetParams=function(t,e,i){this.url_path=t,this.url=i,this.title=e},t.prototype.enable=function(t,e,i){this.url_path=t,this.url=i,this.title=e,this.disableCallback=this.enablePageClose()},t.prototype.disable=function(){this.disableCallback()},t.prototype.resetData=function(){this.activeStartTime=void 0===this.activeStartTime?this.pageStartTime:Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0,this.resetParams(location.pathname,document.title,location.href)},t.prototype.sendEventPageClose=function(){var t=Date.now()-this.pageStartTime;this.totalTime<0||t<0||this.totalTime>=this.maxDuration||(this.collect.beconEvent(this.options.closeName,w({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),active_times:this.activeTimes,duration:this.totalTime,total_duration:t,is_support_visibility_change:N()},this.options.params)),this.pageStartTime=Date.now(),this.resetData())},t.prototype.getParams=function(t){switch(t){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},t.prototype.enablePageClose=function(){var t=this,e=this.visibilitychange.bind(this),i=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",e),I(i),function(){t.beforeunload(),document.removeEventListener("visibilitychange",e),window.removeEventListener("beforeunload",i),window.removeEventListener("pagehide",i)}},t}(),tU=function(){function t(){}return t.prototype.apply=function(t,e){var i=this;if(this.collect=t,this.config=e,this.config.enable_stay_duration){this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this.pageAlive=new tL(t,e),this.pageClose=new tB(t,e);var n=this.collect.Types;this.collect.on(n.ResetStay,function(t){var e=t.url_path,n=t.title,o=t.url;i.resetStayDuration(e,n,o)}),this.collect.on(n.RouteChange,function(t){t.init||e.disable_route_report||i.resetStayDuration()}),this.collect.on(n.SetStay,function(t){var e=t.url_path,n=t.title,o=t.url;i.setStayParmas(e,n,o)}),this.enable(this.url_path,this.title,this.url),this.ready(n.Stay),this.collect.emit(n.StayReady)}},t.prototype.ready=function(t){var e=this;if(this.collect.set(t),this.collect.hook._hooksCache.hasOwnProperty(t)){var i=this.collect.hook._hooksCache[t];if(!Object.keys(i).length)return;var n=function(t){i[t].length&&i[t].forEach(function(i){e.collect.hook.emit(t,i)})};for(var o in i)n(o)}},t.prototype.enable=function(t,e,i){this.pageAlive.enable(t,e,i),this.pageClose.enable(t,e,i)},t.prototype.disable=function(){this.pageAlive.disable(),this.pageClose.disable()},t.prototype.setStayParmas=function(t,e,i){void 0===t&&(t=""),void 0===e&&(e=""),void 0===i&&(i=""),this.pageAlive.setParams(t,e,i),this.pageClose.setParams(t,e,i),this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884C resetStayParams",level:"info",time:Date.now(),data:{url_path:t,title:e,url:i}})},t.prototype.reset=function(t,e,i){this.disable(),this.enable(t,e,i)},t.prototype.resetStayDuration=function(t,e,i){this.reset(t,e,i),this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884C resetStayDuration",level:"info",time:Date.now(),data:{url_path:t,title:e,url:i}})},t}(),tV=function(){function t(){}return t.prototype.apply=function(t,e){var i=this;this.collect=t,this.config=e,this.duration=6e4,this.reportUrl=t.configManager.getDomain()+"/profile/list";var n=t.Types;this.eventCheck=new ti(t,e),this.cache={},this.collect.on(n.ProfileSet,function(t){i.setProfile(t)}),this.collect.on(n.ProfileSetOnce,function(t){i.setOnceProfile(t)}),this.collect.on(n.ProfileUnset,function(t){i.unsetProfile(t)}),this.collect.on(n.ProfileIncrement,function(t){i.incrementProfile(t)}),this.collect.on(n.ProfileAppend,function(t){i.appendProfile(t)}),this.collect.on(n.ProfileClear,function(){i.cache={}}),this.ready(n.Profile)},t.prototype.ready=function(t){var e=this;if(this.collect.set(t),this.collect.hook._hooksCache.hasOwnProperty(t)){var i=this.collect.hook._hooksCache[t];if(!Object.keys(i).length)return;var n=function(t){i[t].length&&i[t].forEach(function(i){e.collect.hook.emit(t,i)})};for(var o in i)n(o)}},t.prototype.report=function(t,e){void 0===e&&(e={});try{if(this.config.disable_track_event)return;var i=[];i.push(this.collect.processEvent(t,e));var n=this.collect.eventManager.merge(i);this.collect.requestManager.useRequest({url:this.reportUrl,data:n}),this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u6210\u529F",time:Date.now(),data:n,code:200,status:"success"})}catch(t){this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.setProfile=function(t){var e=this.formatParams(t);e&&Object.keys(e).length&&(this.pushCache(e),this.report("__profile_set",w({},e,{profile:!0})))},t.prototype.setOnceProfile=function(t){var e=this.formatParams(t,!0);e&&Object.keys(e).length&&(this.pushCache(e),this.report("__profile_set_once",w({},e,{profile:!0})))},t.prototype.incrementProfile=function(t){t&&this.report("__profile_increment",w({},t,{profile:!0}))},t.prototype.unsetProfile=function(t){if(t){var e={};e[t]="1",this.report("__profile_unset",w({},e,{profile:!0}))}},t.prototype.appendProfile=function(t){if(t){var e={};for(var i in t)("string"==typeof t[i]||"Array"===Object.prototype.toString.call(t[i]).slice(8,-1))&&(e[i]=t[i]);Object.keys(e).length&&this.report("__profile_append",w({},e,{profile:!0}))}},t.prototype.pushCache=function(t){var e=this;Object.keys(t).forEach(function(i){e.cache[i]={val:e.clone(t[i]),timestamp:Date.now()}})},t.prototype.formatParams=function(t,e){var i=this;void 0===e&&(e=!1);try{if(!t||"[object Object]"!==Object.prototype.toString.call(t))return;var n={};for(var o in t)("string"==typeof t[o]||"number"==typeof t[o]||"Array"===Object.prototype.toString.call(t[o]).slice(8,-1))&&(n[o]=t[o]);var r=Object.keys(n);if(!r.length||!this.eventCheck.checkEventParams(n))return;var a=Date.now();return r.filter(function(n){var o=i.cache[n];return e?!o:!(o&&i.compare(o.val,t[n])&&a-o.timestamp<i.duration)}).reduce(function(t,e){return t[e]=n[e],t},{})}catch(t){this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.compare=function(t,e){try{return JSON.stringify(t)===JSON.stringify(e)}catch(t){return this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message}),!1}},t.prototype.clone=function(t){try{return JSON.parse(JSON.stringify(t))}catch(e){return this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:e.message}),t}},t.prototype.unReady=function(){},t}(),tj=function(){function t(){var t=this;this.setInterval=function(){t.clearIntervalFunc=z(function(){t.isSessionhasEvent&&t.endCurrentSession()},t.sessionInterval)},this.clearInterval=function(){t.clearIntervalFunc&&t.clearIntervalFunc()}}return t.prototype.apply=function(t,e){var i=this;if(this.collect=t,!e.disable_heartbeat){this.sessionInterval=6e4,this.startTime=0,this.lastTime=0,this.setInterval();var n=this.collect.Types;this.collect.on(n.SessionReset,function(){i.process()})}},t.prototype.endCurrentSession=function(){this.collect.event("_be_active",{start_time:this.startTime,end_time:this.lastTime,url:window.location.href,referrer:window.document.referrer,title:document.title||location.pathname}),this.isSessionhasEvent=!1,this.startTime=0},t.prototype.process=function(){this.isSessionhasEvent||(this.isSessionhasEvent=!0,this.startTime=+new Date);var t=this.lastTime||+new Date;this.lastTime=+new Date,this.lastTime-t>this.sessionInterval&&(this.clearInterval(),this.endCurrentSession(),this.setInterval())},t}(),tK=function(){function t(){}return t.prototype.apply=function(t,e){var i=this;if(this.collect=t,this.config=e,!this.config.channel_domain&&!e.disable_track_event&&!e.disable_sdk_monitor){this.url=t.configManager.getUrl("event");var n=this.collect.Types;this.collect.on(n.Ready,function(){i.sdkOnload()}),this.collect.on(n.SubmitError,function(t){var e=t.type,n=t.eventData,o=t.errorCode;"f_data"===e&&i.sdkError(n,o)})}},t.prototype.sdkOnload=function(){var t=this;try{var e=this.collect.configManager.get(),i=e.header,n=e.user,o=i.app_id,r=i.app_name,a=i.sdk_version,s=n.web_id,c={events:[{event:"onload",params:JSON.stringify({app_id:o,app_name:r||"",sdk_version:a,sdk_type:"npm",sdk_config:this.config,sdk_desc:"TOC_OVERSEA"}),local_time_ms:Date.now()}],user:{user_unique_id:s},header:{}};setTimeout(function(){t.collect.requestManager.useRequest({url:t.url,data:[c],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})},16)}catch(t){}},t.prototype.sdkError=function(t,e){var i=this;try{var n=t[0],o=n.user,r=n.header,a=[];t.forEach(function(t){t.events.forEach(function(t){a.push(t)})});var s={events:a.map(function(t){return{event:"on_error",params:JSON.stringify({error_code:e,app_id:r.app_id,app_name:r.app_name||"",error_event:t.event,sdk_version:r.sdk_version,local_time_ms:t.local_time_ms,tea_event_index:Date.now(),params:t.params,header:JSON.stringify(r),user:JSON.stringify(o)}),local_time_ms:Date.now()}}),user:{user_unique_id:o.user_unique_id},header:{}};setTimeout(function(){i.collect.requestManager.useRequest({url:i.url,data:[s],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})},16)}catch(t){}},t}();function t$(t,e){if(void 0===e&&(e="list"),!t)return!1;if(e&&"list"===e){if(["LI","TR","DL"].includes(t.nodeName)||t.dataset&&t.dataset.hasOwnProperty("teaIdx")||t.hasAttribute&&t.hasAttribute("data-tea-idx"))return!0}else if(["A","BUTTON"].includes(t.nodeName)||t.dataset&&t.dataset.hasOwnProperty("teaContainer")||t.hasAttribute&&t.hasAttribute("data-tea-container"))return!0;return!1}function tq(t){for(var e=t;e&&!t$(e,"container");){if("HTML"===e.nodeName||"BODY"===e.nodeName)return t;e=e.parentElement}return e||t}function tH(t){var e="";return 3===t.nodeType?e=t.textContent.trim():t.dataset&&t.dataset.hasOwnProperty("teaTitle")?e=t.getAttribute("data-tea-title"):t.hasAttribute("ata-tea-title")?e=t.getAttribute("data-tea-title"):t.hasAttribute("title")?e=t.getAttribute("title"):"INPUT"===t.nodeName&&["button","submit"].includes(t.getAttribute("type"))?e=t.getAttribute("value"):"IMG"===t.nodeName&&t.getAttribute("alt")&&(e=t.getAttribute("alt")),e.slice(0,200)}var tW=function(t,e){return t.hasAttribute?t.hasAttribute(e):t.attributes?!(!t.attributes[e]||!t.attributes[e].specified):void 0},tJ=function(t,e){if("string"==typeof e)return tW(t,e);if(M(e)){for(var i=!1,n=0;n<e.length;n++)if(tW(t,e[n])){i=!0;break}return i}},tF=function(t,e){var i={};if("string"==typeof e)tW(t,e)&&(i.attrs=t.getAttribute(e));else if(M(e))for(var n=0;n<e.length;n++)tW(t,e[n])&&(i[e[n]]=t.getAttribute(e[n]));return i},tX=function(t){if(t.children.length){var e=t.children;return![].slice.call(e).some(function(t){return t.children.length>0})}return!0},tY=function(t){if("svg"===t.tagName.toLowerCase())return!0;for(var e=t.parentElement,i=!1;e;)"svg"===e.tagName.toLowerCase()?(e=null,i=!0):e=e.parentElement;return i},tZ=function(){function t(t,e,i){var n=this;this.statistics=!1,this.pageView=!1,this.clickEvent=function(t){var e,i;e=t.target,i=n.options,(1!==e.nodeType||!i.svg&&tY(e)||["HTML","BODY"].includes(e.tagName.toUpperCase())?1:"none"===e.style.display||!t$(e,"container")&&!tX(e)&&!i.svg)||n.eventHandel({eventType:"dom",eventName:"click"},t)},this.changeEvent=function(t){n.eventHandel({eventType:"dom",eventName:"change"},t)},this.submitEvent=function(t){n.eventHandel({eventType:"dom",eventName:"submit"},t)},this.getPageViewEvent=function(t,e){e&&"pushState"===e&&n.eventHandel({eventType:"dom",eventName:"beat"},w({beat_type:0},t)),n.eventHandel({eventType:"dom",eventName:"page_view"},t)},this.getPageLoadEvent=function(t){n.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:t})},this.config=i.getConfig().eventConfig,this.collect=e,this.options=t,this.beatTime=t.beat}return t.prototype.init=function(t){this.eventHandel=t;var e=this.config.mode;this.addListener(e)},t.prototype.addListener=function(t){var e=this;if("proxy-capturing"===t){if(this.config.click&&window.document.addEventListener("click",this.clickEvent,!0),this.config.change&&window.document.addEventListener("change",this.changeEvent,!0),this.config.submit&&window.document.addEventListener("submit",this.submitEvent,!0),this.config.pv){this.collect.on("route-change",function(t){var i=t.config,n=t.name;e.getPageViewEvent(i,n),e.pageView=!0});var i=setTimeout(function(){e.pageView||(e.getPageViewEvent(e.getDefaultConfig()),e.pageView=!0,clearTimeout(i))},2e3)}if(this.config.beat){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",function(){e.beatEvent(e.beatTime)});var n=0,o=null;window.addEventListener("scroll",function(){clearTimeout(o),o=setTimeout(r,500),n=document.documentElement.scrollTop||document.body.scrollTop});var r=function(){(document.documentElement.scrollTop||document.body.scrollTop)==n&&e.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(t){}try{var a=window.performance&&window.performance.getEntriesByType("paint");a&&a.length?(new PerformanceObserver(function(t){var i=t.getEntries(),n=i[i.length-1],o=n.renderTime||n.loadTime;e.statistics||(e.getPageLoadEvent(o),e.statistics=!0)}).observe({entryTypes:["largest-contentful-paint"]}),setTimeout(function(){e.statistics||(e.getPageLoadEvent(a[0].startTime||0),e.statistics=!0)},2e3)):this.getPageLoadEvent(0)}catch(t){this.getPageLoadEvent(0)}}}},t.prototype.removeListener=function(){window.document.removeEventListener("click",this.clickEvent,!0),window.document.removeEventListener("change",this.changeEvent,!0),window.document.removeEventListener("submit",this.submitEvent,!0)},t.prototype.beatEvent=function(t){var e,i=this;try{this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(e=setInterval(function(){i.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})},t)),I(function(){i.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),i.beatTime&&clearInterval(e)})}catch(t){}},t.prototype.getDefaultConfig=function(){return{is_html:1,url:location.href,referrer:document.referrer,page_key:location.href,refer_page_key:document.referrer,page_title:document.title||location.pathname,page_manual_key:"",refer_page_manual_key:"",refer_page_title:"",page_path:location.pathname,page_host:location.host}},t}(),tQ={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},t1=function(){function t(t,e){this.config=t,this.config.eventConfig=Object.assign(this.config.eventConfig,e)}return t.prototype.getConfig=function(){return this.config},t.prototype.setConfig=function(t){return this.config=t},t}(),t0=function(t,e,i,n,o){return w({event:t},function(t,e,i,n){var o,r,a,s,c,u,l,h,p,f,d={},g=function(t){if(t){var e=t.getBoundingClientRect(),i=e.width,n=e.height;return{left:e.left,top:e.top,element_width:i,element_height:n}}}(e),_=(void 0===(o=t)&&(o={}),void 0===(r=g)&&(r={}),a=o.clientX,s=o.clientY,c=r.left,{touch_x:Math.floor(a-c>=0?a-c:0),touch_y:Math.floor(s-(u=r.top)>=0?s-u:0)}),m=g.element_width,v=g.element_height,y=_.touch_x,b=_.touch_y,E=function(t){for(var e=[];null!==t.parentElement;)e.push(t),t=t.parentElement;var i=[],n=[];return e.forEach(function(t){var e=function(t){if(null===t)return{str:"",index:0};var e=0,i=t.parentElement;if(i)for(var n=i.children,o=0;o<n.length&&n[o]!==t;o++)n[o].nodeName===t.nodeName&&e++;return{str:[t.nodeName.toLowerCase(),t$(t,"list")?"[]":""].join(""),index:e}}(t),o=e.str,r=e.index;i.unshift(o),n.unshift(r)}),{element_path:"/"+i.join("/"),positions:n}}(e),w=E.element_path,S=E.positions,k=(l=tq(e),h=[],function t(e){var i=tH(e);if(i&&-1===h.indexOf(i)&&h.push(i),e.childNodes.length>0)for(var n=e.childNodes,o=0;o<n.length;o++)8!==n[o].nodeType&&t(n[o])}(l),h),A=window.performance.timing.navigationStart,D=Date.now()-A,T=S.map(function(t){return""+t}),O=null;if(window.TEAVisualEditor&&window.TEAVisualEditor.getOriginXpath&&(O=window.TEAVisualEditor.getOriginXpath({xpath:w,positions:T})),d.element_path=O&&O.xpath||w,d.positions=O&&O.positions||T,n&&!n.text&&(d.texts=k,d.element_title=(p=tq(e),f="",function t(e){var i=tH(e);if(i&&(f+=i),e.childNodes.length>0)for(var n=e.childNodes,o=0;o<n.length;o++)3===n[o].nodeType&&t(n[o])}(p),f)),d.element_id=e.getAttribute("id")||"",d.element_class_name=e.getAttribute("class")||"",d.element_type=e.nodeType,d.element_width=Math.floor(m),d.element_height=Math.floor(v),d.touch_x=y,d.touch_y=b,d.page_manual_key="",d.elememt_manual_key="",d.since_page_start_ms=D,d.page_start_ms=A,d.page_path=location.pathname,d.page_host=location.host,i.track_attr&&tJ(e,i.track_attr)){var R=tF(e,i.track_attr);for(var M in R)d[M]=R[M]}var C=tq(e);return"A"===C.tagName&&(d.href=C.getAttribute("href")),"IMG"===e.tagName&&(d.src=e.getAttribute("src")),d}(e,i,n,o),{is_html:1,page_key:window.location.href,page_title:document.title})},t2=function(){function t(t,e){this.ignore={text:!0},this.initConfig=t,this.options=e,this.eventName=e&&"tea"===e.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics",exposure:"__bav_page_exposure"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics",exposure:"bav2b_exposure"},e&&!0===e.text&&(this.ignore.text=!1),e&&e.exposure&&e.exposure.eventName&&(this.eventName.exposure=e.exposure.eventName)}return t.prototype.handleEvent=function(t,e){try{if(function(t){for(var e=t;e&&e.parentNode;){if(e.hasAttribute("data-tea-ignore"))return!0;if("HTML"===e.nodeName||"body"===e.nodeName)break;e=e.parentNode}return!1}(t.target))return null;var i="bav2b_click";switch(e){case"click":return i=this.eventName.click,t0(i,t,t.target,this.options,this.ignore);case"exposure":return i=this.eventName.exposure,t0(i,t,t.target,this.options,this.ignore);case"change":return w({},t0(i="bav2b_change",t,t.target,this.options),function(t,e){try{if("bav2b_change"===t)return e.hasAttribute("data-tea-track")?{value:e.value}:{}}catch(t){return{}}}(i,t.target));case"submit":return t0(i="bav2b_submit",t,t.target,this.options)}}catch(t){return null}},t.prototype.handleViewEvent=function(t){t.event=this.eventName.page,t.page_title=document.title,t.page_total_width=window.innerWidth,t.page_total_height=window.innerHeight;try{var e=window.sessionStorage.getItem("_tea_cache_duration");if(e){var i=JSON.parse(e);t.refer_page_duration_ms=i?i.duration:""}t.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,t.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,t.page_start_ms=window.performance.timing.navigationStart}catch(t){}return t},t.prototype.handleStatisticsEvent=function(t){var e={};e.event=this.eventName.static,e.is_html=1,e.page_key=location.href,e.refer_page_key=document.referrer||"",e.page_title=document.title,e.page_manual_key=this.initConfig.autotrack.page_manual_key||"",e.refer_page_manual_key="";try{var i=t.lcp,n=window.performance.timing,o=n.loadEventEnd-n.navigationStart;e.page_init_cost_ms=parseInt(i||(o>0?o:0)),e.page_start_ms=n.navigationStart}catch(t){}return e},t.prototype.handleBeadtEvent=function(t){t.event=this.eventName.beat,t.page_key=window.location.href,t.is_html=1,t.page_title=document.title,t.page_manual_key=this.initConfig.autotrack.page_manual_key||"";try{t.page_viewport_width=window.innerWidth,t.page_viewport_height=window.innerHeight,t.page_total_width=document.documentElement.scrollWidth,t.page_total_height=document.documentElement.scrollHeight,t.scroll_width=document.documentElement.scrollLeft+window.innerWidth,t.scroll_height=document.documentElement.scrollTop+window.innerHeight,t.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,t.page_start_ms=window.performance.timing.navigationStart}catch(t){}return t},t}(),t4=function(){function t(t){this.collect=t,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return t.prototype.send=function(t,e){var i=t.eventSend,n=e.event;delete e.event,i&&"becon"===i?this.collect.beconEvent(n,e):this.collect.event(n,e)},t.prototype.get=function(t,e){var i=Object.assign({headers:{"content-type":"application/json"},method:"GET"},e);fetch(t,i)},t.prototype.post=function(t,e){var i=Object.assign({headers:{"content-type":"application/json"},method:"POST"},e);fetch(t,i)},t}(),t3="_TEA_VE_OPEN",t5="_TEA_VE_APIHOST",t6="lang",t8="_VISUAL_EDITOR_V",t9="_VISUAL_EDITOR_U";function t7(){try{var t=window.TEAVisualEditor.lang=window.TEAVisualEditor.lang||V.get(t6),e=window.TEAVisualEditor.__editor_ajax_domain=window.TEAVisualEditor.__editor_ajax_domain||V.get(t5),i=window.TEAVisualEditor.__editor_verison=window.TEAVisualEditor.__editor_verison||V.get(t8),n=window.TEAVisualEditor.__editor_url=window.TEAVisualEditor.__editor_url||V.get(t9),o=+new Date,r=new Date(o+18e5);V.set(t3,"1",{expires:r}),V.set(t5,e,{expires:r}),V.set(t9,n,{expires:r}),V.set(t6,t,{expires:r}),V.set(t8,i||"",{expires:r})}catch(t){}}var et=!1;function ee(t){var e=t.event,i=t.editorUrl,n=t.autoTrackInstance;et||(et=!0,x(i,function(){tR(e,"editorScriptloadSuccess"),n.destroy()},function(){e&&tR(e,"editorScriptloadError"),et=!1}))}var ei,en,eo,er,ea,es=function(){function t(t){this._instance=null,this._intersection=t,this.init()}return t.prototype.init=function(){var t=this;this._instance=new MutationObserver(function(e){e.forEach(function(e){"attributes"===e.type&&t.attributeChangeObserve(e),"childList"===e.type&&t.modifyNodeObserve(e)})}),this._instance.observe(document.body,{childList:!0,attributes:!0,subtree:!0,attributeOldValue:!1})},t.prototype.attributeChangeObserve=function(t){t.target.hasAttribute("data-exposure")?this.exposureAdd(t,"mutation"):this.exposureRemove(t)},t.prototype.modifyNodeObserve=function(t){var e=this;Array.prototype.forEach.call(t.addedNodes,function(t){1===t.nodeType&&t.hasAttribute("data-exposure")&&e.exposureAdd(t,"intersect"),e.mapChild(t,e.exposureAdd)}),Array.prototype.forEach.call(t.removedNodes,function(t){1===t.nodeType&&t.hasAttribute("data-exposure")&&e.exposureRemove(t),e.mapChild(t,e.exposureRemove)})},t.prototype.mapChild=function(t,e){var i=this;1===t.nodeType&&t.children.length&&Array.prototype.forEach.call(t.children,function(t){1===t.nodeType&&t.hasAttribute("data-exposure")&&e(t),i.mapChild(t,e)})},t.prototype.exposureAdd=function(t,e){this._intersection.exposureAdd(t,e)},t.prototype.exposureRemove=function(t){this._intersection.exposureRemove(t)},t._exposure_observer=null,t}(),ec=function(){function t(e,i){this.count=1,this.instance=this.buildObserver(),this.observeMap=t._observer_map,e.autotrack.exposure.ratio?this.Ratio=e.autotrack.exposure.ratio:0===e.autotrack.exposure.ratio?this.Ratio=0:this.Ratio=.5,this.EventHandle=i}return t.prototype.buildObserver=function(){var e=this;if(!t._observer_instance)return IntersectionObserver&&(t._observer_instance=new IntersectionObserver(function(t){t.forEach(function(t){e.observeMap.get(t.target._observeId)&&e.exposureEvent(t)})},{threshold:[.01,.25,.5,.75,1]})),t._observer_instance},t.prototype.exposureAdd=function(t,e){var i=t;"mutation"===e&&(i=t.target);var n=i._observeId;if(n||this.observeMap.has(n)){if(!1===i.visible){var o=i.getBoundingClientRect(),r=o.top,a=o.left,s=o.right,c=o.bottom;r>=0&&c<=window.innerHeight&&a>=0&&s<=window.innerWidth&&(i.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},t))}}else i._observeId=this.count,i.visible=!1,this.observeMap.set(this.count,i),this.observe(i),this.count++},t.prototype.exposureRemove=function(t){this.observeMap.has(t._observeId)&&(this.observeMap.delete(t._observeId),this.unobserve(t))},t.prototype.exposureEvent=function(t){if(t.intersectionRatio>=this.Ratio&&t.isIntersecting){if("0"!==t.target.style.opacity&&"hidden"!==t.target.style.visibility)!0!==t.target.visible&&(t.target.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},t))}else t.target.visible=!1},t.prototype.observe=function(t){this.instance.observe(t)},t.prototype.unobserve=function(t){this.instance.unobserve(t)},t._observer_instance=null,t._observer_map=new Map,t}(),eu=function(){function t(t,e){t.autotrack&&t.autotrack.exposure&&(this._intersection=new ec(t,e),this._observer=new es(this._intersection),this.initObserver())}return t.prototype.initObserver=function(){var t=this;Array.prototype.forEach.call(document.querySelectorAll("[data-exposure]"),function(e){t._intersection.exposureAdd(e,"intersect")})},t}(),el={hashTag:!1,impr:!1},eh=function(){function t(){}return t.prototype.apply=function(t,e){if(this.autoTrackStart=!1,this.collect=t,this.config=e,e.autotrack){var i=t.Types;e.autotrack&&e.autotrack.collect_url&&!e.autotrack.collect_url()||(this.ready(i.Autotrack),this.collect.emit(i.AutotrackReady))}},t.prototype.ready=function(t){this.collect.set(t);var e=this.config.autotrack;e=Object.assign(el,e="object"==typeof e?e:{}),this.destroyed=!1,this.options=e,this.Config=new t1(tQ,this.options),this.Exposure=new eu(this.config,this.handle.bind(this)),this.Listener=new tZ(e,this.collect,this.Config),this.EventHandle=new t2(this.config,e),this.Request=new t4(this.collect),this.autoTrackStart=!0,this.init(),function(t,e){window.TEAVisualEditor=window.TEAVisualEditor||{};var i="",n="https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/visual-editor-rangers.js?query="+Date.now();window.TEAVisualEditor.appId=e.app_id;var o=e.channel_domain,r="";if(tO(["*"]),o){var a,s="";try{var c=window.performance.getEntriesByType("resource");if(c&&c.length&&(c.forEach(function(t){"script"===t.initiatorType&&t.name&&-1!==t.name.indexOf("collect")&&(s=t.name)}),s&&(a=s.split("/"))&&a.length)){r="https:/";for(var u=2;u<a.length&&u!==a.length-1;u++)r=r+"/"+a[u];r&&r.indexOf("/5.0")&&(r=r.split("/5.0")[0]||r)}}catch(t){}}if(tG(e,te),"1"===V.get(t3)){var l=function(){var t=V.get(t5);try{t=JSON.parse(t)}catch(t){}return t}(),h="";l&&(window.TEAVisualEditor.__editor_ajax_domain=l,h=V.get(t9)),ee({event:null,editorUrl:h||n,autoTrackInstance:t}),t7()}else try{tM("tea:openVisualEditor",function(e){var a=e.data;if("string"==typeof e.data)try{a=JSON.parse(e.data)}catch(t){a=void 0}if(a){var s=a.referrer,c=a.lang;if(s&&(window.TEAVisualEditor.__editor_ajax_domain=s),i=n,o){var u=a.version;i=r?""+r+(u?"/visual-editor-rangers-v"+u:"/visual-editor-rangers-v1.0.0")+".js":n,window.TEAVisualEditor.__editor_verison=u}window.TEAVisualEditor.__editor_url=i,window.TEAVisualEditor.lang=c,ee({event:e,editorUrl:i,autoTrackInstance:t}),t7()}}),window.TEAVisualEditor.openAutotrackEditor=function(){ee({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:t})}}catch(t){}try{tM("tea:openHeatMapCore",function(i){var n=i.data.app_id;n&&n!==e.app_id||ee({event:i,editorUrl:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/heatmap-core.js?query="+Date.now(),autoTrackInstance:t})})}catch(t){}}(this,this.config)},t.prototype.init=function(){this.Listener.init(this.handle.bind(this)),"base"===this.collect.loadType&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")},t.prototype.handle=function(t,e){"dom"===t.eventType&&this.handleDom(t,e)},t.prototype.handleDom=function(t,e){try{var i=t.eventName;if("click"===i||"exposure"===i||"change"===i||"submit"===i){var n=this.EventHandle.handleEvent(e,i);null!==n&&this.Request.send({eventType:"custom",eventName:"report_"+i+"_event",extra:{methods:"GET"}},n)}else if("page_view"===i||"page_statistics"===i){var o=void 0;o="page_view"===i?this.EventHandle.handleViewEvent(e):this.EventHandle.handleStatisticsEvent(e),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},o)}else if("beat"===i){var r=this.EventHandle.handleBeadtEvent(e),a=t.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:a},r)}}catch(t){}},t.prototype.destroy=function(){this.autoTrackStart&&(this.autoTrackStart=!1,this.Listener.removeListener())},t}();(i=ea||(ea={})).Net="net",i.FailNet="f_net",i.FailData="f_data";var ep={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},ef=function(){function t(){}return t.prototype.apply=function(t,e){var i=this;if(this.ready=e.app_id&&e.enable_tracer&&!e.disable_track_event,this.ready){this.limit={pv:1,sdk:3,autotrack:3,log:3},this.errorCode={f_net:0,f_data:0},this.tracerCache=new Map,this.collect=t,this.appid=e.app_id,this.reportUrl=t.configManager.getUrl("event");var n=this.collect.Types;t.adapters.fetch,this.collect.on(n.Event,function(t){M(t)?t.forEach(function(t){i.addCount("log")}):i.addCount("log")}),this.collect.on(n.SubmitError,function(t){var e=t.type,n=t.eventDate,o=t.errorCode,r=t.response;i.addErrorCount(n,e,o,r)}),this.listener(),this.collect.emit(n.TracerReady)}},t.prototype.addCount=function(t,e,i){void 0===e&&(e="net"),void 0===i&&(i=1);try{this.tracerCache||(this.tracerCache=new Map);var n=void 0;if(this.tracerCache.has(t))(o=this.tracerCache.get(t)).has(e)?(n=o.get(e).params.count,n++,o.set(e,this.processTracer(n,t,e))):(n=i,o.set(e,this.processTracer(i,t,e)));else{var o=new Map;n=i,o.set(e,this.processTracer(i,t,e)),this.tracerCache.set(t,o)}"net"===e&&n>=this.limit[t]&&this.report(!1)}catch(t){}},t.prototype.addErrorCount=function(t,e,i,n){var o=this;try{if(t&&t.length){var r=t[0].events;r&&r.length&&("f_data"===e?(n&&n.hasOwnProperty("sc")?this.addCount("log",e,r.length-n.sc):this.addCount("log",e,r.length),this.errorCode[e]=i):r.forEach(function(t){var n="log";for(var r in ep)if(-1!==ep[r].indexOf(t.event)){n=r;break}o.addCount(n,e,1),o.errorCode[e]=i}))}}catch(t){}},t.prototype.report=function(t){if(this.tracerCache){var e=[];this.tracerCache.forEach(function(t){t.forEach(function(t){e.push(t)})}),e&&e.length&&this.sendTracer(e,t)}},t.prototype.sendTracer=function(t,e){try{var i=this.collect.eventManager.merge(t);this.collect.requestManager.useRequest({url:this.reportUrl,data:i,useBeacon:e}),this.tracerCache=null}catch(t){}},t.prototype.processTracer=function(t,e,i){try{var n={count:t,state:i,key:e,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:te};"f_net"!==i&&"f_data"!==i||(n.errorCode=this.errorCode[i]);var o=this.collect.processEvent("applog_trace",n);if(o&&o.event)return delete o.is_bav,o}catch(t){}},t.prototype.listener=function(){var t=this;document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&t.leavePage()}),I(function(){t.leavePage()})},t.prototype.leavePage=function(){this.report(!0)},t}(),ed=U(function(t,e){var i,n,o,r,a,s,c,u,l,h,p,f,d,g,_,m,v,y,b,E,w;t.exports=(i="millisecond",n="second",o="minute",r="hour",a="week",s="month",c="quarter",u="year",l="date",h="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,f=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d=function(t,e,i){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(i)+t},(_={})[g="en"]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m=function(t){return t instanceof E},v=function(t,e,i){var n;if(!t)return g;if("string"==typeof t)_[t]&&(n=t),e&&(_[t]=e,n=t);else{var o=t.name;_[o]=t,n=o}return!i&&n&&(g=n),n||!i&&g},y=function(t,e){if(m(t))return t.clone();var i="object"==typeof e?e:{};return i.date=t,i.args=arguments,new E(i)},(b={s:d,z:function(t){var e=-t.utcOffset(),i=Math.abs(e);return(e<=0?"+":"-")+d(Math.floor(i/60),2,"0")+":"+d(i%60,2,"0")},m:function t(e,i){if(e.date()<i.date())return-t(i,e);var n=12*(i.year()-e.year())+(i.month()-e.month()),o=e.clone().add(n,s),r=i-o<0,a=e.clone().add(n+(r?-1:1),s);return+(-(n+(i-o)/(r?o-a:a-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return({M:s,y:u,w:a,d:"day",D:l,h:r,m:o,s:n,ms:i,Q:c})[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}}).l=v,b.i=m,b.w=function(t,e){return y(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})},w=(E=function(){function t(t){this.$L=v(t.locale,null,!0),this.parse(t)}var e=t.prototype;return e.parse=function(t){this.$d=function(t){var e=t.date,i=t.utc;if(null===e)return new Date(NaN);if(b.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(p);if(n){var o=n[2]-1||0,r=(n[7]||"0").substring(0,3);return i?new Date(Date.UTC(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,r)):new Date(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,r)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},e.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},e.$utils=function(){return b},e.isValid=function(){return this.$d.toString()!==h},e.isSame=function(t,e){var i=y(t);return this.startOf(e)<=i&&i<=this.endOf(e)},e.isAfter=function(t,e){return y(t)<this.startOf(e)},e.isBefore=function(t,e){return this.endOf(e)<y(t)},e.$g=function(t,e,i){return b.u(t)?this[e]:this.set(i,t)},e.unix=function(){return Math.floor(this.valueOf()/1e3)},e.valueOf=function(){return this.$d.getTime()},e.startOf=function(t,e){var i=this,c=!!b.u(e)||e,h=b.p(t),p=function(t,e){var n=b.w(i.$u?Date.UTC(i.$y,e,t):new Date(i.$y,e,t),i);return c?n:n.endOf("day")},f=function(t,e){return b.w(i.toDate()[t].apply(i.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(e)),i)},d=this.$W,g=this.$M,_=this.$D,m="set"+(this.$u?"UTC":"");switch(h){case u:return c?p(1,0):p(31,11);case s:return c?p(1,g):p(0,g+1);case a:var v=this.$locale().weekStart||0,y=(d<v?d+7:d)-v;return p(c?_-y:_+(6-y),g);case"day":case l:return f(m+"Hours",0);case r:return f(m+"Minutes",1);case o:return f(m+"Seconds",2);case n:return f(m+"Milliseconds",3);default:return this.clone()}},e.endOf=function(t){return this.startOf(t,!1)},e.$set=function(t,e){var a,c=b.p(t),h="set"+(this.$u?"UTC":""),p=((a={}).day=h+"Date",a[l]=h+"Date",a[s]=h+"Month",a[u]=h+"FullYear",a[r]=h+"Hours",a[o]=h+"Minutes",a[n]=h+"Seconds",a[i]=h+"Milliseconds",a)[c],f="day"===c?this.$D+(e-this.$W):e;if(c===s||c===u){var d=this.clone().set(l,1);d.$d[p](f),d.init(),this.$d=d.set(l,Math.min(this.$D,d.daysInMonth())).$d}else p&&this.$d[p](f);return this.init(),this},e.set=function(t,e){return this.clone().$set(t,e)},e.get=function(t){return this[b.p(t)]()},e.add=function(t,e){var i,c=this;t=Number(t);var l=b.p(e),h=function(e){var i=y(c);return b.w(i.date(i.date()+Math.round(e*t)),c)};if(l===s)return this.set(s,this.$M+t);if(l===u)return this.set(u,this.$y+t);if("day"===l)return h(1);if(l===a)return h(7);var p=((i={})[o]=6e4,i[r]=36e5,i[n]=1e3,i)[l]||1,f=this.$d.getTime()+t*p;return b.w(f,this)},e.subtract=function(t,e){return this.add(-1*t,e)},e.format=function(t){var e=this,i=this.$locale();if(!this.isValid())return i.invalidDate||h;var n=t||"YYYY-MM-DDTHH:mm:ssZ",o=b.z(this),r=this.$H,a=this.$m,s=this.$M,c=i.weekdays,u=i.months,l=function(t,i,o,r){return t&&(t[i]||t(e,n))||o[i].substr(0,r)},p=function(t){return b.s(r%12||12,t,"0")},d=i.meridiem||function(t,e,i){var n=t<12?"AM":"PM";return i?n.toLowerCase():n},g={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:b.s(s+1,2,"0"),MMM:l(i.monthsShort,s,u,3),MMMM:l(u,s),D:this.$D,DD:b.s(this.$D,2,"0"),d:String(this.$W),dd:l(i.weekdaysMin,this.$W,c,2),ddd:l(i.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(r),HH:b.s(r,2,"0"),h:p(1),hh:p(2),a:d(r,a,!0),A:d(r,a,!1),m:String(a),mm:b.s(a,2,"0"),s:String(this.$s),ss:b.s(this.$s,2,"0"),SSS:b.s(this.$ms,3,"0"),Z:o};return n.replace(f,function(t,e){return e||g[t]||o.replace(":","")})},e.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},e.diff=function(t,e,i){var l,h=b.p(e),p=y(t),f=6e4*(p.utcOffset()-this.utcOffset()),d=this-p,g=b.m(this,p);return g=((l={})[u]=g/12,l[s]=g,l[c]=g/3,l[a]=(d-f)/6048e5,l.day=(d-f)/864e5,l[r]=d/36e5,l[o]=d/6e4,l[n]=d/1e3,l)[h]||d,i?g:b.a(g)},e.daysInMonth=function(){return this.endOf(s).$D},e.$locale=function(){return _[this.$L]},e.locale=function(t,e){if(!t)return this.$L;var i=this.clone(),n=v(t,e,!0);return n&&(i.$L=n),i},e.clone=function(){return b.w(this.$d,this)},e.toDate=function(){return new Date(this.valueOf())},e.toJSON=function(){return this.isValid()?this.toISOString():null},e.toISOString=function(){return this.$d.toISOString()},e.toString=function(){return this.$d.toUTCString()},t}()).prototype,y.prototype=w,[["$ms",i],["$s",n],["$m",o],["$H",r],["$W","day"],["$M",s],["$y",u],["$D",l]].forEach(function(t){w[t[1]]=function(e){return this.$g(e,t[0],t[1])}}),y.extend=function(t,e){return t.$i||(t(e,E,y),t.$i=!0),y},y.locale=v,y.isDayjs=m,y.unix=function(t){return y(1e3*t)},y.en=_[g],y.Ls=_,y.p={},y)}),eg=U(function(t,e){var i,n,o,r,a,s,c,u,l,h,p,f;t.exports=(o=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,r=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,a={years:31536e6,months:2592e6,days:864e5,hours:36e5,minutes:6e4,seconds:1e3,milliseconds:1,weeks:6048e5},s=function(t){return t instanceof f},c=function(t,e,i){return new f(t,i,e.$l)},u=function(t){return n.p(t)+"s"},l=function(t){return t<0},h=function(t){return l(t)?Math.ceil(t):Math.floor(t)},p=function(t,e){return t?l(t)?{negative:!0,format:""+Math.abs(t)+e}:{negative:!1,format:""+t+e}:{negative:!1,format:""}},f=function(){function t(t,e,i){var n=this;if(this.$d={},this.$l=i,void 0===t&&(this.$ms=0,this.parseFromMilliseconds()),e)return c(t*a[u(e)],this);if("number"==typeof t)return this.$ms=t,this.parseFromMilliseconds(),this;if("object"==typeof t)return Object.keys(t).forEach(function(e){n.$d[u(e)]=t[e]}),this.calMilliseconds(),this;if("string"==typeof t){var o=t.match(r);if(o){var s=o.slice(2).map(function(t){return Number(t)});return this.$d.years=s[0],this.$d.months=s[1],this.$d.weeks=s[2],this.$d.days=s[3],this.$d.hours=s[4],this.$d.minutes=s[5],this.$d.seconds=s[6],this.calMilliseconds(),this}}return this}var e=t.prototype;return e.calMilliseconds=function(){var t=this;this.$ms=Object.keys(this.$d).reduce(function(e,i){return e+(t.$d[i]||0)*a[i]},0)},e.parseFromMilliseconds=function(){var t=this.$ms;this.$d.years=h(t/31536e6),t%=31536e6,this.$d.months=h(t/2592e6),t%=2592e6,this.$d.days=h(t/864e5),t%=864e5,this.$d.hours=h(t/36e5),t%=36e5,this.$d.minutes=h(t/6e4),t%=6e4,this.$d.seconds=h(t/1e3),t%=1e3,this.$d.milliseconds=t},e.toISOString=function(){var t=p(this.$d.years,"Y"),e=p(this.$d.months,"M"),i=+this.$d.days||0;this.$d.weeks&&(i+=7*this.$d.weeks);var n=p(i,"D"),o=p(this.$d.hours,"H"),r=p(this.$d.minutes,"M"),a=this.$d.seconds||0;this.$d.milliseconds&&(a+=this.$d.milliseconds/1e3);var s=p(a,"S"),c=t.negative||e.negative||n.negative||o.negative||r.negative||s.negative,u=o.format||r.format||s.format?"T":"",l=(c?"-":"")+"P"+t.format+e.format+n.format+u+o.format+r.format+s.format;return"P"===l||"-P"===l?"P0D":l},e.toJSON=function(){return this.toISOString()},e.format=function(t){var e={Y:this.$d.years,YY:n.s(this.$d.years,2,"0"),YYYY:n.s(this.$d.years,4,"0"),M:this.$d.months,MM:n.s(this.$d.months,2,"0"),D:this.$d.days,DD:n.s(this.$d.days,2,"0"),H:this.$d.hours,HH:n.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:n.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:n.s(this.$d.seconds,2,"0"),SSS:n.s(this.$d.milliseconds,3,"0")};return(t||"YYYY-MM-DDTHH:mm:ss").replace(o,function(t,i){return i||String(e[t])})},e.as=function(t){return this.$ms/a[u(t)]},e.get=function(t){var e=this.$ms,i=u(t);return"milliseconds"===i?e%=1e3:e="weeks"===i?h(e/a[i]):this.$d[i],0===e?0:e},e.add=function(t,e,i){var n;return n=e?t*a[u(e)]:s(t)?t.$ms:c(t,this).$ms,c(this.$ms+n*(i?-1:1),this)},e.subtract=function(t,e){return this.add(t,e,!0)},e.locale=function(t){var e=this.clone();return e.$l=t,e},e.clone=function(){return c(this.$ms,this)},e.humanize=function(t){return i().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},e.milliseconds=function(){return this.get("milliseconds")},e.asMilliseconds=function(){return this.as("milliseconds")},e.seconds=function(){return this.get("seconds")},e.asSeconds=function(){return this.as("seconds")},e.minutes=function(){return this.get("minutes")},e.asMinutes=function(){return this.as("minutes")},e.hours=function(){return this.get("hours")},e.asHours=function(){return this.as("hours")},e.days=function(){return this.get("days")},e.asDays=function(){return this.as("days")},e.weeks=function(){return this.get("weeks")},e.asWeeks=function(){return this.as("weeks")},e.months=function(){return this.get("months")},e.asMonths=function(){return this.as("months")},e.years=function(){return this.get("years")},e.asYears=function(){return this.as("years")},t}(),function(t,e,o){i=o,n=o().$utils(),o.duration=function(t,e){return c(t,{$l:o.locale()},e)},o.isDuration=s;var r=e.prototype.add,a=e.prototype.subtract;e.prototype.add=function(t,e){return s(t)&&(t=t.asMilliseconds()),r.bind(this)(t,e)},e.prototype.subtract=function(t,e){return s(t)&&(t=t.asMilliseconds()),a.bind(this)(t,e)}})});ed.extend(eg);var e_=["__cep_sdk_onboard","__cep_trigger_sdk","_be_active"],em=["and","or","not"],ev=function(){function t(){this.support=!0,this.currentPlan=1,this.shouldSendEvent=!1,this.staing=!1,this.test=!1,this.cepReady=!1,this.eventCache=[]}return t.prototype.apply=function(t,e){var i=this;if(this.collect=t,this.config=e,this.config.cep){var n=t.adapters.storage,o=t.Types;this.types=o,this.storage=new n(!1),this.configManager=t.configManager,this.url=e.cep_url?""+e.cep_url:t.configManager.getDomain()+"/service/2/cep_settings/",this.reportUrl=t.configManager.getUrl("event"),this.key="__tea_cep_plan_"+e.app_id,this.quotasKey="__tea_cep_plan_quotas_"+e.app_id,this.isWait=!1,this.eventCache=[],this.test=t.configManager.staging,this.collect.on(o.SubmitAfter,function(t){i.matchEvent(t)}),this.init()}},t.prototype.init=function(){var t=this,e=!0,i=0,n=0,o=0,r=!1,a=this.storage.getItem(this.key)||{};if(a&&Object.keys(a).length&&(r=!0,i=a.last_update_time,n=a.fetch_interval,o=a.config_version||0,e=Date.now()-i>1e3*n),e){var s=this.configManager.get(),c=s.header,u=s.user;this.collect.requestManager.useRequest({url:this.url,data:{header:c,user:u,local_time:Date.now(),config_version:o},success:function(e){e&&0===e.code?(a.fetch_interval=e.fetch_interval,a.data=e.data,a.last_update_time=Date.now(),a.config_version=e.config_version,t.clearQuotas(),t.initState(e.data),t.storage.setItem(t.key,a),e.data.forEach(function(e){t.event("__cep_sdk_onboard",e.plan_id)})):(304===e.code||400===e.code)&&r&&(a.last_update_time=Date.now(),t.storage.setItem(t.key,a),t.initState(a.data))},fail:function(){r?(t.planData=a.data,t.initState(a.data)):t.support=!1},timeout:5e3})}else a.last_update_time=Date.now(),this.storage.setItem(this.key,a),this.initState(a.data)},t.prototype.initState=function(t){var e=this;t&&t.length&&(this.stateArray=new Map,this.waitArray=new Map,this.planData=t,t.forEach(function(t){var i=new Map;if(t.pattern&&t.pattern.events){var n=1===t.pattern.events.length;t.pattern.events.forEach(function(t){i.set(t.id,{id:t.id,isMatch:!1,event:null,after:t.after||null,connection:t.connection||null,window:t.window||null,matchTime:0,initTime:Date.now(),singleRule:n})}),e.stateArray.set(t.plan_id,{patternState:i,singleRule:n,pattern:{aid:t.aid,biz_id:t.biz_id,end_time:t.end_time,start_time:t.start_time,web_sdk_version:t.web_sdk_version,stage:t.stage},quotas:t.quotas})}}),this.cepReady=!0,this.dealCache(),this.collect.emit(this.types.CepReady))},t.prototype.check=function(t){var e=Date.now();return!(Date.now()>1e3*t.end_time)&&!(e<1e3*t.start_time)&&!(e>1e3*t.end_time)&&(this.staing="testing"===t.staing,!(te<t.web_sdk_version)||(this.support=!1,!1))},t.prototype.dealCache=function(){var t=this;if(this.eventCache.length){var e=1;this.eventCache.forEach(function(i){t.matchEvent(i),e++}),e===this.eventCache.length&&(this.eventCache=[])}},t.prototype.matchEvent=function(t){if(this.support&&(!this.staing||this.test)&&t&&t.length)try{if(!this.cepReady)return void this.eventCache.push(t);var e=t[0],i=e.header,n=e.user,o=e.events;o.length&&o.reverse();for(var r=0;r<o.length;r++){var a=o[r].event;if(-1!==e_.indexOf(a))return!1;this.matchRule(i,n,o[r])}}catch(t){return void this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.matchRule=function(t,e,i){try{for(var n=0;n<this.planData.length;n++){var o=this.planData[n],r=o.plan_id;if(this.check(o)&&this.checkQuotas(r)&&o.pattern&&o.pattern.events){for(var a=o.pattern.events,s=0;s<a.length;s++)if(this.rule(t,e,i,a[s].condition)){var c=this.stateArray.get(r).patternState,u=c.get(a[s].id);if(this.stateArray.get(r).singleRule){this.changeStatus(r,a[s].id,i),this.publish([i],r,a[s].id);break}if(!u.isMatch){u.after&&c.get(u.after).isMatch?this.changeStatus(r,a[s].id,i):u.after||this.changeStatus(r,a[s].id,i);break}}}}this.statusCheck()}catch(t){return void this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.changeStatus=function(t,e,i){var n=this.stateArray.get(t),o=n.patternState.get(e);o.isMatch=!0,o.event=i,o.matchTime=i.local_time_ms||Date.now(),n.patternState.set(e,o),this.stateArray.set(t,n)},t.prototype.statusCheck=function(){var t,e,i,n;try{for(var o=S(this.stateArray),r=o.next();!r.done;r=o.next()){var a=k(r.value,2),s=a[0],c=a[1],u=c.patternState;if(c.isSingle)break;try{for(var l=S(u),h=l.next();!h.done;h=l.next()){var p=k(h.value,2),f=p[0],d=p[1];if(d.after&&(!d.after||u.get(d.after).isMatch)){if("NOT_FOLLOWED_BY"===d.connection){d.isMatch?this.reset(s,f):Date.now()-u.get(d.after).matchTime>d.window?this.publish([u.get(d.after).event,d.event],s,f):this.startWait(s,f,d);break}d.isMatch?d.matchTime-u.get(d.after).matchTime<=d.window?this.publish([u.get(d.after).event,d.event],s,f):this.reset(s,f):Date.now()-u.get(d.after).matchTime>d.window?this.reset(s,f):this.startWait(s,f,d);break}}}catch(t){i={error:t}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(i)throw i.error}}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},t.prototype.startWait=function(t,e,i){var n=this;try{this.waitArray.get(t)||this.waitArray.set(t,new Map);var o=this.waitArray.get(t);if(!o.get(e)){var r=setTimeout(function(){var o,r=n.stateArray.get(t).patternState,a=r.get(e);"NOT_FOLLOWED_BY"===a.connection?!a.isMatch&&r.get(a.after).isMatch||a.matchTime-r.get(a.after).matchTime>i.window?((o=n.waitArray.get(t).get(e)).triggerWait=!0,n.waitArray.set(t,n.waitArray.get(t).set(e,o)),n.publish([r.get(a.after).event],t,e)):n.reset(t,e):"FOLLOWED_BY"===a.connection&&(a.isMatch&&r.get(a.after).isMatch?((o=n.waitArray.get(t).get(e)).triggerWait=!0,n.waitArray.set(t,n.waitArray.get(t).set(e,o)),n.publish([r.get(a.after).event],t,e)):n.reset(t,e))},i.window);o.set(e,{waitFn:r,triggerWait:!1}),this.waitArray.set(t,o)}}catch(t){this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.rule=function(t,e,i,n){var o=this;try{var r=i.event,a=i.params;if(a=JSON.parse(a),-1!==em.indexOf(n.op)){if(n.conditions&&n.conditions.length){var s=n.conditions,c=0,u=new Map;u.set(c,{op:n.op,result:void 0,resultList:[],resultKey:[],resultLength:s.length}),!function i(n,s){for(var l=0;l<n.length;l++)if(c++,-1!==em.indexOf(n[l].op)&&n[l].hasOwnProperty("conditions"))u.set(c,{op:n[l].op,result:void 0,fatherKey:s,resultList:[],resultKey:[],resultLength:n[l].conditions.length}),i(n[l].conditions,c);else{var h=o.scope(n[l].key),p=h.scope,f=h.key,d=h.key2,g=p?"header"===p?d?JSON.parse(t[d])[f]:t[f]:"user"===p?e[f]:a[f]:r,_=o.calculate(n[l].op,g,n[l].value);u.set(c,{op:n[l].op,result:_,fatherKey:s})}}(s,c);for(var l=u.get(0);void 0===l.result||l.resultList.length<l.resultLength;)u.forEach(function(t,e){if(void 0!==t.result&&void 0!==t.fatherKey){var i=u.get(t.fatherKey);i.resultList.length<i.resultLength&&-1===i.resultKey.indexOf(e)&&(i.resultKey.push(e),i.resultList.push(t.result),u.set(t.fatherKey,i))}}),u.forEach(function(t){t.resultList&&t.resultList.length===t.resultLength&&("and"===t.op&&(t.result=-1===t.resultList.indexOf(!1)),"or"===t.op&&(t.result=-1!==t.resultList.indexOf(!0)))});return u.get(0).result}return!1}var h=this.scope(n.key),p=h.scope,f=h.key,d=h.key2,g=p?"header"===p?d?JSON.parse(t[d])[f]:t[f]:"user"===p?e[f]:a[f]:r;return this.calculate(n.op,g,n.value)}catch(t){return this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message}),!1}},t.prototype.publish=function(t,e,i){try{var n=this.configManager.get().user,o={biz_id:this.stateArray.get(e).pattern.biz_id,plan_id:e,uid:n.user_id||"",did:n.device_id||"",uuid:n.user_unique_id,events:t,extra:{url:window.location.href}};this.collect.emit("__cep_match",o),(window.opener||window.parent).postMessage({type:"__cep_match",data:o},"*"),this.event("__cep_trigger_sdk",e),this.addQuotas(e),this.reset(e,i)}catch(t){return void this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.addQuotas=function(t){var e=this.stateArray.get(t).quotas;if(e&&e.length){var i=this.storage.getItem(this.quotasKey)||{};i[t]||(i[t]={value:0,lastTime:Date.now()});var n=i[t].value;0===n&&(i[t].lastTime=Date.now()),i[t].value=n+1,this.storage.setItem(this.quotasKey,i)}},t.prototype.checkQuotas=function(t){var e=this.stateArray.get(t).quotas,i=this.storage.getItem(this.quotasKey)||{};if(i[t]||(i[t]={value:0,lastTime:Date.now()}),e&&e.length){var n=e[0].granularity,o=e[0].value;if("per_keyid"!==e[0].type)return!0;var r=this.release(n);return"all"===r?!(i[t].value>=o):Date.now()-i[t].lastTime>=r?(i[t].value=0,i[t].lastTime=Date.now(),this.storage.setItem(this.quotasKey,i),!0):!(i[t].value>=o)}return!0},t.prototype.clearQuotas=function(){this.storage.setItem(this.quotasKey,null)},t.prototype.release=function(t){if("all"===t)return t;var e=ed.duration(t);return e?e.asMilliseconds():"all"},t.prototype.reset=function(t,e){var i=this.stateArray.get(t);if(i.singleRule){var n=i.patternState.get(e);n.isMatch=!1,n.event=null,n.matchTime=0,n.initTime=Date.now(),i.patternState.set(e,n)}else i.patternState.forEach(function(t){t.isMatch=!1,t.event=null,t.matchTime=0,t.initTime=Date.now()});this.stateArray.set(t,i);var o=this.waitArray.get(t);o&&o.get(e)&&(clearTimeout(o.get(e).waitFn),o.delete(e))},t.prototype.event=function(t,e){try{var i={event:t,params:JSON.stringify({plan_id:e||"",biz_id:this.stateArray.get(e).pattern.biz_id}),local_time_ms:Date.now()},n=this.configManager.get(),o=n.header,r=n.user;o.custom=JSON.stringify(o.custom);this.collect.requestManager.useRequest({url:this.reportUrl,data:[{events:[i],user:r,header:o}]})}catch(t){return void this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.scope=function(t){var e="",i="";if(t.indexOf(".")>-1){var n=t.split(".");e=n[0],t=n[1],"header"===e&&"custom"===t&&(t=n[2],i=n[1])}return{scope:e,key:t,key2:i}},t.prototype.calculate=function(t,e,i){try{if("="===t)return e===i;if(-1!==["=","<",">",">=","<=","!="].indexOf(t))switch(t){case"=":return e===i;case"<":return e<i;case">":return e>i;case">=":return e>=i;case"<=":return e<=i;case"!=":return e!==i}else{if(-1!==["in","contains"].indexOf(t))return -1!==i.indexOf(e);if(-1!==["is not null","is null"].indexOf(t))return"is null"===t?null==e:null!=e;if(-1!==["startswith","endswith"].indexOf(t)){if("startswith"===t)return 0===e.indexOf(i);var n=e.length-i.length;return e.substr(n,i.length)===i}}}catch(t){return this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message}),!1}},t}(),ey="undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null,eb=function(){function t(){}return t.prototype.apply=function(t,e){this._plugin={},this.config=e,this.collect=t,this.channel=e.channel||"cn",this.loadExtend()},t.prototype.loadExtend=function(){var t=this;try{this.collect.remotePlugin.forEach(function(e,i){if("sdk"===e){if(tw.hasOwnProperty(i)){var n=tw[i].object,o=""+tw[i].src[t.channel];t.exist(i,n,o)}}else"object"==typeof e&&(e.src?t.exist(i,e.call,e.src):t.process(i,e.instance,"INSTANCE"))})}catch(t){this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.exist=function(t,e,i){var n=this;ey[e]?this.process(t,ey[e]):this.loadPlugin(t,i,function(){n.process(t,ey[e])},function(){})},t.prototype.process=function(t,e,i){try{if(i){var n=new e;n.apply&&n.apply(this.collect,this.config)}else e&&e(this.collect,this.config)}catch(t){this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t.prototype.loadPlugin=function(t,e,i,n){var o=this;try{var r=document.createElement("script");r.src=e,this._plugin[t]||(this._plugin[t]=[]),this._plugin[t].push(i),r.onerror=function(){n(e)},r.onload=function(){o._plugin[t].forEach(function(t){t()})},document.getElementsByTagName("head")[0].appendChild(r)}catch(t){this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message})}},t}(),eE=function(){function t(){this.autotrack=!1,this.spa=!1,this.cache={},this.allowHash=!1}return t.prototype.apply=function(t,e){if(e.spa||e.autotrack){var i=t.Types;this.collect=t,this.config=e,this.appid=e.app_id,this.allowHash=e.allow_hash,this.fncArray=new Map,this.setKey(),this.setLocation(),this.hack(),this.init(),this.listener(),t.emit(i.RouteReady)}},t.prototype.setKey=function(){var t=this.collect.adapters.storage;this.storage=new t(!1),this.cache_key="__tea_cache_refer_"+this.appid,this.cache={refer_key:"",refer_title:document.title||location.pathname,refer_manual_key:"",routeChange:!1},this.config.autotrack&&"object"==typeof this.config.autotrack&&this.config.autotrack.page_manual_key&&(this.cache.refer_manual_key=this.config.autotrack.page_manual_key),this.storage.setItem(this.cache_key,this.cache)},t.prototype.hack=function(){var t=this,e=window.history.pushState;history.pushState=function(i){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];"function"==typeof history.onpushstate&&history.onpushstate({state:i});var r=e.call.apply(e,A([history,i],n));if(t.lastLocation!==location.href){var a=t.getPopStateChangeEventData();return t.setReferCache(t.lastLocation),t.lastLocation=location.href,t.sendPv(a,"pushState"),r}};var i=history.replaceState;history.replaceState=function(e){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];"function"==typeof history.onreplacestate&&history.onreplacestate({state:e});var r=i.call.apply(i,A([history,e],n));if(t.lastLocation!==location.href){var a=t.getPopStateChangeEventData();return t.setReferCache(t.lastLocation),t.lastLocation=location.href,t.sendPv(a),r}}},t.prototype.setLocation=function(){"undefined"!=typeof window&&(this.lastLocation=window.location.href)},t.prototype.getLocation=function(){return this.lastLocation},t.prototype.init=function(){var t=this.getPopStateChangeEventData();this.collect.emit("route-change",{config:t,init:!0})},t.prototype.listener=function(){var t=this,e=null;window.addEventListener("hashchange",function(i){if(t.lastLocation!==window.location.href&&(clearTimeout(e),t.allowHash)){t.setReferCache(t.lastLocation),t.lastLocation=window.location.href;var n=t.getPopStateChangeEventData();t.sendPv(n)}}),window.addEventListener("popstate",function(i){t.lastLocation!==window.location.href&&(e=setTimeout(function(){t.setReferCache(t.lastLocation),t.lastLocation=window.location.href;var e=t.getPopStateChangeEventData();t.sendPv(e)},10))})},t.prototype.getPopStateChangeEventData=function(){var t=this.pageConfig();return t.is_back=0,t},t.prototype.pageConfig=function(){try{var t=this.storage.getItem(this.cache_key)||{},e=!1,i=this.storage.getItem("__tea_cache_first_"+this.appid);return e=!i||1!=i,{is_html:1,url:location.href,referrer:this.handleRefer(),page_key:location.href,refer_page_key:this.handleRefer(),page_title:document.title||location.pathname,page_manual_key:this.config.autotrack&&this.config.autotrack.page_manual_key||"",refer_page_manual_key:t&&t.refer_manual_key||"",refer_page_title:t&&t.refer_title||"",page_path:location.pathname,page_host:location.host,is_first_time:""+e}}catch(t){return this.collect.emit(H.DEBUGGER_MESSAGE,{type:H.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:t.message}),{}}},t.prototype.sendPv=function(t,e){this.collect.emit("route-change",{config:t,init:!1})},t.prototype.handleRefer=function(){var t="";try{var e=this.storage.getItem()||{};t=e.routeChange?e.refer_key:this.collect.configManager.get("referrer")}catch(e){t=document.referrer}return t},t.prototype.setReferCache=function(t){var e=this.storage.getItem(this.cache_key)||{};e.refer_key=t,e.routeChange=!0,this.storage.setItem(this.cache_key,e)},t}();tk.usePlugin(eb,"extend"),tk.usePlugin(ef,"tracer"),tk.usePlugin(tz,"ab"),tk.usePlugin(tU,"stay"),tk.usePlugin(eh,"autotrack"),tk.usePlugin(tP,"et"),tk.usePlugin(tV,"profile"),tk.usePlugin(ev,"cep"),tk.usePlugin(tj,"heartbeat"),tk.usePlugin(tK,"monitor"),tk.usePlugin(eE,"route"),tk.usePlugin(ef,"tracer");var ew=new tk("default"),eS={CN:3053,OVERSEA:3297},ek=function(t){function e(e){var i,n,o,r,a,s,c=this,u=e.test,l=e.TEAChannelDomain,h=void 0===l?"":l,p=e.mode,f=e.TEAChannel,d=e.TEAChannelType;return e.tracker=h||d||f?(n=(i={isTest:u||"test"===p,channel_domain:h,channel_type:d,channel:f}).isTest,o=i.channel_domain,r=i.channel_type,a=i.channel,s=/snssdk|zijieapi/g.test(o)&&/ttp|tcpy/g.test(r)&&/va|sg|in/g.test(a)?eS.CN:eS.OVERSEA,ew.init({app_id:s,channel_type:r,channel:a,channel_domain:o}),ew.config({_staging_flag:n?1:0,enable_et_test:n}),ew.start(),ew.event.bind(ew)):function(){},c=t.call(this,e)||this}return o(e,t),e}(E);e.default=ek},49503:function(t,e,i){"use strict";i.d(e,{I18n:function(){return M}});var n,o,r=i("49314"),a=i("93276"),s=i("24264");function c(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}function u(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,i){return e&&u(t.prototype,e),i&&u(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||p(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){if(t){if("string"==typeof t)return f(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return f(t,e)}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}for(var d=["AFN","EUR","ALL","DZD","USD","AOA","XCD","ARS","AMD","AWG","AUD","AZN","BSD","BHD","BDT","BBD","BYN","BZD","XOF","BMD","INR","BTN","BOB","BOV","BAM","BWP","NOK","BRL","BND","BGN","BIF","CVE","KHR","XAF","CAD","KYD","CLP","CLF","CNY","COP","COU","KMF","CDF","NZD","CRC","HRK","CUP","CUC","ANG","CZK","DKK","DJF","DOP","EGP","SVC","ERN","ETB","FKP","FJD","XPF","GMD","GEL","GHS","GIP","GTQ","GBP","GNF","GYD","HTG","HNL","HKD","HUF","ISK","IDR","XDR","IRR","IQD","ILS","JMD","JPY","JOD","KZT","KES","KPW","KRW","KWD","KGS","LAK","LBP","LSL","ZAR","LRD","LYD","CHF","MOP","MKD","MGA","MWK","MYR","MVR","MRO","MUR","XUA","MXN","MXV","MDL","MNT","MAD","MZN","MMK","NAD","NPR","NIO","NGN","OMR","PKR","PAB","PGK","PYG","PEN","PHP","PLN","QAR","RON","RUB","RWF","SHP","WST","STD","SAR","RSD","SCR","SLL","SGD","XSU","SBD","SOS","SSP","LKR","SDG","SRD","SZL","SEK","CHE","CHW","SYP","TWD","TJS","TZS","THB","TOP","TTD","TND","TRY","TMT","UGX","UAH","AED","USN","UYU","UYI","UZS","VUV","VEF","VND","YER","ZMW","ZWL","XBA","XBB","XBC","XBD","XTS","XXX","XAU","XPD","XPT","XAG"],g={},_=0;_<d.length;_++)g[d[_]]={style:"currency",currency:d[_]};var m={number:g},v={LAMGUAGE_TRANSFORMER:"languageTransformer"};function y(t){return function(e){return e.type===t}}function b(t,e){var i=t;return(e||[]).map(function(e){i=e.process(t)||i}),i}var E={lng:"zh-CN",fallbackLng:["en-US"],inContext:!0},w=[a.default,s.default],S=function(){function t(e,i){if(c(this,t),this._waitingToAddResourceBundle=[],null!=e&&e.copiedI18nextInstance){this.instance=e.copiedI18nextInstance;return}this._handlePlugins(i),this._handleConfigs(e),this.instance=r.default.createInstance(),this.instance.isInitialized=!1}return l(t,[{key:"_handlePlugins",value:function(t){var e,i;(null===(e=this.config)||void 0===e?void 0:null===(i=e.icuConfig)||void 0===i?void 0:i.open)===!1&&w.shift(),this.plugins=Array.isArray(t)?t.concat(w):w}},{key:"_handleConfigs",value:function(t){this.userLng=(null==t?void 0:t.lng)||null,this.config=Object.assign({},E,t||{})}},{key:"language",get:function(){return(this.instance||{}).language}},{key:"createInstance",value:function(){var t=this;return new Promise(function(e,i){"undefined"!=typeof window&&!window.CocosEngine&&t.config.inContext&&(t.config.postProcess=[].concat(["inContext"],t.config.postProcess||[]),window.__STARLING_DEVTOOLS_I18N=t.instance),t.plugins.map(function(e){"IES_INTL_ICU_PLUGIN"===e.name&&e.staticInit(t.instance),t.instance.use(e)});var n=t.config;t.config.formats=Object.assign({},t.config.formats,m);var o=b(n.lng,t.plugins.filter(y(v.LAMGUAGE_TRANSFORMER)));t.instance.init(Object.assign({},n,{lng:o,i18nFormat:{formats:t.config.formats}}),function(n,o){try{var r,a=function(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=p(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,r=t},f:function(){try{!a&&null!=i.return&&i.return()}finally{if(s)throw r}}}}(t._waitingToAddResourceBundle);try{for(a.s();!(r=a.n()).done;){var s,c=r.value;(s=t.instance).addResourceBundle.apply(s,h(c))}}catch(t){a.e(t)}finally{a.f()}t._waitingToAddResourceBundle=[]}catch(t){}!n&&(t._updateLanguages(),e({t:o,err:n})),t.init=!0,i({t:o,err:n})})})}},{key:"_updateLanguages",value:function(){this.languages=this.instance?Array.from(new Set([this.instance.language].concat(h(this.instance.languages)))):null}},{key:"getLanguages",value:function(){return this.languages}},{key:"changeLanguage",value:function(t,e){var i=this;this.config.lng=t,this.instance.changeLanguage(t,function(t,n){!t&&i._updateLanguages(),e&&e(t,n)})}},{key:"changeLanguageWithPromise",value:function(t){var e=this;return new Promise(function(i,n){e.config.lng=t,e.instance.changeLanguage(t,function(t,o){t&&n({err:t,t:o}),e._updateLanguages(),i({err:t,t:o})})})}},{key:"getDir",value:function(t){return this.instance.dir(t)}},{key:"t",value:function(t,e,i){var n=Array.isArray(t)?Array.from(t).map(function(){return" "}).join(""):Array(t.length).fill(" "),o=Object.assign({keySeparator:n,nsSeparator:n},e);return"thirdParamFallback"in this.config&&this.config.thirdParamFallback&&(o.thirdParamFallback=!0),this.instance.t(t,i,o)}},{key:"addResourceBundle",value:function(t,e,i,n,o){return this.instance.isInitialized?this.instance.addResourceBundle(t,e,i,n,o):(this._waitingToAddResourceBundle.push([t,e,i,!!n,!!o]),this.instance)}},{key:"cloneInstance",value:function(e,i){var n=this.instance.cloneInstance(e,i),o=new t({copiedI18nextInstance:n});return o.t=this.t.bind(o),o.config=this.config,o.plugins=this.plugins,o.languages=this.languages,o.init=n.isInitialized||!!this.init,o.userLng=this.userLng,n.on("initialized",function(){o.init=!0}),o}}]),t}(),k="Starling_intl:",A={warn:function(){for(var t,e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];(t=console).warn.apply(t,["".concat(k," [WARNING]")].concat(i))},error:function(){for(var t,e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];(t=console).error.apply(t,["".concat(k," [ERROR]")].concat(i))}};function D(t,e,i){return i?e?e(t):t:((!t||!t.then)&&(t=Promise.resolve(t)),e?t.then(e):t)}function T(){}function O(t){return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];try{return Promise.resolve(t.apply(this,e))}catch(t){return Promise.reject(t)}}}(n=o||(o={})).intl3rdParty="intl3rdParty",n.backend="backend",n.logger="logger",n.languageDetector="languageDetector",n.postProcessor="postProcessor",n.i18nFormat="i18nFormat",n["3rdParty"]="3rdParty";var R=null,M=R=new(function(){function t(e){var i;c(this,t),this.plugins=[],this.i18nInstance=null!==(i=null==e?void 0:e.i18nInstance)&&void 0!==i?i:new S}return l(t,[{key:"use",value:function(t){return this.plugins.includes(t)?(A.warn("Plugin: ".concat(t.name," has beeninit installed.")),this):(this.plugins.push(t),this)}},{key:"init",value:function(t,e){try{var i=this;return i.ignoreWarning=t.ignoreWarning,i.i18nInstance._handleConfigs(t),i.i18nInstance._handlePlugins(i.plugins),D(function(t,e){try{var i=t()}catch(t){return e(t)}return i&&i.then?i.then(void 0,e):i}(function(){return D(i.i18nInstance.createInstance(),function(t){var n,r=t.err,a=t.t,s=i.plugins.filter(function(t){return t.type===o.intl3rdParty});return D((n=s.map(O(function(t){if(t&&"function"==typeof t.init){var e=t.init instanceof Promise?t.init:O(function(e){return Promise.resolve(t.init(e))});return function(t,e){return t&&t.then?t.then(T):Promise.resolve()}(e(i))}})),new Promise(function(t,e){if(!Array.isArray(n)&&(n=Array.from(n)),n.length<=0)return t([]);var i=[];(n=n.map(function(o,r){return function(){("function"==typeof o?new Promise(o):Promise.resolve(o)).then(function(e){i[r]=e,r===n.length-1?t(i):n[r+1]()},e)}}))[0]()})),function(){return"function"==typeof e&&e(r,a),{err:r,t:a}})})},function(t){return A.error("The instance init error: ".concat(t)),{err:t,t:function(t){return t}}}))}catch(t){return Promise.reject(t)}}},{key:"language",get:function(){return(this.i18nInstance||{}).language}},{key:"setLang",value:function(t,e){var i=b(t,this.plugins.filter(y(v.LAMGUAGE_TRANSFORMER)));this.i18nInstance.changeLanguage(i,e)}},{key:"getLanguages",value:function(){return this.i18nInstance.getLanguages()}},{key:"setLangWithPromise",value:function(t){var e=b(t,this.plugins.filter(y(v.LAMGUAGE_TRANSFORMER)));return this.i18nInstance.changeLanguageWithPromise(e)}},{key:"dir",value:function(t){return this.i18nInstance.getDir(t)}},{key:"t",value:function(t,e,i){var n=null;return(n=void 0===this?R:this).ignoreWarning||n.i18nInstance&&n.i18nInstance.init?t&&("string"!=typeof t||t.trim())?n.i18nInstance.t(t,e,i):"":(A.error("The instance has not been initialized: i18n.t('".concat(t,"'").concat(e?","+JSON.stringify(e):"",");")),null!=i?i:Array.isArray(t)?t[0]:t)}},{key:"addResourceBundle",value:function(t,e,i,n,o){return this.i18nInstance.addResourceBundle(t,e,i,n,o)}},{key:"cloneInstance",value:function(e){var i=new t({i18nInstance:this.i18nInstance.cloneInstance(e)});return i.t=this.t.bind(i),i.plugins=this.plugins,i.ignoreWarning=this.ignoreWarning,i}}]),t}())}}]);